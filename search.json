[{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/CLAUDE.html","id":"buildtestlint-commands","dir":"","previous_headings":"","what":"Build/Test/Lint Commands","title":"SCP-SeuratV5 Development Guide","text":"Build: devtools::build() R CMD build . Documentation: devtools::document() Check: devtools::check() R CMD check ---manual . Test: devtools::test() testthat::test_package(\"SCP\") Test single file: testthat::test_file(\"tests/testthat/test-file.R\") Lint: styler::style_pkg() Build docs site: pkgdown::build_site()","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/CLAUDE.html","id":"python-environment-setup","dir":"","previous_headings":"","what":"Python Environment Setup","title":"SCP-SeuratV5 Development Guide","text":"","code":"# Option 1: Set option before loading the package options(SCP_env_init = TRUE) library(SCP)  # Option 2: Initialize after loading the package library(SCP) PrepareEnv() # Only needed once to create the environment  # Option 3: Manually setup with reticulate library(reticulate) use_condaenv(\"SCP_env\") options(SCP_env_init = TRUE) # This must be set before loading SCP library(SCP)"},{"path":"https://zhanghao-njmu.github.io/SCP/CLAUDE.html","id":"macos-apple-silicon-compatibility","dir":"","previous_headings":"","what":"macOS Apple Silicon Compatibility","title":"SCP-SeuratV5 Development Guide","text":"using SCP macOS, especially Apple Silicon (M1/M2/M3), may encounter issues Python integration. following helps prevent crashes: Apple Silicon users, Python-dependent functions like scVI_integrate might unstable cause segmentation faults. Consider using alternatives: - Harmony_integrate() (recommended) - Seurat_integrate() - fastMNN_integrate()","code":"# Set this environment variable before loading SCP to avoid OpenMP conflicts Sys.setenv(KMP_DUPLICATE_LIB_OK = \"TRUE\") library(SCP)"},{"path":"https://zhanghao-njmu.github.io/SCP/CLAUDE.html","id":"code-style-guidelines","dir":"","previous_headings":"","what":"Code Style Guidelines","title":"SCP-SeuratV5 Development Guide","text":"Function names: CamelCase initial capital (e.g., RunPAGA) Helper functions: snake_case (e.g., try_get) Variables: snake_case Parameters: period-separated (e.g., group., reduction) Indentation: 2 spaces Documentation: roxygen2 comprehensive @param, @return, @examples Comments: # space following Imports: Use @importFrom tags package::function notation Error handling: Use tryCatch() robust error handling Line length: Keep 120 characters Default parameters: Provide sensible defaults possible","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"id_17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"https://zhanghao-njmu.github.io/SCP/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Hao Zhang. Maintainer.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zhang H (2025). SCP: Single Cell Pipeline. R package version 0.6.0, https://github.com/zhanghao-njmu/SCP.","code":"@Manual{,   title = {SCP: Single Cell Pipeline},   author = {Hao Zhang},   year = {2025},   note = {R package version 0.6.0},   url = {https://github.com/zhanghao-njmu/SCP}, }"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"scp-seuratv5","dir":"","previous_headings":"","what":"Single Cell Pipeline","title":"Single Cell Pipeline","text":"Experimental version SCP Seurat V5 support expanded functionality. fork maintains full backward compatibility Seurat V4 adding comprehensive V5 support.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key Features","title":"Single Cell Pipeline","text":"✅ Full Seurat V5 Compatibility - Automatic version detection handling ✅ Backward Compatible - Works seamlessly Seurat V4 (4.0.x - 4.4.x) V5 (5.0.x+) ✅ 100+ Functions Updated - data access patterns use version-safe methods ✅ Zero Breaking Changes - Existing code continues work unchanged ✅ Python 3.10+ Support - Modern Python environment flexible version requirements","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Single Cell Pipeline","text":"","code":"if (!require(\"devtools\", quietly = TRUE)) {   install.packages(\"devtools\") } devtools::install_github(\"mianaz/SCP-SeuratV5\", ref=\"main\")"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"dependencies","dir":"","previous_headings":"Installation","what":"Dependencies","title":"Single Cell Pipeline","text":"installation fails due missing dependencies:","code":"# Install BiocManager for Bioconductor packages install.packages(\"BiocManager\")  # Core dependencies install.packages(c(\"Matrix\", \"Seurat\", \"SeuratObject\", \"reticulate\", \"rlang\", \"dplyr\", \"ggplot2\"))  # Bioconductor dependencies BiocManager::install(c(\"AnnotationDbi\", \"ComplexHeatmap\", \"clusterProfiler\", \"biomaRt\"))"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"python-environment-setup","dir":"","previous_headings":"Installation","what":"Python Environment Setup","title":"Single Cell Pipeline","text":"","code":"# Create SCP Python environment (only needed once) SCP::PrepareEnv()  # Uses Python 3.10 by default  # Or specify a different Python version SCP::PrepareEnv(python_version = \"3.11\")"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"macos-apple-silicon-notes","dir":"","previous_headings":"","what":"macOS Apple Silicon Notes","title":"Single Cell Pipeline","text":"M1/M2/M3 Macs, set loading SCP avoid OpenMP conflicts: Python-dependent functions fail, use stable alternatives: - Harmony_integrate() (recommended Apple Silicon) - Seurat_integrate() - fastMNN_integrate()","code":"Sys.setenv(KMP_DUPLICATE_LIB_OK = \"TRUE\") library(SCP)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"scp-single-cell-pipeline","dir":"","previous_headings":"","what":"SCP: Single-Cell Pipeline","title":"Single Cell Pipeline","text":"SCP provides comprehensive set tools single-cell data processing downstream analysis. package includes following facilities: Integrated single-cell quality control methods. Pipelines embedded multiple methods normalization, feature reduction, cell population identification (standard Seurat workflow). Pipelines embedded multiple integration methods scRNA-seq scATAC-seq data, including Uncorrected, Seurat, scVI, MNN, fastMNN, Harmony, Scanorama, BBKNN, CSS, LIGER, Conos, ComBat. Multiple single-cell downstream analyses identification differential features, enrichment analysis, GSEA analysis, identification dynamic features, PAGA, RNA velocity, Palantir, Monocle2, Monocle3, etc. Multiple methods automatic annotation single-cell data methods projection single-cell datasets. High-quality data visualization methods. Fast deployment single-cell data SCExplorer, shiny app provides interactive visualization interface. functions SCP package developed around Seurat object compatible Seurat functions.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Single Cell Pipeline","text":"Data exploration CellQC Standard pipeline Integration pipeline Cell projection single-cell datasets Cell annotation using bulk RNA-seq datasets Cell annotation using single-cell datasets PAGA analysis Velocity analysis Differential expression analysis Enrichment analysis(-representation) Enrichment analysis(GSEA) Trajectory inference Dynamic features Interactive data visualization SCExplorer visualization examples","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"data-exploration","dir":"","previous_headings":"Quick Start","what":"Data exploration","title":"Single Cell Pipeline","text":"analysis based subsetted version mouse pancreas data.","code":"library(SCP) library(BiocParallel) register(MulticoreParam(workers = 8, progressbar = TRUE))  data(\"pancreas_sub\") print(pancreas_sub) #> An object of class Seurat  #> 47874 features across 1000 samples within 3 assays  #> Active assay: RNA (15958 features, 3467 variable features) #>  2 other assays present: spliced, unspliced #>  2 dimensional reductions calculated: PCA, UMAP CellDimPlot(   srt = pancreas_sub, group.by = c(\"CellType\", \"SubCellType\"),   reduction = \"UMAP\", theme_use = \"theme_blank\" ) CellDimPlot(   srt = pancreas_sub, group.by = \"SubCellType\", stat.by = \"Phase\",   reduction = \"UMAP\", theme_use = \"theme_blank\" ) FeatureDimPlot(   srt = pancreas_sub, features = c(\"Sox9\", \"Neurog3\", \"Fev\", \"Rbp4\"),   reduction = \"UMAP\", theme_use = \"theme_blank\" ) FeatureDimPlot(   srt = pancreas_sub, features = c(\"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\"),   compare_features = TRUE, label = TRUE, label_insitu = TRUE,   reduction = \"UMAP\", theme_use = \"theme_blank\" ) ht <- GroupHeatmap(   srt = pancreas_sub,   features = c(     \"Sox9\", \"Anxa2\", # Ductal     \"Neurog3\", \"Hes6\", # EPs     \"Fev\", \"Neurod1\", # Pre-endocrine     \"Rbp4\", \"Pyy\", # Endocrine     \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon   ),   group.by = c(\"CellType\", \"SubCellType\"),   heatmap_palette = \"YlOrRd\",   cell_annotation = c(\"Phase\", \"G2M_score\", \"Cdh2\"),   cell_annotation_palette = c(\"Dark2\", \"Paired\", \"Paired\"),   show_row_names = TRUE, row_names_side = \"left\",   add_dot = TRUE, add_reticle = TRUE ) print(ht$plot)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"cellqc","dir":"","previous_headings":"Quick Start","what":"CellQC","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunCellQC(srt = pancreas_sub) CellDimPlot(srt = pancreas_sub, group.by = \"CellQC\", reduction = \"UMAP\") CellStatPlot(srt = pancreas_sub, stat.by = \"CellQC\", group.by = \"CellType\", label = TRUE) CellStatPlot(   srt = pancreas_sub,   stat.by = c(     \"db_qc\", \"outlier_qc\", \"umi_qc\", \"gene_qc\",     \"mito_qc\", \"ribo_qc\", \"ribo_mito_ratio_qc\", \"species_qc\"   ),   plot_type = \"upset\", stat_level = \"Fail\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"standard-pipeline","dir":"","previous_headings":"Quick Start","what":"Standard pipeline","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- Standard_SCP(srt = pancreas_sub) CellDimPlot(   srt = pancreas_sub, group.by = c(\"CellType\", \"SubCellType\"),   reduction = \"StandardUMAP2D\", theme_use = \"theme_blank\" ) CellDimPlot3D(srt = pancreas_sub, group.by = \"SubCellType\") FeatureDimPlot3D(srt = pancreas_sub, features = c(\"Sox9\", \"Neurog3\", \"Fev\", \"Rbp4\"))"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"integration-pipeline","dir":"","previous_headings":"Quick Start","what":"Integration pipeline","title":"Single Cell Pipeline","text":"Example data integration subsetted version panc8(eight human pancreas datasets)  UMAP embeddings based different integration methods SCP:","code":"data(\"panc8_sub\") panc8_sub <- Integration_SCP(srtMerge = panc8_sub, batch = \"tech\", integration_method = \"Seurat\") CellDimPlot(   srt = panc8_sub, group.by = c(\"celltype\", \"tech\"), reduction = \"SeuratUMAP2D\",   title = \"Seurat\", theme_use = \"theme_blank\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"cell-projection-between-single-cell-datasets","dir":"","previous_headings":"Quick Start","what":"Cell projection between single-cell datasets","title":"Single Cell Pipeline","text":"","code":"panc8_rename <- RenameFeatures(   srt = panc8_sub,   newnames = make.unique(capitalize(rownames(panc8_sub[[\"RNA\"]]), force_tolower = TRUE)),   assays = \"RNA\" ) srt_query <- RunKNNMap(srt_query = pancreas_sub, srt_ref = panc8_rename, ref_umap = \"SeuratUMAP2D\") ProjectionPlot(   srt_query = srt_query, srt_ref = panc8_rename,   query_group = \"SubCellType\", ref_group = \"celltype\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"cell-annotation-using-bulk-rna-seq-datasets","dir":"","previous_headings":"Quick Start","what":"Cell annotation using bulk RNA-seq datasets","title":"Single Cell Pipeline","text":"","code":"data(\"ref_scMCA\") pancreas_sub <- RunKNNPredict(srt_query = pancreas_sub, bulk_ref = ref_scMCA, filter_lowfreq = 20) CellDimPlot(srt = pancreas_sub, group.by = \"KNNPredict_classification\", reduction = \"UMAP\", label = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"cell-annotation-using-single-cell-datasets","dir":"","previous_headings":"Quick Start","what":"Cell annotation using single-cell datasets","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_rename,   ref_group = \"celltype\", filter_lowfreq = 20 ) CellDimPlot(srt = pancreas_sub, group.by = \"KNNPredict_classification\", reduction = \"UMAP\", label = TRUE) pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_rename,   query_group = \"SubCellType\", ref_group = \"celltype\",   return_full_distance_matrix = TRUE ) CellDimPlot(srt = pancreas_sub, group.by = \"KNNPredict_classification\", reduction = \"UMAP\", label = TRUE) ht <- CellCorHeatmap(   srt_query = pancreas_sub, srt_ref = panc8_rename,   query_group = \"SubCellType\", ref_group = \"celltype\",   nlabel = 3, label_by = \"row\",   show_row_names = TRUE, show_column_names = TRUE ) print(ht$plot)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"paga-analysis","dir":"","previous_headings":"Quick Start","what":"PAGA analysis","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunPAGA(   srt = pancreas_sub, group_by = \"SubCellType\",   linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\" ) PAGAPlot(srt = pancreas_sub, reduction = \"UMAP\", label = TRUE, label_insitu = TRUE, label_repel = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"velocity-analysis","dir":"","previous_headings":"Quick Start","what":"Velocity analysis","title":"Single Cell Pipeline","text":"estimate RNA velocity, need “spliced” “unspliced” assays Seurat object. can generate matrices using velocyto, bustools, alevin.","code":"pancreas_sub <- RunSCVELO(   srt = pancreas_sub, group_by = \"SubCellType\",   linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\" ) VelocityPlot(srt = pancreas_sub, reduction = \"UMAP\", group_by = \"SubCellType\") VelocityPlot(srt = pancreas_sub, reduction = \"UMAP\", plot_type = \"stream\")"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"differential-expression-analysis","dir":"","previous_headings":"Quick Start","what":"Differential expression analysis","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunDEtest(srt = pancreas_sub, group_by = \"CellType\", fc.threshold = 1, only.pos = FALSE) VolcanoPlot(srt = pancreas_sub, group_by = \"CellType\") DEGs <- pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox DEGs <- DEGs[with(DEGs, avg_log2FC > 1 & p_val_adj < 0.05), ] # Annotate features with transcription factors and surface proteins pancreas_sub <- AnnotateFeatures(pancreas_sub, species = \"Mus_musculus\", db = c(\"TF\", \"CSPA\")) ht <- FeatureHeatmap(   srt = pancreas_sub, group.by = \"CellType\", features = DEGs$gene, feature_split = DEGs$group1,   species = \"Mus_musculus\", db = c(\"GO_BP\", \"KEGG\", \"WikiPathway\"), anno_terms = TRUE,   feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   height = 5, width = 4 ) print(ht$plot)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"enrichment-analysisover-representation","dir":"","previous_headings":"Quick Start","what":"Enrichment analysis(over-representation)","title":"Single Cell Pipeline","text":"ensure labels visible, can adjust size viewer panel Rstudio IDE.","code":"pancreas_sub <- RunEnrichment(   srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", species = \"Mus_musculus\",   DE_threshold = \"avg_log2FC > log2(1.5) & p_val_adj < 0.05\" ) EnrichmentPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"),   plot_type = \"bar\" ) EnrichmentPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"),   plot_type = \"wordcloud\" ) EnrichmentPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"),   plot_type = \"wordcloud\", word_type = \"feature\" ) EnrichmentPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = \"Ductal\",   plot_type = \"network\" ) EnrichmentPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = \"Ductal\",   plot_type = \"enrichmap\" ) EnrichmentPlot(srt = pancreas_sub, group_by = \"CellType\", plot_type = \"comparison\")"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"enrichment-analysisgsea","dir":"","previous_headings":"Quick Start","what":"Enrichment analysis(GSEA)","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunGSEA(   srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", species = \"Mus_musculus\",   DE_threshold = \"p_val_adj < 0.05\" ) GSEAPlot(srt = pancreas_sub, group_by = \"CellType\", group_use = \"Endocrine\", id_use = \"GO:0007186\") GSEAPlot(   srt = pancreas_sub, group_by = \"CellType\", group_use = \"Endocrine\", plot_type = \"bar\",   direction = \"both\", topTerm = 20 ) GSEAPlot(srt = pancreas_sub, group_by = \"CellType\", plot_type = \"comparison\")"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"trajectory-inference","dir":"","previous_headings":"Quick Start","what":"Trajectory inference","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunSlingshot(srt = pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") FeatureDimPlot(pancreas_sub, features = paste0(\"Lineage\", 1:3), reduction = \"UMAP\", theme_use = \"theme_blank\") CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1)"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"dynamic-features","dir":"","previous_headings":"Quick Start","what":"Dynamic features","title":"Single Cell Pipeline","text":"","code":"pancreas_sub <- RunDynamicFeatures(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"), n_candidates = 200) ht <- DynamicHeatmap(   srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),   use_fitted = TRUE, n_split = 6, reverse_ht = \"Lineage1\",   species = \"Mus_musculus\", db = \"GO_BP\", anno_terms = TRUE, anno_keys = TRUE, anno_features = TRUE,   heatmap_palette = \"viridis\", cell_annotation = \"SubCellType\",   separate_annotation = list(\"SubCellType\", c(\"Nnat\", \"Irx1\")), separate_annotation_palette = c(\"Paired\", \"Set1\"),   feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   pseudotime_label = 25, pseudotime_label_color = \"red\",   height = 5, width = 2 ) print(ht$plot) DynamicPlot(   srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"), group.by = \"SubCellType\",   features = c(\"Plk1\", \"Hes1\", \"Neurod2\", \"Ghrl\", \"Gcg\", \"Ins2\"),   compare_lineages = TRUE, compare_features = FALSE ) FeatureStatPlot(   srt = pancreas_sub, group.by = \"SubCellType\", bg.by = \"CellType\",   stat.by = c(\"Sox9\", \"Neurod2\", \"Isl1\", \"Rbp4\"), add_box = TRUE,   comparisons = list(     c(\"Ductal\", \"Ngn3 low EP\"),     c(\"Ngn3 high EP\", \"Pre-endocrine\"),     c(\"Alpha\", \"Beta\")   ) )"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"interactive-data-visualization-with-scexplorer","dir":"","previous_headings":"Quick Start","what":"Interactive data visualization with SCExplorer","title":"Single Cell Pipeline","text":"","code":"PrepareSCExplorer(list(mouse_pancreas = pancreas_sub, human_pancreas = panc8_sub), base_dir = \"./SCExplorer\") app <- RunSCExplorer(base_dir = \"./SCExplorer\") list.files(\"./SCExplorer\") # This directory can be used as site directory for Shiny Server.  if (interactive()) {   shiny::runApp(app) }"},{"path":"https://zhanghao-njmu.github.io/SCP/index.html","id":"other-visualization-examples","dir":"","previous_headings":"Quick Start","what":"Other visualization examples","title":"Single Cell Pipeline","text":"CellDimPlotCellStatPlotFeatureStatPlotGroupHeatmap can also find examples documentation function: Integration_SCP, RunKNNMap, RunMonocle3, RunPalantir, etc.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/AnnotateFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"AnnotateFeatures Annotate features in a Seurat object with additional metadata from databases or a GTF file. — AnnotateFeatures","title":"AnnotateFeatures Annotate features in a Seurat object with additional metadata from databases or a GTF file. — AnnotateFeatures","text":"AnnotateFeatures Annotate features Seurat object additional metadata databases GTF file.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/AnnotateFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AnnotateFeatures Annotate features in a Seurat object with additional metadata from databases or a GTF file. — AnnotateFeatures","text":"","code":"AnnotateFeatures(   srt,   species = \"Homo_sapiens\",   IDtype = c(\"symbol\", \"ensembl_id\", \"entrez_id\"),   db = NULL,   db_update = FALSE,   db_version = \"latest\",   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   gtf = NULL,   merge_gtf_by = \"gene_name\",   columns = c(\"seqname\", \"feature\", \"start\", \"end\", \"strand\", \"gene_id\", \"gene_name\",     \"gene_type\"),   assays = \"RNA\",   overwrite = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/AnnotateFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"AnnotateFeatures Annotate features in a Seurat object with additional metadata from databases or a GTF file. — AnnotateFeatures","text":"srt Seurat object annotated. species Name species used annotation. Default \"Homo_sapiens\". IDtype Type identifier use annotation. Default \"symbol\" options \"symbol\", \"ensembl_id\", \"entrez_id\". db Vector database names used annotation. Default NULL. db_update Logical value indicating whether update database. Default FALSE. db_version Version database use. Default \"latest\". convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Version Ensembl database use. Default 103. mirror URL mirror use Ensembl database. Default NULL. gtf Path GTF file used annotation. Default NULL. merge_gtf_by Column name merge GTF file . Default \"gene_name\". columns Vector column names used GTF file. Default \"seqname\", \"feature\", \"start\", \"end\", \"strand\", \"gene_id\", \"gene_name\", \"gene_type\". assays Character vector assay names annotated. Default \"RNA\". overwrite Logical value indicating whether overwrite existing metadata. Default FALSE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/AnnotateFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"AnnotateFeatures Annotate features in a Seurat object with additional metadata from databases or a GTF file. — AnnotateFeatures","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- AnnotateFeatures(pancreas_sub,   species = \"Mus_musculus\", IDtype = \"symbol\",   db = c(\"Chromosome\", \"GeneType\", \"Enzyme\", \"TF\", \"CSPA\", \"VerSeDa\") ) #> Species: Mus_musculus #> Warning: Annotation package org.Mm.eg.db does not exist. #> Warning: Use the human annotation to create the Chromosome,GeneType,Enzyme database for Mus_musculus #> Preparing database: Chromosome #> Preparing database: GeneType #> Preparing database: Enzyme #> Error in download(url = \"https://ftp.expasy.org/databases/enzyme/enzclass.txt\",     destfile = temp): could not find function \"download\" head(FetchData(pancreas_sub, vars = NULL, layer = \"meta.features\")) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': could not find function \"FetchData\"  ## Annotate features using a GTF file # pancreas_sub <- AnnotateFeatures(pancreas_sub, gtf = \"/data/reference/CellRanger/refdata-gex-mm10-2020-A/genes/genes.gtf\") # head(FetchData(pancreas_sub, vars = NULL, layer = \"meta.features\"))"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/BBKNN_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"BBKNN_integrate — BBKNN_integrate","title":"BBKNN_integrate — BBKNN_integrate","text":"BBKNN_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/BBKNN_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BBKNN_integrate — BBKNN_integrate","text":"","code":"BBKNN_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   bbknn_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/BBKNN_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BBKNN_integrate — BBKNN_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). bbknn_params list parameters bbknn.matrix.bbknn function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CC_GenePrefetch.html","id":null,"dir":"Reference","previous_headings":"","what":"Prefetch cycle gene — CC_GenePrefetch","title":"Prefetch cycle gene — CC_GenePrefetch","text":"Based human cell cycle genes, cell cycle genes corresponding species captured homologous gene conversion.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CC_GenePrefetch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prefetch cycle gene — CC_GenePrefetch","text":"","code":"CC_GenePrefetch(   species = \"Homo_sapiens\",   Ensembl_version = 103,   mirror = NULL,   max_tries = 5,   use_cached_gene = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CC_GenePrefetch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prefetch cycle gene — CC_GenePrefetch","text":"species Latin names animals,.e., \"Homo_sapiens\", \"Mus_musculus\" Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. max_tries maximum number attempts connect BioMart service. use_cached_gene Whether use previously cached cell cycle gene conversion results species.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CC_GenePrefetch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prefetch cycle gene — CC_GenePrefetch","text":"list S-phase G2M-phase genes. GeneConvert","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CC_GenePrefetch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prefetch cycle gene — CC_GenePrefetch","text":"","code":"ccgenes <- CC_GenePrefetch(\"Homo_sapiens\") str(ccgenes) #> List of 3 #>  $ res: NULL #>  $ S  : chr [1:43] \"MCM5\" \"PCNA\" \"TYMS\" \"FEN1\" ... #>  $ G2M: chr [1:54] \"HMGB2\" \"CDK1\" \"NUSAP1\" \"UBE2C\" ... ccgenes <- CC_GenePrefetch(\"Mus_musculus\") #> Connect to the Ensembl archives... #> Using the 103 version of biomart... #> Connecting to the biomart... #> Searching the dataset hsapiens ... #> Connecting to the dataset hsapiens_gene_ensembl ... #> Converting the geneIDs... #> 97 genes mapped with ensembl_symbol #> ============================== #> 97 genes mapped #> 0 genes unmapped #> ============================== #> Error in unnest(data = geneID_collapse, cols = colnames(geneID_collapse)[sapply(geneID_collapse,     class) %in% c(\"list\", \"AsIs\")], keep_empty = FALSE): could not find function \"unnest\" str(ccgenes) #> List of 3 #>  $ res: NULL #>  $ S  : chr [1:43] \"MCM5\" \"PCNA\" \"TYMS\" \"FEN1\" ... #>  $ G2M: chr [1:54] \"HMGB2\" \"CDK1\" \"NUSAP1\" \"UBE2C\" ..."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CSS_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"CSS_integrate — CSS_integrate","title":"CSS_integrate — CSS_integrate","text":"CSS_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CSS_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CSS_integrate — CSS_integrate","text":"","code":"CSS_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   CSS_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   CSS_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CSS_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CSS_integrate — CSS_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. CSS_dims_use vector specifying dimensions returned CSS utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). CSS_params list parameters simspec::cluster_sim_spectrum function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellCorHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"CellCorHeatmap — CellCorHeatmap","title":"CellCorHeatmap — CellCorHeatmap","text":"function generates heatmap visualize similarity different cell types conditions. takes Seurat objects expression matrices input calculates pairwise similarities distance.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellCorHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CellCorHeatmap — CellCorHeatmap","text":"","code":"CellCorHeatmap(   srt_query,   srt_ref = NULL,   bulk_ref = NULL,   query_group = NULL,   ref_group = NULL,   query_assay = NULL,   ref_assay = NULL,   query_reduction = NULL,   ref_reduction = NULL,   query_dims = 1:30,   ref_dims = 1:30,   query_collapsing = !is.null(query_group),   ref_collapsing = TRUE,   features = NULL,   features_type = c(\"HVF\", \"DE\"),   feature_source = \"both\",   nfeatures = 2000,   DEtest_param = list(max.cells.per.ident = 200, test.use = \"wilcox\"),   DE_threshold = \"p_val_adj < 0.05\",   distance_metric = \"cosine\",   k = 30,   filter_lowfreq = 0,   prefix = \"KNNPredict\",   exp_legend_title = NULL,   border = TRUE,   flip = FALSE,   limits = NULL,   cluster_rows = FALSE,   cluster_columns = FALSE,   show_row_names = FALSE,   show_column_names = FALSE,   row_names_side = \"left\",   column_names_side = \"top\",   row_names_rot = 0,   column_names_rot = 90,   row_title = NULL,   column_title = NULL,   row_title_side = \"left\",   column_title_side = \"top\",   row_title_rot = 90,   column_title_rot = 0,   nlabel = 0,   label_cutoff = 0,   label_by = \"row\",   label_size = 10,   heatmap_palette = \"RdBu\",   heatmap_palcolor = NULL,   query_group_palette = \"Paired\",   query_group_palcolor = NULL,   ref_group_palette = \"simspec\",   ref_group_palcolor = NULL,   query_cell_annotation = NULL,   query_cell_annotation_palette = \"Paired\",   query_cell_annotation_palcolor = NULL,   query_cell_annotation_params = if (flip) list(height = unit(10, \"mm\")) else list(width     = unit(10, \"mm\")),   ref_cell_annotation = NULL,   ref_cell_annotation_palette = \"Paired\",   ref_cell_annotation_palcolor = NULL,   ref_cell_annotation_params = if (flip) list(width = unit(10, \"mm\")) else list(height =     unit(10, \"mm\")),   use_raster = NULL,   raster_device = \"png\",   raster_by_magick = FALSE,   height = NULL,   width = NULL,   units = \"inch\",   seed = 11,   ht_params = list() )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellCorHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CellCorHeatmap — CellCorHeatmap","text":"srt_query Seurat object count matrix representing query dataset. dataset used calculate similarities cells. srt_ref Seurat object count matrix representing reference dataset. provided, similarities calculated cells query reference datasets. provided, similarities calculated within query dataset. bulk_ref count matrix representing bulk data. provided, similarities calculated cells query dataset bulk data. query_group grouping variable query dataset. variable used group cells heatmap rows. provided, cells treated one group. ref_group grouping variable reference dataset. variable used group cells heatmap columns. provided, cells treated one group. query_assay assay use query dataset. provided, default assay query dataset used. ref_assay assay use reference dataset. provided, default assay reference dataset used. query_reduction dimensionality reduction method use query dataset. provided, dimensionality reduction applied query dataset. ref_reduction dimensionality reduction method use reference dataset. provided, dimensionality reduction applied reference dataset. query_dims dimensions use query dataset. provided, first 30 dimensions used. ref_dims dimensions use reference dataset. provided, first 30 dimensions used. query_collapsing Whether collapse cells within query group calculating similarities. set TRUE, similarities calculated query groups rather individual cells. ref_collapsing Whether collapse cells within reference group calculating similarities. set TRUE, similarities calculated reference groups rather individual cells. features vector feature names include heatmap. provided, default set highly variable features (HVF) used. features_type type features use. Options \"HVF\" highly variable features, \"DE\" differentially expressed features query reference groups. feature_source source features use. Options \"query\" use features query dataset, \"ref\" use features reference dataset, \"\" use features datasets. provided set \"\", features selected datasets. nfeatures maximum number features include heatmap. provided, default 2000. DEtest_param parameters use differential expression testing. list two elements: \"max.cells.per.ident\" specifying maximum number cells per group differential expression testing, \"test.use\" specifying statistical test use differential expression testing. provided, default parameters used. DE_threshold threshold differential expression. features adjusted p-values threshold considered differentially expressed. distance_metric distance metric use calculating similarities cells. can following: \"cosine\", \"pearson\", \"spearman\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". provided, default \"cosine\". k number nearest neighbors use calculating similarities. provided, default 30. filter_lowfreq minimum frequency threshold selecting query dataset features. Features frequency threshold excluded heatmap. provided, default 0. prefix prefix use KNNPredict tool slot query dataset. can used avoid conflicts tools Seurat object. provided, default \"KNNPredict\". exp_legend_title title color legend heatmap. provided, default title based similarity metric used. border Whether add border around heatmap cell. provided, default TRUE. flip Whether flip orientation heatmap. set TRUE, rows columns heatmap swapped. can useful visualizing large datasets compact form. provided, default FALSE. limits limits color scale heatmap. provided, default use range similarity values. cluster_rows Whether cluster rows heatmap. set TRUE, rows rearranged based hierarchical clustering. provided, default FALSE. cluster_columns Whether cluster columns heatmap. set TRUE, columns rearranged based hierarchical clustering. provided, default FALSE. show_row_names Whether show row names heatmap. provided, default FALSE. show_column_names Whether show column names heatmap. provided, default FALSE. row_names_side side heatmap show row names. Options \"left\" \"right\". provided, default \"left\". column_names_side side heatmap show column names. Options \"top\" \"bottom\". provided, default \"top\". row_names_rot rotation angle row names. provided, default 0 degrees. column_names_rot rotation angle column names. provided, default 90 degrees. row_title title row names heatmap. provided, default use query grouping variable. column_title title column names heatmap. provided, default use reference grouping variable. row_title_side side heatmap show row title. Options \"top\" \"bottom\". provided, default \"left\". column_title_side side heatmap show column title. Options \"left\" \"right\". provided, default \"top\". row_title_rot rotation angle row title. provided, default 90 degrees. column_title_rot rotation angle column title. provided, default 0 degrees. nlabel maximum number labels show side heatmap. set 0, labels shown. can useful reducing clutter large heatmaps. provided, default 0. label_cutoff similarity cutoff showing labels. cells similarity values cutoff labels. provided, default 0. label_by dimension use labeling cells. Options \"row\" label cells row, \"column\" label cells column, \"\" label cells row column. provided, default \"row\". label_size size labels points. provided, default 10. heatmap_palette color palette use heatmap. can palettes available circlize package. provided, default \"RdBu\". heatmap_palcolor specific colors use heatmap palette. vector color names RGB values. provided, default NULL. query_group_palette color palette use query group legend. can palettes available circlize package. provided, default \"Paired\". query_group_palcolor specific colors use query group palette. vector color names RGB values. provided, default NULL. ref_group_palette color palette use reference group legend. can palettes available circlize package. provided, default \"simspec\". ref_group_palcolor specific colors use reference group palette. vector color names RGB values. provided, default NULL. query_cell_annotation vector cell metadata column names assay feature names use highlighting specific cells heatmap. element vector create separate cell annotation track heatmap. provided, cell annotations shown. query_cell_annotation_palette color palette use query cell annotation tracks. can palettes available circlize package. single color palette provided, used cell annotation tracks. multiple color palettes provided, track assigned separate palette. provided, default \"Paired\". query_cell_annotation_palcolor specific colors use query cell annotation palettes. list vectors, vector contains colors specific cell annotation track. single color vector provided, used cell annotation tracks. multiple color vectors provided, track assigned separate color vector. provided, default NULL. query_cell_annotation_params Additional parameters customizing appearance query cell annotation tracks. list named elements, names correspond parameter names heatmaps_annotation() function ComplexHeatmap package. provided, default parameters used. ref_cell_annotation vector cell metadata column names assay feature names use highlighting specific cells heatmap. element vector create separate cell annotation track heatmap. provided, cell annotations shown. ref_cell_annotation_palette color palette use reference cell annotation tracks. can palettes available circlize package. single color palette provided, used cell annotation tracks. multiple color palettes provided, track assigned separate palette. provided, default \"Paired\". ref_cell_annotation_palcolor specific colors use reference cell annotation palettes. list vectors, vector contains colors specific cell annotation track. single color vector provided, used cell annotation tracks. multiple color vectors provided, track assigned separate color vector. provided, default NULL. ref_cell_annotation_params Additional parameters customizing appearance reference cell annotation tracks. list named elements, names correspond parameter names heatmaps_annotation() function ComplexHeatmap package. provided, default parameters used. use_raster Whether use raster images rendering heatmap. set TRUE, heatmap rendered raster image using raster_device argument. provided, default determined based number rows columns heatmap. raster_device raster device use rendering heatmap. character string specifying device name, \"png\", \"jpeg\", \"pdf\". provided, default \"png\". raster_by_magick Whether use magick package rendering rasters. set TRUE, magick package used instead raster package. can useful rendering large heatmaps efficiently. magick package installed, argument ignored. height height heatmap specified units. provided, height automatically determined based number rows heatmap default unit. width width heatmap specified units. provided, width automatically determined based number columns heatmap default unit. units units use width height heatmap. Options \"mm\", \"cm\", \"inch\". provided, default \"inch\". seed random seed use reproducible results. provided, default 11. ht_params Additional parameters customize appearance heatmap. list named elements, names correspond parameter names Heatmap() function ComplexHeatmap package. conflicting parameters override defaults set function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellCorHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"CellCorHeatmap — CellCorHeatmap","text":"list following elements: plotThe heatmap plot ggplot object. featuresThe features used heatmap. simil_matrixThe similarity matrix used generate heatmap. simil_nameThe name similarity metric used generate heatmap. cell_metadataThe cell metadata used generate heatmap.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellCorHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CellCorHeatmap — CellCorHeatmap","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:31:10.010261] Start Standard_SCP #> [2025-09-07 20:31:10.011261] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector ht1 <- CellCorHeatmap(srt_query = pancreas_sub, query_group = \"SubCellType\") #> Use the HVF to calculate distance metric. #> Use 3467 features to calculate distance. #> As of Seurat v5, we recommend using AggregateExpression to perform pseudo-bulk analysis. #> This message is displayed once per session. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: unknown #> Detected reference data type: log_normalized_counts #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... #> Error: No cell overlap between new meta data and Seurat object ht1$plot #> Error: object 'ht1' not found  data(\"panc8_sub\") # Simply convert genes from human to mouse and preprocess the data genenames <- make.unique(capitalize(rownames(panc8_sub), force_tolower = TRUE)) #> Error in capitalize(rownames(panc8_sub), force_tolower = TRUE): could not find function \"capitalize\" panc8_sub <- RenameFeatures(panc8_sub, newnames = genenames) #> Error: object 'genenames' not found panc8_sub <- check_srtMerge(panc8_sub, batch = \"tech\")[[\"srtMerge\"]] #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> [2025-09-07 20:31:12.645516] Spliting srtMerge into srtList by column tech... ... #> [2025-09-07 20:31:12.828827] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector  ht2 <- CellCorHeatmap(   srt_query = pancreas_sub, srt_ref = panc8_sub, nlabel = 3, label_cutoff = 0.6,   query_group = \"SubCellType\", ref_group = \"celltype\",   query_cell_annotation = \"Phase\", query_cell_annotation_palette = \"Set2\",   ref_cell_annotation = \"tech\", ref_cell_annotation_palette = \"Set3\",   width = 4, height = 4 ) #> Use the HVF to calculate distance metric. #> Warning: The `slot` argument of `GetAssayData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the Seurat package. #>   Please report the issue at <https://github.com/satijalab/seurat/issues>. #> Use 2 features to calculate distance. #> Names of identity class contain underscores ('_'), replacing with dashes ('-') #> This message is displayed once every 8 hours. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: log_normalized_counts #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Detected reference data type: log_normalized_counts #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... #> Error: No cell overlap between new meta data and Seurat object ht2$plot #> Error: object 'ht2' not found  ht3 <- CellCorHeatmap(   srt_query = pancreas_sub, srt_ref = panc8_sub,   query_group = \"SubCellType\", query_collapsing = FALSE, cluster_rows = TRUE,   ref_group = \"celltype\", ref_collapsing = FALSE, cluster_columns = TRUE ) #> Use the HVF to calculate distance metric. #> Use 2 features to calculate distance. #> Detected query data type: raw_counts #> Detected reference data type: unknown #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... ht3$plot   ht4 <- CellCorHeatmap(   srt_query = pancreas_sub, srt_ref = panc8_sub,   show_row_names = TRUE, show_column_names = TRUE,   query_group = \"SubCellType\", ref_group = \"celltype\",   query_cell_annotation = c(\"Sox9\", \"Rbp4\", \"Gcg\"),   ref_cell_annotation = c(\"Sox9\", \"Rbp4\", \"Gcg\") ) #> Use the HVF to calculate distance metric. #> Use 2 features to calculate distance. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: log_normalized_counts #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Detected reference data type: log_normalized_counts #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... #> Error: No cell overlap between new meta data and Seurat object ht4$plot #> Error: object 'ht4' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDensityPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"CellDensityPlot — CellDensityPlot","title":"CellDensityPlot — CellDensityPlot","text":"Plots density specified features single multiple groups, grouped specified variables.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDensityPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CellDensityPlot — CellDensityPlot","text":"","code":"CellDensityPlot(   srt,   features,   group.by = NULL,   split.by = NULL,   assay = NULL,   slot = \"data\",   flip = FALSE,   reverse = FALSE,   x_order = c(\"value\", \"rank\"),   decreasing = NULL,   palette = \"Paired\",   palcolor = NULL,   cells = NULL,   keep_empty = FALSE,   y.nbreaks = 4,   y.min = NULL,   y.max = NULL,   same.y.lims = FALSE,   aspect.ratio = NULL,   title = NULL,   subtitle = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDensityPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CellDensityPlot — CellDensityPlot","text":"srt Seurat object. features character vector specifying features plot. group.character vector specifying variables group data . split.character vector specifying variables split data . Default NULL, means splitting performed. assay character specifying assay use Seurat object. Default NULL, means default assay used. slot character specifying slot use assay. Default \"data\". flip logical indicating whether flip x-axis. Default FALSE. reverse logical indicating whether reverse y-axis. Default FALSE. x_order character specifying order x-axis. Can \"value\" \"rank\". Default \"value\". decreasing logical indicating whether order groups decreasing order. Default NULL. palette character specifying color palette use grouping variables. Default \"Paired\". palcolor character specifying color use group. Default NULL. cells character vector specifying cells plot. Default NULL, means cells included. keep_empty logical indicating whether keep empty groups. Default FALSE. y.nbreaks integer specifying number breaks y-axis. Default 4. y.min numeric specifying minimum value y-axis. Default NULL, means minimum value automatically determined. y.max numeric specifying maximum value y-axis. Default NULL, means maximum value automatically determined. .y.lims logical indicating whether use y-axis limits plots. Default FALSE. aspect.ratio numeric specifying aspect ratio plot. Default NULL, means aspect ratio automatically determined. title character specifying title plot. Default NULL. subtitle character specifying subtitle plot. Default NULL. legend.position character specifying position legend. Default \"right\". legend.direction character specifying direction legend. Default \"vertical\". theme_use character specifying theme use. Default \"theme_scp\". theme_args list arguments pass theme function. combine logical indicating whether combine multiple plots single plot. Default TRUE. nrow integer specifying number rows combined plot. Default NULL, means determined automatically based number plots. ncol integer specifying number columns combined plot. Default NULL, means determined automatically based number plots. byrow logical indicating whether add plots row column combined plot. Default TRUE. force logical indicating whether continue plotting 50 features. Default FALSE.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDensityPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CellDensityPlot — CellDensityPlot","text":"","code":"data(\"pancreas_sub\") CellDensityPlot(pancreas_sub, features = \"Sox9\", group.by = \"SubCellType\") #> Error in check_R(\"ggridges\"): could not find function \"check_R\"  pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDensityPlot(pancreas_sub, features = \"Lineage1\", group.by = \"SubCellType\", aspect.ratio = 1) #> Error in check_R(\"ggridges\"): could not find function \"check_R\" CellDensityPlot(pancreas_sub, features = \"Lineage1\", group.by = \"SubCellType\", flip = TRUE) #> Error in check_R(\"ggridges\"): could not find function \"check_R\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize cell groups on a 2-dimensional reduction plot — CellDimPlot","title":"Visualize cell groups on a 2-dimensional reduction plot — CellDimPlot","text":"Plotting cell points reduced 2D plane coloring according groups.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize cell groups on a 2-dimensional reduction plot — CellDimPlot","text":"","code":"CellDimPlot(   srt,   group.by,   reduction = NULL,   dims = c(1, 2),   split.by = NULL,   cells = NULL,   show_na = FALSE,   show_stat = ifelse(identical(theme_use, \"theme_blank\"), FALSE, TRUE),   pt.size = NULL,   pt.alpha = 1,   palette = \"Paired\",   palcolor = NULL,   bg_color = \"grey80\",   label = FALSE,   label.size = 4,   label.fg = \"white\",   label.bg = \"black\",   label.bg.r = 0.1,   label_insitu = FALSE,   label_repel = FALSE,   label_repulsion = 20,   label_point_size = 1,   label_point_color = \"black\",   label_segment_color = \"black\",   cells.highlight = NULL,   cols.highlight = \"black\",   sizes.highlight = 1,   alpha.highlight = 1,   stroke.highlight = 0.5,   add_density = FALSE,   density_color = \"grey80\",   density_filled = FALSE,   density_filled_palette = \"Greys\",   density_filled_palcolor = NULL,   add_mark = FALSE,   mark_type = c(\"hull\", \"ellipse\", \"rect\", \"circle\"),   mark_expand = unit(3, \"mm\"),   mark_alpha = 0.1,   mark_linetype = 1,   lineages = NULL,   lineages_trim = c(0.01, 0.99),   lineages_span = 0.75,   lineages_palette = \"Dark2\",   lineages_palcolor = NULL,   lineages_arrow = arrow(length = unit(0.1, \"inches\")),   lineages_linewidth = 1,   lineages_line_bg = \"white\",   lineages_line_bg_stroke = 0.5,   lineages_whiskers = FALSE,   lineages_whiskers_linewidth = 0.5,   lineages_whiskers_alpha = 0.5,   stat.by = NULL,   stat_type = \"percent\",   stat_plot_type = \"pie\",   stat_plot_position = c(\"stack\", \"dodge\"),   stat_plot_size = 0.15,   stat_plot_palette = \"Set1\",   stat_palcolor = NULL,   stat_plot_alpha = 1,   stat_plot_label = FALSE,   stat_plot_label_size = 3,   graph = NULL,   edge_size = c(0.05, 0.5),   edge_alpha = 0.1,   edge_color = \"grey40\",   paga = NULL,   paga_type = \"connectivities\",   paga_node_size = 4,   paga_edge_threshold = 0.01,   paga_edge_size = c(0.2, 1),   paga_edge_color = \"grey40\",   paga_edge_alpha = 0.5,   paga_transition_threshold = 0.01,   paga_transition_size = c(0.2, 1),   paga_transition_color = \"black\",   paga_transition_alpha = 1,   paga_show_transition = FALSE,   velocity = NULL,   velocity_plot_type = \"raw\",   velocity_n_neighbors = ceiling(ncol(srt@assays[[1]])/50),   velocity_density = 1,   velocity_smooth = 0.5,   velocity_scale = 1,   velocity_min_mass = 1,   velocity_cutoff_perc = 5,   velocity_arrow_color = \"black\",   velocity_arrow_angle = 20,   streamline_L = 5,   streamline_minL = 1,   streamline_res = 1,   streamline_n = 15,   streamline_width = c(0, 0.8),   streamline_alpha = 1,   streamline_color = NULL,   streamline_palette = \"RdYlBu\",   streamline_palcolor = NULL,   streamline_bg_color = \"white\",   streamline_bg_stroke = 0.5,   hex = FALSE,   hex.linewidth = 0.5,   hex.count = TRUE,   hex.bins = 50,   hex.binwidth = NULL,   raster = NULL,   raster.dpi = c(512, 512),   aspect.ratio = 1,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize cell groups on a 2-dimensional reduction plot — CellDimPlot","text":"srt Seurat object. group.Name one meta.data columns group (color) cells (example, orig.ident). reduction dimensionality reduction use. specified, use reduction returned DefaultReduction. dims Dimensions plot, must two-length numeric vector specifying x- y-dimensions split.Name column meta.data column split plot . cells Subset cells plot. show_na Whether assign color color palette NA group. FALSE, cell points NA level colored bg_color. show_stat Whether show statistical information plot. pt.size Point size. pt.alpha Point transparency. palette Name color palette name collected SCP. Default \"Paired\". palcolor Custom colors used create color palette. bg_color Color value background(NA) points. label Whether label cell groups. label.size Size labels. label.fg Foreground color label. label.bg Background color label. label.bg.r Background ratio label. label_insitu Whether place raw labels (group names) center cells corresponding group. Default FALSE, using numbers instead raw labels. label_repel Logical value indicating whether label repel away center points. label_repulsion Force repulsion overlapping text labels. Defaults 20. label_point_size Size center points. label_point_color Color center points. label_segment_color Color line segment labels. cells.highlight vector cell names highlight. cols.highlight Color used highlight cells. sizes.highlight Size highlighted cell points. alpha.highlight Transparency highlighted cell points. stroke.highlight Border width highlighted cell points. add_density Whether add density layer plot. density_color Color density contours lines. density_filled Whether add filled contour bands instead contour lines. density_filled_palette Color palette used fill contour bands. density_filled_palcolor Custom colors used fill contour bands. lineages Lineages/pseudotime add plot. specified, curves fitted using loess method. lineages_trim Trim leading trailing data lineages. lineages_span parameter α controls degree smoothing loess method. lineages_palette Color palette used lineages. lineages_palcolor Custom colors used lineages. lineages_arrow Set arrows lineages. See arrow. lineages_linewidth Width fitted curve lines lineages. lineages_line_bg Background color curve lines lineages. lineages_line_bg_stroke Border width curve lines background. lineages_whiskers Whether add whiskers lineages. lineages_whiskers_linewidth Width whiskers lineages. lineages_whiskers_alpha Transparency whiskers lineages. stat.name metadata column stat. stat_type Set stat types (\"percent\" \"count\"). stat_plot_type Set statistical plot type. stat_plot_position Position adjustment statistical plot. stat_plot_size Set statistical plot size. Defaults 0.1 stat_plot_palette Color palette used statistical plot. stat_palcolor Custom colors used statistical plot stat_plot_alpha Transparency statistical plot. stat_plot_label Whether add labels statistical plot. stat_plot_label_size Label size statistical plot. graph Specify graph name add edges cell neighbors plot. edge_size Size edges. edge_alpha Transparency edges. edge_color Color edges. paga Specify calculated paga results add PAGA graph layer plot. paga_type PAGA plot type. \"connectivities\" \"connectivities_tree\". paga_node_size Size nodes PAGA plot. paga_edge_threshold Threshold edge connectivities PAGA plot. paga_edge_size Size edges PAGA plot. paga_edge_color Color edges PAGA plot. paga_edge_alpha Transparency edges PAGA plot. paga_transition_threshold Threshold transition edges PAGA plot. paga_transition_size Size transition edges PAGA plot. paga_transition_color Color transition edges PAGA plot. paga_transition_alpha Transparency transition edges PAGA plot. paga_show_transition Whether show transitions edges. velocity Specify calculated RNA velocity mode add velocity layer plot. velocity_plot_type Set velocity plot type. velocity_n_neighbors Set number neighbors used velocity plot. velocity_density Set density value used velocity plot. velocity_smooth Set smooth value used velocity plot. velocity_scale Set scale value used velocity plot. velocity_min_mass Set min_mass value used velocity plot. velocity_cutoff_perc Set cutoff_perc value used velocity plot. velocity_arrow_color Color arrows velocity plot. velocity_arrow_angle Angle arrows velocity plot. streamline_L Typical length streamline x y units streamline_minL Minimum length segments show. streamline_res Resolution parameter (higher numbers increases resolution). streamline_n Number points draw. streamline_width Size streamline. streamline_alpha Transparency streamline. streamline_color Color streamline. streamline_palette Color palette used streamline. streamline_palcolor Custom colors used streamline. streamline_bg_color Background color streamline. streamline_bg_stroke Border width streamline background. hex Whether chane plot type point hexagonal bin. hex.linewidth Border width hexagonal bins. hex.count Whether show cell counts hexagonal bin. hex.bins Number hexagonal bins. hex.binwidth Hexagonal bin width. raster Convert points raster format, default NULL automatically rasterizes plotting 100,000 cells raster.dpi Pixel resolution rasterized plots, passed geom_scattermore(). Default c(512, 512). aspect.ratio Aspect ratio panel. title text title. subtitle text subtitle plot displayed title. xlab x-axis label. ylab y-axis label. legend.position position legends (\"none\", \"left\", \"right\", \"bottom\", \"top\"). legend.direction Layout items legends (\"horizontal\" \"vertical\") theme_use Theme used. Can character string theme function. example, \"theme_blank\" ggplot2::theme_classic. theme_args arguments passed theme_use. combine Combine plots single patchwork object. FALSE, return list ggplot objects. nrow Number rows combined plot. ncol Number columns combined plot. byrow Logical value indicating plots arrange row (default) column. force Whether force drawing regardless maximum levels cell group greater 100. seed Random seed set reproducibility","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize cell groups on a 2-dimensional reduction plot — CellDimPlot","text":"","code":"data(\"pancreas_sub\") CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", theme_use = \"theme_blank\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", theme_use = ggplot2::theme_classic, theme_args = list(base_size = 16)) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") %>% panel_fix(height = 2, raster = TRUE, dpi = 30) #> Error in panel_fix(., height = 2, raster = TRUE, dpi = 30): unused arguments (height = 2, raster = TRUE, dpi = 30)  # Highlight cells CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\",   cells.highlight = colnames(pancreas_sub)[pancreas_sub$SubCellType == \"Epsilon\"] ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", split.by = \"Phase\", reduction = \"UMAP\",   cells.highlight = TRUE, theme_use = \"theme_blank\", legend.position = \"none\" ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Add group labels CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\",   label = TRUE, label.fg = \"orange\", label.bg = \"red\", label.size = 5 ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\",   label = TRUE, label_insitu = TRUE ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\",   label = TRUE, label_insitu = TRUE, label_repel = TRUE, label_segment_color = \"red\" ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Add various shape of marks CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_expand = unit(1, \"mm\")) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_alpha = 0.3) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_linetype = 2) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_type = \"ellipse\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_type = \"rect\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_mark = TRUE, mark_type = \"circle\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Add a density layer CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_density = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", add_density = TRUE, density_filled = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 396 rows containing missing values or values outside the scale range (`geom_raster()`).  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\",   add_density = TRUE, density_filled = TRUE, density_filled_palette = \"Blues\",   cells.highlight = TRUE ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 396 rows containing missing values or values outside the scale range (`geom_raster()`).   # Add statistical charts CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", stat.by = \"Phase\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", stat.by = \"Phase\", stat_plot_type = \"ring\", stat_plot_label = TRUE, stat_plot_size = 0.15) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`). #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", stat.by = \"Phase\", stat_plot_type = \"bar\", stat_type = \"count\", stat_plot_position = \"dodge\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix.  # Chane the plot type from point to the hexagonal bin CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", hex = TRUE) #> Error in check_R(\"hexbin\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", hex = TRUE, hex.bins = 20) #> Error in check_R(\"hexbin\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", hex = TRUE, hex.count = FALSE) #> Error in check_R(\"hexbin\"): could not find function \"check_R\"  # Show neighbors graphs on the plot pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:31:52.141118] Start Standard_SCP #> [2025-09-07 20:31:52.141285] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", graph = \"Standardpca_SNN\") #> Error in CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\",     graph = \"Standardpca_SNN\"): Graph Standardpca_SNN is not exist in the srt object. CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\", graph = \"Standardpca_SNN\", edge_color = \"grey80\") #> Error in CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"UMAP\",     graph = \"Standardpca_SNN\", edge_color = \"grey80\"): Graph Standardpca_SNN is not exist in the srt object.  # Show lineages on the plot based on the pseudotime pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", show_plot = FALSE) FeatureDimPlot(pancreas_sub, features = paste0(\"Lineage\", 1:3), reduction = \"UMAP\") #> Error in rescale(colors_value): could not find function \"rescale\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3)) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3), lineages_whiskers = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_segment()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix.  # Show PAGA results on the plot pancreas_sub <- RunPAGA(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", return_seurat = TRUE) #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", paga = pancreas_sub@misc$paga) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", paga = pancreas_sub@misc$paga, paga_type = \"connectivities_tree\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = 5, pt.alpha = 0.2,   label = TRUE, label_repel = TRUE, label_insitu = TRUE, label_segment_color = \"transparent\",   paga = pancreas_sub@misc$paga, paga_edge_threshold = 0.1, paga_edge_color = \"black\", paga_edge_alpha = 1,   legend.position = \"none\", theme_use = \"theme_blank\" ) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Show RNA velocity results on the plot pancreas_sub <- RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", mode = \"stochastic\", return_seurat = TRUE) #> Python module 'scvelo' is required for velocity analysis but is not installed. #> To install, run: PrepareEnv() and then check_Python('scvelo') #> Error in RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\",     nonlinear_reduction = \"UMAP\", mode = \"stochastic\", return_seurat = TRUE): Required Python module 'scvelo' is not available. Please install it first. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", paga = pancreas_sub@misc$paga, paga_show_transition = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = NA, velocity = \"stochastic\") #> Error in check_R(\"metR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = 5, pt.alpha = 0.2, velocity = \"stochastic\", velocity_plot_type = \"grid\") #> Error in check_R(\"metR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = 5, pt.alpha = 0.2, velocity = \"stochastic\", velocity_plot_type = \"grid\", velocity_scale = 1.5) #> Error in check_R(\"metR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = 5, pt.alpha = 0.2, velocity = \"stochastic\", velocity_plot_type = \"stream\") #> Error in check_R(\"metR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub,   group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = 5, pt.alpha = 0.2,   label = TRUE, label_insitu = TRUE,   velocity = \"stochastic\", velocity_plot_type = \"stream\", velocity_arrow_color = \"yellow\",   velocity_density = 2, velocity_smooth = 1, streamline_n = 20, streamline_color = \"black\",   legend.position = \"none\", theme_use = \"theme_blank\" ) #> Error in check_R(\"metR\"): could not find function \"check_R\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"3D-Dimensional reduction plot for cell classification visualization. — CellDimPlot3D","title":"3D-Dimensional reduction plot for cell classification visualization. — CellDimPlot3D","text":"Plotting cell points reduced 3D space coloring according groups cells.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"3D-Dimensional reduction plot for cell classification visualization. — CellDimPlot3D","text":"","code":"CellDimPlot3D(   srt,   group.by,   reduction = NULL,   dims = c(1, 2, 3),   axis_labs = NULL,   palette = \"Paired\",   palcolor = NULL,   bg_color = \"grey80\",   pt.size = 1.5,   cells.highlight = NULL,   cols.highlight = \"black\",   shape.highlight = \"circle-open\",   sizes.highlight = 2,   lineages = NULL,   lineages_palette = \"Dark2\",   span = 0.75,   width = NULL,   height = NULL,   save = NULL,   force = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"3D-Dimensional reduction plot for cell classification visualization. — CellDimPlot3D","text":"srt Seurat object. group.Name one meta.data columns group (color) cells (example, orig.ident). reduction dimensionality reduction use. specified, use reduction returned DefaultReduction. dims Dimensions plot, must three-length numeric vector specifying x-, y- z-dimensions axis_labs character vector length 3 indicating labels axes. palette Name color palette name collected SCP. Default \"Paired\". palcolor Custom colors used create color palette. bg_color Color value background(NA) points. pt.size Point size. cells.highlight vector cell names highlight. cols.highlight Color used highlight cells. shape.highlight Shape cell highlight. See scattergl-marker-symbol sizes.highlight Size highlighted cell points. lineages Lineages/pseudotime add plot. specified, curves fitted using loess method. lineages_palette Color palette used lineages. span numeric value specifying span loess smoother lineages line. width Width pixels, defaults automatic sizing. height Height pixels, defaults automatic sizing. save name file save plot . Must end \".html\". force Whether force drawing regardless maximum levels cell group greater 100.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellDimPlot3D.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"3D-Dimensional reduction plot for cell classification visualization. — CellDimPlot3D","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:32:02.098077] Start Standard_SCP #> [2025-09-07 20:32:02.098301] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot3D(pancreas_sub, group.by = \"SubCellType\", reduction = \"StandardpcaUMAP3D\") #> Error in col2hex(bg_color): could not find function \"col2hex\"  pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"StandardpcaUMAP3D\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot3D(pancreas_sub, group.by = \"SubCellType\", reduction = \"StandardpcaUMAP3D\", lineages = \"Lineage1\") #> Error in col2hex(bg_color): could not find function \"col2hex\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellScoring.html","id":null,"dir":"Reference","previous_headings":"","what":"CellScoring — CellScoring","title":"CellScoring — CellScoring","text":"function performs cell scoring Seurat object. calculates scores given set features adds scores metadata Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellScoring.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CellScoring — CellScoring","text":"","code":"CellScoring(   srt,   features = NULL,   slot = \"data\",   assay = NULL,   split.by = NULL,   IDtype = \"symbol\",   species = \"Homo_sapiens\",   db = \"GO_BP\",   termnames = NULL,   db_update = FALSE,   db_version = \"latest\",   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   minGSSize = 10,   maxGSSize = 500,   method = \"Seurat\",   classification = TRUE,   name = \"\",   new_assay = FALSE,   BPPARAM = BiocParallel::bpparam(),   seed = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellScoring.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CellScoring — CellScoring","text":"srt Seurat object features named list feature lists scoring. NULLL, db used create features sets. slot slot(layer) Seurat object use scoring. Defaults \"data\". assay assay Seurat object use scoring. Defaults NULL, case default assay object used. split.cell metadata variable used splitting Seurat object subsets performing scoring subset. Defaults NULL. IDtype character vector specifying type gene IDs srt object geneID argument. argument used convert gene IDs different type IDtype different result_IDtype. species character vector specifying species analysis performed. db character vector specifying name database used enrichment analysis. termnames vector term names used database. Defaults NULL, case features database used. db_update logical value indicating whether gene annotation databases forcefully updated. set FALSE, function attempt load cached databases instead. Default FALSE. db_version character vector specifying version database used. argument ignored db_update TRUE. Default \"latest\". convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. minGSSize numeric value specifying minimum size gene set considered enrichment analysis. maxGSSize numeric value specifying maximum size gene set considered enrichment analysis. method method use scoring. Can \"Seurat\", \"AUCell\", \"UCell\". Defaults \"Seurat\". classification Whether perform classification based scores. Defaults TRUE. name name assay store scores . used new_assay TRUE. Defaults empty string. new_assay Whether create new assay storing scores. Defaults FALSE. BPPARAM BiocParallel parameter object. Defaults BiocParallel::bpparam(). seed random seed reproducibility. Defaults 11. ... Additional arguments passed scoring methods.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellScoring.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"CellScoring — CellScoring","text":"","code":"data(\"pancreas_sub\") ccgenes <- CC_GenePrefetch(\"Mus_musculus\") #> Connect to the Ensembl archives... #> Using the 103 version of biomart... #> Connecting to the biomart... #> Searching the dataset hsapiens ... #> Connecting to the dataset hsapiens_gene_ensembl ... #> Converting the geneIDs... #> 97 genes mapped with ensembl_symbol #> ============================== #> 97 genes mapped #> 0 genes unmapped #> ============================== #> Error in unnest(data = geneID_collapse, cols = colnames(geneID_collapse)[sapply(geneID_collapse,     class) %in% c(\"list\", \"AsIs\")], keep_empty = FALSE): could not find function \"unnest\" pancreas_sub <- CellScoring(   srt = pancreas_sub,   features = list(S = ccgenes$S, G2M = ccgenes$G2M),   method = \"Seurat\", name = \"CC\" ) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, \"CC_classification\") #> Error in CellDimPlot(pancreas_sub, \"CC_classification\"): CC_classification is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, \"CC_G2M\") #> Warning: CC_G2M are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, \"CC_G2M\"): There are no valid features present.  if (FALSE) { # \\dontrun{ data(\"panc8_sub\") panc8_sub <- Integration_SCP(panc8_sub,   batch = \"tech\", integration_method = \"Seurat\" ) CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\"))  panc8_sub <- CellScoring(   srt = panc8_sub, slot = \"data\", assay = \"RNA\",   db = \"GO_BP\", species = \"Homo_sapiens\",   minGSSize = 10, maxGSSize = 100,   method = \"Seurat\", name = \"GO\", new_assay = TRUE ) panc8_sub <- Integration_SCP(panc8_sub,   assay = \"GO\",   batch = \"tech\", integration_method = \"Seurat\" ) CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\"))  pancreas_sub <- CellScoring(   srt = pancreas_sub, slot = \"data\", assay = \"RNA\",   db = \"GO_BP\", species = \"Mus_musculus\",   termnames = panc8_sub[[\"GO\"]]@meta.features[, \"termnames\"],   method = \"Seurat\", name = \"GO\", new_assay = TRUE ) pancreas_sub <- Standard_SCP(pancreas_sub, assay = \"GO\") CellDimPlot(pancreas_sub, \"SubCellType\")  pancreas_sub[[\"tech\"]] <- \"Mouse\" panc_merge <- Integration_SCP(   srtList = list(panc8_sub, pancreas_sub),   assay = \"GO\",   batch = \"tech\", integration_method = \"Seurat\" ) CellDimPlot(panc_merge, group.by = c(\"tech\", \"celltype\", \"SubCellType\", \"Phase\"))  genenames <- make.unique(capitalize(rownames(panc8_sub[[\"RNA\"]]), force_tolower = TRUE)) panc8_sub <- RenameFeatures(panc8_sub, newnames = genenames, assay = \"RNA\") head(rownames(panc8_sub)) panc_merge <- Integration_SCP(   srtList = list(panc8_sub, pancreas_sub),   assay = \"RNA\",   batch = \"tech\", integration_method = \"Seurat\" ) CellDimPlot(panc_merge, group.by = c(\"tech\", \"celltype\", \"SubCellType\", \"Phase\")) } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellStatPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistical plot of cells — CellStatPlot","title":"Statistical plot of cells — CellStatPlot","text":"Statistical plot cells","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellStatPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistical plot of cells — CellStatPlot","text":"","code":"CellStatPlot(   srt,   stat.by,   group.by = NULL,   split.by = NULL,   bg.by = NULL,   cells = NULL,   flip = FALSE,   NA_color = \"grey\",   NA_stat = TRUE,   keep_empty = FALSE,   individual = FALSE,   stat_level = NULL,   plot_type = c(\"bar\", \"rose\", \"ring\", \"pie\", \"trend\", \"area\", \"dot\", \"sankey\", \"chord\",     \"venn\", \"upset\"),   stat_type = c(\"percent\", \"count\"),   position = c(\"stack\", \"dodge\"),   palette = \"Paired\",   palcolor = NULL,   alpha = 1,   bg_palette = \"Paired\",   bg_palcolor = NULL,   bg_alpha = 0.2,   label = FALSE,   label.size = 3.5,   label.fg = \"black\",   label.bg = \"white\",   label.bg.r = 0.1,   aspect.ratio = NULL,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellStatPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistical plot of cells — CellStatPlot","text":"srt Seurat object. stat.column name(s) meta.data specifying variable(s) plotted. group.column name meta.data specifying grouping variable. split.column name meta.data specifying splitting variable. bg.column name meta.data specifying background variable bar plots. cells character vector specifying cells include plot. Default NULL. flip Logical indicating whether flip plot. NA_color color use missing values. NA_stat Logical indicating whether include missing values plot. keep_empty Logical indicating whether keep empty groups plot. individual Logical indicating whether plot individual groups separately. stat_level level(s) variable(s) specified stat.include plot. plot_type type plot create. Can one \"bar\", \"rose\", \"ring\", \"pie\", \"trend\", \"area\", \"dot\", \"sankey\", \"chord\", \"venn\", \"upset\". stat_type type statistic compute plot. Can one \"percent\" \"count\". position position adjustment plot. Can one \"stack\" \"dodge\". palette name color palette use plot. palcolor color use color palette. alpha transparency level plot. bg_palette name background color palette use bar plots. bg_palcolor color use background color palette. bg_alpha transparency level background color bar plots. label Logical indicating whether add labels plot. label.size size labels. label.fg foreground color labels. label.bg background color labels. label.bg.r radius rounded corners label background. aspect.ratio aspect ratio plot. title main title plot. subtitle subtitle plot. xlab x-axis label plot. ylab y-axis label plot. legend.position position legend plot. Can one \"right\", \"left\", \"bottom\", \"top\", \"none\". legend.direction direction legend plot. Can one \"vertical\" \"horizontal\". theme_use name theme use plot. Can one predefined themes custom theme. theme_args list arguments passed theme function. combine Logical indicating whether combine multiple plots single plot. nrow number rows combined plot. ncol number columns combined plot. byrow Logical indicating whether fill plot row column. force Logical indicating whether force plot even variables 100 levels. seed random seed use reproducible results.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CellStatPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistical plot of cells — CellStatPlot","text":"","code":"data(\"pancreas_sub\") CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"SubCellType\", label = TRUE)  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"SubCellType\", label = TRUE) %>% panel_fix(height = 2, width = 3) #> Error in panel_fix(., height = 2, width = 3): unused arguments (height = 2, width = 3) CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"SubCellType\", stat_type = \"count\", position = \"dodge\", label = TRUE)  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"SubCellType\", bg.by = \"CellType\", palette = \"Set1\", stat_type = \"count\", position = \"dodge\")   CellStatPlot(pancreas_sub, stat.by = \"Phase\", plot_type = \"bar\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", plot_type = \"rose\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", plot_type = \"ring\") #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`).  CellStatPlot(pancreas_sub, stat.by = \"Phase\", plot_type = \"pie\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", plot_type = \"dot\")   CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"bar\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"rose\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"ring\") #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`).  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"area\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"dot\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"trend\")   CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"bar\", individual = TRUE)   CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"bar\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"rose\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"ring\") #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`).  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"area\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"dot\")  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"trend\")   CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"bar\", position = \"dodge\", label = TRUE)  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"rose\", position = \"dodge\", label = TRUE)  CellStatPlot(pancreas_sub, stat.by = \"Phase\", group.by = \"CellType\", stat_type = \"count\", plot_type = \"ring\", position = \"dodge\", label = TRUE) #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`).   CellStatPlot(pancreas_sub, stat.by = c(\"CellType\", \"Phase\"), plot_type = \"sankey\") #> Warning: stat_type is forcibly set to 'count' when plot sankey, chord, venn or upset #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellStatPlot(pancreas_sub, stat.by = c(\"CellType\", \"Phase\"), plot_type = \"chord\") #> Warning: stat_type is forcibly set to 'count' when plot sankey, chord, venn or upset   CellStatPlot(pancreas_sub,   stat.by = c(\"CellType\", \"Phase\"), plot_type = \"venn\",   stat_level = list(CellType = c(\"Ductal\", \"Ngn3 low EP\"), Phase = \"S\") ) #> Warning: stat_type is forcibly set to 'count' when plot sankey, chord, venn or upset #> Error in check_R(c(\"ggVennDiagram\", \"sf\")): could not find function \"check_R\" pancreas_sub$Progenitor <- pancreas_sub$CellType %in% c(\"Ngn3 low EP\", \"Ngn3 high EP\") pancreas_sub$G2M <- pancreas_sub$Phase == \"G2M\" pancreas_sub$Sox9_Expressed <- pancreas_sub[[\"RNA\"]]@counts[\"Sox9\", ] > 0 pancreas_sub$Neurog3_Expressed <- pancreas_sub[[\"RNA\"]]@counts[\"Neurog3\", ] > 0 CellStatPlot(pancreas_sub, stat.by = c(\"Progenitor\", \"G2M\", \"Sox9_Expressed\", \"Neurog3_Expressed\"), plot_type = \"venn\", stat_level = \"TRUE\") #> Warning: stat_type is forcibly set to 'count' when plot sankey, chord, venn or upset #> Error in check_R(c(\"ggVennDiagram\", \"sf\")): could not find function \"check_R\" CellStatPlot(pancreas_sub, stat.by = c(\"Progenitor\", \"G2M\", \"Sox9_Expressed\", \"Neurog3_Expressed\"), plot_type = \"upset\", stat_level = \"TRUE\") #> Warning: stat_type is forcibly set to 'count' when plot sankey, chord, venn or upset #> Error in check_R(\"ggupset\"): could not find function \"check_R\" sum(pancreas_sub$Progenitor == \"FALSE\" &   pancreas_sub$G2M == \"FALSE\" &   pancreas_sub$Sox9_Expressed == \"TRUE\" &   pancreas_sub$Neurog3_Expressed == \"FALSE\") #> [1] 218"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ComBat_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Combat_integrate — ComBat_integrate","title":"Combat_integrate — ComBat_integrate","text":"Combat_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ComBat_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Combat_integrate — ComBat_integrate","text":"","code":"ComBat_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   ComBat_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ComBat_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Combat_integrate — ComBat_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). ComBat_params list parameters sva::ComBat function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Conos_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Conos_integrate — Conos_integrate","title":"Conos_integrate — Conos_integrate","text":"Conos_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Conos_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conos_integrate — Conos_integrate","text":"","code":"Conos_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   buildGraph_params = list(),   num_threads = 2,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Conos_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conos_integrate — Conos_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). buildGraph_params list parameters buildGraph function, default empty list. num_threads integer setting number threads Conos, default 2. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateDataFile.html","id":null,"dir":"Reference","previous_headings":"","what":"CreateDataFile — CreateDataFile","title":"CreateDataFile — CreateDataFile","text":"Creates data file HDF5 format Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateDataFile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CreateDataFile — CreateDataFile","text":"","code":"CreateDataFile(   srt,   DataFile,   name = NULL,   assays = \"RNA\",   slots = \"data\",   compression_level = 6,   overwrite = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateDataFile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CreateDataFile — CreateDataFile","text":"srt Seurat object. DataFile Path output data file. provided, file named \"Data.hdf5\" current directory. name Name dataset. provided, name default Seurat object's project name. assays Character vector specifying assays include data file. Default \"RNA\". slots Character vector specifying slots include data file. Default \"data\". compression_level Compression level HDF5 dataset. Default 6. overwrite Logical value indicating whether overwrite existing data data file. Default FALSE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateMetaFile.html","id":null,"dir":"Reference","previous_headings":"","what":"CreateMetaFile — CreateMetaFile","title":"CreateMetaFile — CreateMetaFile","text":"Creates meta file HDF5 format Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateMetaFile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"CreateMetaFile — CreateMetaFile","text":"","code":"CreateMetaFile(   srt,   MetaFile,   name = NULL,   write_tools = FALSE,   write_misc = FALSE,   ignore_nlevel = 100,   compression_level = 6,   overwrite = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/CreateMetaFile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"CreateMetaFile — CreateMetaFile","text":"srt Seurat object. MetaFile Path output meta file. provided, file named \"Meta.hdf5\" current directory. name Name dataset. provided, name default Seurat object's project name. write_tools logical value indicating whether write tools information meta file. Default FALSE. write_misc logical value indicating whether write miscellaneous information meta file. Default FALSE. ignore_nlevel number levels metadata field ignored. Default 100. compression_level level compression meta file. Default 6. overwrite logical value indicating whether overwrite existing metadata reductions meta file. Default FALSE. @seealso CreateDataFile PrepareSCExplorer FetchH5 RunSCExplorer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DefaultReduction.html","id":null,"dir":"Reference","previous_headings":"","what":"Find the default reduction name in a Seurat object. — DefaultReduction","title":"Find the default reduction name in a Seurat object. — DefaultReduction","text":"Find default reduction name Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DefaultReduction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find the default reduction name in a Seurat object. — DefaultReduction","text":"","code":"DefaultReduction(srt, pattern = NULL, min_dim = 2, max_distance = 0.1)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DefaultReduction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find the default reduction name in a Seurat object. — DefaultReduction","text":"srt Seurat object. pattern Character string containing regular expression search . min_dim Minimum dimension threshold. max_distance Maximum distance allowed match.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DefaultReduction.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find the default reduction name in a Seurat object. — DefaultReduction","text":"Default reduction name.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DefaultReduction.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find the default reduction name in a Seurat object. — DefaultReduction","text":"","code":"data(\"pancreas_sub\") names(pancreas_sub@reductions) #> [1] \"PCA\"  \"UMAP\" DefaultReduction(pancreas_sub) #> [1] \"UMAP\"  # Searches for matches to \"pca\" DefaultReduction(pancreas_sub, pattern = \"pca\") #> [1] \"PCA\"  # Searches for approximate matches to \"pc\" DefaultReduction(pancreas_sub, pattern = \"pc\") #> [1] \"PCA\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Heatmap plot for dynamic features along lineages — DynamicHeatmap","title":"Heatmap plot for dynamic features along lineages — DynamicHeatmap","text":"Heatmap plot dynamic features along lineages","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Heatmap plot for dynamic features along lineages — DynamicHeatmap","text":"","code":"DynamicHeatmap(   srt,   lineages,   features = NULL,   use_fitted = FALSE,   border = TRUE,   flip = FALSE,   min_expcells = 20,   r.sq = 0.2,   dev.expl = 0.2,   padjust = 0.05,   num_intersections = NULL,   cell_density = 1,   cell_bins = 100,   order_by = c(\"peaktime\", \"valleytime\"),   slot = \"counts\",   assay = NULL,   exp_method = c(\"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\"),   exp_legend_title = NULL,   limits = NULL,   lib_normalize = identical(slot, \"counts\"),   libsize = NULL,   family = NULL,   cluster_features_by = NULL,   cluster_rows = FALSE,   cluster_row_slices = FALSE,   cluster_columns = FALSE,   cluster_column_slices = FALSE,   show_row_names = FALSE,   show_column_names = FALSE,   row_names_side = ifelse(flip, \"left\", \"right\"),   column_names_side = ifelse(flip, \"bottom\", \"top\"),   row_names_rot = 0,   column_names_rot = 90,   row_title = NULL,   column_title = NULL,   row_title_side = \"left\",   column_title_side = \"top\",   row_title_rot = 0,   column_title_rot = ifelse(flip, 90, 0),   feature_split = NULL,   feature_split_by = NULL,   n_split = NULL,   split_order = NULL,   split_method = c(\"mfuzz\", \"kmeans\", \"kmeans-peaktime\", \"hclust\", \"hclust-peaktime\"),   decreasing = FALSE,   fuzzification = NULL,   anno_terms = FALSE,   anno_keys = FALSE,   anno_features = FALSE,   terms_width = unit(4, \"in\"),   terms_fontsize = 8,   keys_width = unit(2, \"in\"),   keys_fontsize = c(6, 10),   features_width = unit(2, \"in\"),   features_fontsize = c(6, 10),   IDtype = \"symbol\",   species = \"Homo_sapiens\",   db_update = FALSE,   db_version = \"latest\",   db_combine = FALSE,   convert_species = FALSE,   Ensembl_version = 103,   mirror = NULL,   db = \"GO_BP\",   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   GO_simplify = FALSE,   GO_simplify_cutoff = \"p.adjust < 0.05\",   simplify_method = \"Wang\",   simplify_similarityCutoff = 0.7,   pvalueCutoff = NULL,   padjustCutoff = 0.05,   topTerm = 5,   show_termid = FALSE,   topWord = 20,   words_excluded = NULL,   nlabel = 20,   features_label = NULL,   label_size = 10,   label_color = \"black\",   pseudotime_label = NULL,   pseudotime_label_color = \"black\",   pseudotime_label_linetype = 2,   pseudotime_label_linewidth = 3,   heatmap_palette = \"viridis\",   heatmap_palcolor = NULL,   pseudotime_palette = \"cividis\",   pseudotime_palcolor = NULL,   feature_split_palette = \"simspec\",   feature_split_palcolor = NULL,   cell_annotation = NULL,   cell_annotation_palette = \"Paired\",   cell_annotation_palcolor = NULL,   cell_annotation_params = if (flip) list(width = unit(5, \"mm\")) else list(height =     unit(5, \"mm\")),   feature_annotation = NULL,   feature_annotation_palette = \"Dark2\",   feature_annotation_palcolor = NULL,   feature_annotation_params = if (flip) list(height = unit(5, \"mm\")) else list(width =     unit(5, \"mm\")),   separate_annotation = NULL,   separate_annotation_palette = \"Paired\",   separate_annotation_palcolor = NULL,   separate_annotation_params = if (flip) list(width = unit(10, \"mm\")) else list(height =     unit(10, \"mm\")),   reverse_ht = NULL,   use_raster = NULL,   raster_device = \"png\",   raster_by_magick = FALSE,   height = NULL,   width = NULL,   units = \"inch\",   seed = 11,   ht_params = list() )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Heatmap plot for dynamic features along lineages — DynamicHeatmap","text":"srt Seurat object. lineages character vector specifying lineages plot. features character vector specifying features plot. default, parameter set NULL, dynamic features determined parameters  min_expcells, r.sq, dev.expl, padjust num_intersections. use_fitted logical indicating whether use fitted values. Default FALSE. border logical indicating whether add border heatmap. Default TRUE. flip logical indicating whether flip heatmap. Default FALSE. min_expcells numeric value specifying minimum number expected cells. Default 20. r.sq numeric value specifying R-squared threshold. Default 0.2. dev.expl numeric value specifying deviance explained threshold. Default 0.2. padjust numeric value specifying p-value adjustment threshold. Default 0.05. num_intersections parameter numeric vector used determine number intersections among lineages. helps selecting dynamic features used. default, parameter set NULL, dynamic features pass specified threshold used lineage. cell_density numeric value used define cell density within cell bin. default, parameter set 1, means cells included within cell bin. cell_bins numeric value specifying number cell bins. Default 100. order_by character vector specifying order heatmap. Default \"peaktime\". slot character vector specifying slot Seurat object use. Default \"counts\". assay character vector specifying assay Seurat object use. Default NULL. exp_method character vector specifying method calculating expression values. Default \"zscore\" options \"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\". exp_legend_title character vector specifying title legend expression value. Default NULL. limits two-length numeric vector specifying limits color scale. Default NULL. lib_normalize logical value indicating whether normalize data library size. libsize numeric vector specifying library size cell. Default NULL. family character specifying model used calculate dynamic features needed. default, parameter set NULL, appropriate family automatically determined. cluster_features_by character vector specifying lineage use clustering features. default, parameter set NULL, means lineages used. cluster_rows logical value indicating whether cluster rows heatmap. Default FALSE. cluster_row_slices logical value indicating whether cluster row slices heatmap. Default FALSE. cluster_columns logical value indicating whether cluster columns heatmap. Default FALSE. cluster_column_slices logical value indicating whether cluster column slices heatmap. Default FALSE. show_row_names logical value indicating whether show row names heatmap. Default FALSE. show_column_names logical value indicating whether show column names heatmap. Default FALSE. row_names_side character vector specifying side place row names. column_names_side character vector specifying side place column names. row_names_rot numeric value specifying rotation angle row names. Default 0. column_names_rot numeric value specifying rotation angle column names. Default 90. row_title character vector specifying title rows. Default NULL. column_title character vector specifying title columns. Default NULL. row_title_side character vector specifying side place row title. Default \"left\". column_title_side character vector specifying side place column title. Default \"top\". row_title_rot numeric value specifying rotation angle row title. Default 0. column_title_rot numeric value specifying rotation angle column title. feature_split factor specifying split features. Default NULL. feature_split_by character vector specifying group.use splitting features (n_split feature clusters). Default NULL. n_split integer specifying number feature splits (feature clusters) create. Default NULL. split_order numeric vector specifying order splits. Default NULL. split_method character vector specifying method splitting features. Default \"kmeans\" options \"kmeans\", \"hclust\", \"mfuzz\"). decreasing logical value indicating whether sort feature splits decreasing order. Default FALSE. fuzzification numeric value specifying fuzzification coefficient. Default NULL. anno_terms logical value indicating whether include term annotations. Default FALSE. anno_keys logical value indicating whether include key annotations. Default FALSE. anno_features logical value indicating whether include feature annotations. Default FALSE. terms_width unit specifying width term annotations. Default unit(4, \"\"). terms_fontsize numeric vector specifying font size(s) term annotations. Default 8. keys_width unit specifying width key annotations. Default unit(2, \"\"). keys_fontsize two-length numeric vector specifying minimum maximum font size(s) key annotations. Default c(6, 10). features_width unit specifying width feature annotations. Default unit(2, \"\"). features_fontsize two-length numeric vector specifying minimum maximum font size(s) feature annotations. Default c(6, 10). IDtype character vector specifying type IDs features. Default \"symbol\". species character vector specifying species features. Default \"Homo_sapiens\". db_update logical value indicating whether update database. Default FALSE. db_version character vector specifying version database. Default \"latest\". db_combine logical value indicating whether use combined database. Default FALSE. convert_species logical value indicating whether use species-converted database annotation missing species. Default FALSE. Ensembl_version integer specifying Ensembl version. Default 103. mirror character vector specifying mirror Ensembl database. Default NULL. db character vector specifying database use. Default \"GO_BP\". TERM2GENE data.frame specifying TERM2GENE mapping database. Default NULL. TERM2NAME data.frame specifying TERM2NAME mapping database. Default NULL. minGSSize integer specifying minimum gene set size database. Default 10. maxGSSize integer specifying maximum gene set size database. Default 500. GO_simplify logical value indicating whether simplify gene ontology terms. Default FALSE. GO_simplify_cutoff character vector specifying cutoff GO simplification. Default \"p.adjust < 0.05\". simplify_method character vector specifying method GO simplification. Default \"Wang\". simplify_similarityCutoff numeric value specifying similarity cutoff GO simplification. Default 0.7. pvalueCutoff numeric vector specifying p-value cutoff(s) significance. Default NULL. padjustCutoff numeric value specifying adjusted p-value cutoff significance. Default 0.05. topTerm integer specifying number top terms include. Default 5. show_termid logical value indicating whether show term IDs. Default FALSE. topWord integer specifying number top words include. Default 20. words_excluded character vector specifying words exclude. Default NULL. nlabel integer specifying number labels include. Default 0. features_label character vector specifying features label. Default NULL. label_size numeric value specifying size labels. Default 10. label_color character vector specifying color labels. Default \"black\". pseudotime_label numeric vector specifying pseudotime label. Default NULL. pseudotime_label_color character string specifying pseudotime label color. Default \"black\". pseudotime_label_linetype numeric value specifying pseudotime label line type. Default 2. pseudotime_label_linewidth numeric value specifying pseudotime label line width. Default 3. heatmap_palette character vector specifying palette use heatmap. Default \"RdBu\". heatmap_palcolor character vector specifying heatmap color use. Default NULL. pseudotime_palette character vector specifying color palette use pseudotime. pseudotime_palcolor list specifying colors use pseudotime heatmap. feature_split_palette character vector specifying palette use feature splits. Default \"simspec\". feature_split_palcolor character vector specifying feature split color use. Default NULL. cell_annotation character vector specifying cell annotation(s) include. Default NULL. cell_annotation_palette character vector specifying palette use cell annotations. length vector match number cell_annotation. Default \"Paired\". cell_annotation_palcolor list character vector specifying cell annotation color(s) use. length list match number cell_annotation. Default NULL. cell_annotation_params list specifying additional parameters cell annotations. Default list width = unit(1, \"cm\") flip TRUE, else list height = unit(1, \"cm\"). feature_annotation character vector specifying feature annotation(s) include. Default NULL. feature_annotation_palette character vector specifying palette use feature annotations. length vector match number feature_annotation. Default \"Dark2\". feature_annotation_palcolor list character vector specifying feature annotation color use. length list match number feature_annotation. Default NULL. feature_annotation_params list specifying additional parameters feature annotations. Default empty list. separate_annotation character vector names annotations displayed separate annotation blocks. name match column name metadata Seurat object. separate_annotation_palette character vector specifying color palette use separate annotations. separate_annotation_palcolor list specifying colors use level separate annotations. separate_annotation_params list parameters passed HeatmapAnnotation function creating separate annotation blocks. reverse_ht logical indicating whether reverse heatmap. Default NULL. use_raster logical value indicating whether use raster device plotting. Default NULL. raster_device character vector specifying raster device use. Default \"png\". raster_by_magick logical value indicating whether use 'magick' package raster. Default FALSE. height numeric vector specifying height(s) heatmap body. Default NULL. width numeric vector specifying width(s) heatmap body. Default NULL. units character vector specifying units height width. Default \"inch\". seed integer specifying random seed. Default 11. ht_params list specifying additional parameters passed ComplexHeatmap::Heatmap function. Default empty list.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Heatmap plot for dynamic features along lineages — DynamicHeatmap","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. pancreas_sub <- RunDynamicFeatures(pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"), n_candidates = 200) #> [2025-09-07 20:32:27.819024] Start RunDynamicFeatures #> Workers: 2 #> Error in check_R(\"mgcv\"): could not find function \"check_R\" ht1 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = \"Lineage1\",   n_split = 5,   split_method = \"kmeans-peaktime\",   cell_annotation = \"SubCellType\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = \"Lineage1\", n_split = 5,     split_method = \"kmeans-peaktime\", cell_annotation = \"SubCellType\"): lineages: Lineage1 is not in the meta data of the Seurat object ht1$plot #> Error: object 'ht1' not found panel_fix(ht1$plot, raster = TRUE, dpi = 50) #> Error in panel_fix(ht1$plot, raster = TRUE, dpi = 50): unused arguments (raster = TRUE, dpi = 50)  ht2 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = \"Lineage1\",   features = c(\"Sox9\", \"Neurod2\", \"Isl1\", \"Rbp4\", \"Pyy\", \"S_score\", \"G2M_score\"),   cell_annotation = \"SubCellType\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = \"Lineage1\", features = c(\"Sox9\",     \"Neurod2\", \"Isl1\", \"Rbp4\", \"Pyy\", \"S_score\", \"G2M_score\"),     cell_annotation = \"SubCellType\"): lineages: Lineage1 is not in the meta data of the Seurat object ht2$plot #> Error: object 'ht2' not found panel_fix(ht2$plot, height = 5, width = 5, raster = TRUE, dpi = 50) #> Error in panel_fix(ht2$plot, height = 5, width = 5, raster = TRUE, dpi = 50): unused arguments (height = 5, width = 5, raster = TRUE, dpi = 50)  ht3 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   n_split = 5,   split_method = \"kmeans\",   cluster_rows = TRUE,   cell_annotation = \"SubCellType\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),     n_split = 5, split_method = \"kmeans\", cluster_rows = TRUE,     cell_annotation = \"SubCellType\"): lineages: Lineage1 is not in the meta data of the Seurat object ht3$plot #> Error: object 'ht3' not found  pancreas_sub <- AnnotateFeatures(pancreas_sub, species = \"Mus_musculus\", db = c(\"TF\", \"CSPA\")) #> Species: Mus_musculus #> Preparing database: TF #> Error in download(url = url, destfile = temp): could not find function \"download\" ht4 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   reverse_ht = \"Lineage1\",   use_fitted = TRUE,   n_split = 6,   split_method = \"mfuzz\",   heatmap_palette = \"viridis\",   cell_annotation = c(\"SubCellType\", \"Phase\", \"G2M_score\"),   cell_annotation_palette = c(\"Paired\", \"simspec\", \"Purples\"),   separate_annotation = list(\"SubCellType\", c(\"Nnat\", \"Irx1\")),   separate_annotation_palette = c(\"Paired\", \"Set1\"),   separate_annotation_params = list(height = unit(10, \"mm\")),   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   pseudotime_label = 25,   pseudotime_label_color = \"red\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),     reverse_ht = \"Lineage1\", use_fitted = TRUE, n_split = 6,     split_method = \"mfuzz\", heatmap_palette = \"viridis\", cell_annotation = c(\"SubCellType\",         \"Phase\", \"G2M_score\"), cell_annotation_palette = c(\"Paired\",         \"simspec\", \"Purples\"), separate_annotation = list(\"SubCellType\",         c(\"Nnat\", \"Irx1\")), separate_annotation_palette = c(\"Paired\",         \"Set1\"), separate_annotation_params = list(height = unit(10,         \"mm\")), feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\",         \"steelblue\"), c(\"forestgreen\")), pseudotime_label = 25,     pseudotime_label_color = \"red\"): lineages: Lineage1 is not in the meta data of the Seurat object ht4$plot #> Error: object 'ht4' not found  ht5 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   reverse_ht = \"Lineage1\",   use_fitted = TRUE,   n_split = 6,   split_method = \"mfuzz\",   heatmap_palette = \"viridis\",   cell_annotation = c(\"SubCellType\", \"Phase\", \"G2M_score\"),   cell_annotation_palette = c(\"Paired\", \"simspec\", \"Purples\"),   separate_annotation = list(\"SubCellType\", c(\"Nnat\", \"Irx1\")),   separate_annotation_palette = c(\"Paired\", \"Set1\"),   separate_annotation_params = list(width = unit(10, \"mm\")),   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   pseudotime_label = 25,   pseudotime_label_color = \"red\",   flip = TRUE, column_title_rot = 45 ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),     reverse_ht = \"Lineage1\", use_fitted = TRUE, n_split = 6,     split_method = \"mfuzz\", heatmap_palette = \"viridis\", cell_annotation = c(\"SubCellType\",         \"Phase\", \"G2M_score\"), cell_annotation_palette = c(\"Paired\",         \"simspec\", \"Purples\"), separate_annotation = list(\"SubCellType\",         c(\"Nnat\", \"Irx1\")), separate_annotation_palette = c(\"Paired\",         \"Set1\"), separate_annotation_params = list(width = unit(10,         \"mm\")), feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\",         \"steelblue\"), c(\"forestgreen\")), pseudotime_label = 25,     pseudotime_label_color = \"red\", flip = TRUE, column_title_rot = 45): lineages: Lineage1 is not in the meta data of the Seurat object ht5$plot #> Error: object 'ht5' not found  ht6 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   reverse_ht = \"Lineage1\",   cell_annotation = \"SubCellType\",   n_split = 5, split_method = \"mfuzz\",   species = \"Mus_musculus\", db = \"GO_BP\",   anno_terms = TRUE, anno_keys = TRUE, anno_features = TRUE ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),     reverse_ht = \"Lineage1\", cell_annotation = \"SubCellType\",     n_split = 5, split_method = \"mfuzz\", species = \"Mus_musculus\",     db = \"GO_BP\", anno_terms = TRUE, anno_keys = TRUE, anno_features = TRUE): lineages: Lineage1 is not in the meta data of the Seurat object ht6$plot #> Error: object 'ht6' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"DynamicPlot — DynamicPlot","title":"DynamicPlot — DynamicPlot","text":"Plot dynamic features across pseudotime.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DynamicPlot — DynamicPlot","text":"","code":"DynamicPlot(   srt,   lineages,   features,   group.by = NULL,   cells = NULL,   slot = \"counts\",   assay = NULL,   family = NULL,   exp_method = c(\"log1p\", \"raw\", \"zscore\", \"fc\", \"log2fc\"),   lib_normalize = identical(slot, \"counts\"),   libsize = NULL,   compare_lineages = TRUE,   compare_features = FALSE,   add_line = TRUE,   add_interval = TRUE,   line.size = 1,   line_palette = \"Dark2\",   line_palcolor = NULL,   add_point = TRUE,   pt.size = 1,   point_palette = \"Paired\",   point_palcolor = NULL,   add_rug = TRUE,   flip = FALSE,   reverse = FALSE,   x_order = c(\"value\", \"rank\"),   aspect.ratio = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DynamicPlot — DynamicPlot","text":"srt Seurat object. lineages character vector specifying lineages plot. features character vector specifying features plot. group.character specifying metadata column group cells . Default NULL. cells character vector specifying cells include plot. Default NULL. slot character string specifying slot use analysis. Default \"counts\". assay character string specifying assay use analysis. Default NULL. family character specifying model used calculate dynamic features needed. default, parameter set NULL, appropriate family automatically determined. exp_method character specifying method transform expression values. Default \"log1p\" options \"log1p\", \"raw\", \"zscore\", \"fc\", \"log2fc\". lib_normalize boolean specifying whether normalize expression values using library size. default, slot counts, parameter set TRUE. Otherwise, set FALSE. libsize numeric vector specifying library size cell. Default NULL. compare_lineages boolean specifying whether compare lineages plot. Default TRUE. compare_features boolean specifying whether compare features plot. Default FALSE. add_line boolean specifying whether add lines plot. Default TRUE. add_interval boolean specifying whether add confidence intervals plot. Default TRUE. line.size numeric specifying size lines. Default 1. line_palette character string specifying name palette use line colors. Default \"Dark2\". line_palcolor vector specifying colors use line palette. Default NULL. add_point boolean specifying whether add points plot. Default TRUE. pt.size numeric specifying size points. Default 1. point_palette character string specifying name palette use point colors. Default \"Paired\". point_palcolor vector specifying colors use point palette. Default NULL. add_rug boolean specifying whether add rugs plot. Default TRUE. flip boolean specifying whether flip x-axis. Default FALSE. reverse boolean specifying whether reverse x-axis. Default FALSE. x_order character specifying order x-axis values. Default c(\"value\", \"rank\"). aspect.ratio numeric specifying aspect ratio plot. Default NULL. legend.position character string specifying position legend plot. Default \"right\". legend.direction character string specifying direction legend plot. Default \"vertical\". theme_use character string specifying name theme use plot. Default \"theme_scp\". theme_args list specifying arguments pass theme function. Default list(). combine boolean specifying whether combine multiple plots single plot. Default TRUE. nrow numeric specifying number rows combined plot. Default NULL. ncol numeric specifying number columns combined plot. Default NULL. byrow boolean specifying whether fill plots row combined plot. Default TRUE. seed numeric specifying random seed. Default 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/DynamicPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"DynamicPlot — DynamicPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1) #> Error in CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\",     lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1): Lineage1 is not in the meta.data of srt object. DynamicPlot(   srt = pancreas_sub,   lineages = \"Lineage1\",   features = c(\"Nnat\", \"Irx1\", \"G2M_score\"),   group.by = \"SubCellType\",   compare_features = TRUE ) #> Error in check_R(\"MatrixGenerics\"): could not find function \"check_R\" DynamicPlot(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   features = c(\"Nnat\", \"Irx1\", \"G2M_score\"),   group.by = \"SubCellType\",   compare_lineages = TRUE,   compare_features = FALSE ) #> Error in check_R(\"MatrixGenerics\"): could not find function \"check_R\" DynamicPlot(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   features = c(\"Nnat\", \"Irx1\", \"G2M_score\"),   group.by = \"SubCellType\",   compare_lineages = FALSE,   compare_features = FALSE ) #> Error in check_R(\"MatrixGenerics\"): could not find function \"check_R\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnrichmentPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"EnrichmentPlot — EnrichmentPlot","title":"EnrichmentPlot — EnrichmentPlot","text":"function generates various types plots enrichment (-representation) analysis.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnrichmentPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EnrichmentPlot — EnrichmentPlot","text":"","code":"EnrichmentPlot(   srt,   db = \"GO_BP\",   group_by = NULL,   test.use = \"wilcox\",   res = NULL,   plot_type = c(\"bar\", \"dot\", \"lollipop\", \"network\", \"enrichmap\", \"wordcloud\",     \"comparison\"),   split_by = c(\"Database\", \"Groups\"),   color_by = \"Database\",   group_use = NULL,   id_use = NULL,   pvalueCutoff = NULL,   padjustCutoff = 0.05,   topTerm = ifelse(plot_type == \"enrichmap\", 100, 6),   compare_only_sig = FALSE,   topWord = 100,   word_type = c(\"term\", \"feature\"),   word_size = c(2, 8),   words_excluded = NULL,   network_layout = \"fr\",   network_labelsize = 5,   network_blendmode = \"blend\",   network_layoutadjust = TRUE,   network_adjscale = 60,   network_adjiter = 100,   enrichmap_layout = \"fr\",   enrichmap_cluster = \"fast_greedy\",   enrichmap_label = c(\"term\", \"feature\"),   enrichmap_labelsize = 5,   enrlichmap_nlabel = 4,   enrichmap_show_keyword = FALSE,   enrichmap_mark = c(\"ellipse\", \"hull\"),   enrichmap_expand = c(0.5, 0.5),   character_width = 50,   lineheight = 0.5,   palette = \"Spectral\",   palcolor = NULL,   aspect.ratio = 1,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnrichmentPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"EnrichmentPlot — EnrichmentPlot","text":"srt Seurat object containing results RunDEtest RunEnrichment. specified, enrichment results extracted Seurat object automatically. specified, res arguments must provided. db database use enrichment plot. Default \"GO_BP\". group_by character vector specifying grouping variable Seurat object. argument used srt specified. test.use character vector specifying test used differential expression analysis. argument used srt specified. res Enrichment results generated RunEnrichment function. provided, 'srt', 'test.use' 'group_by' ignored. plot_type type plot generate. Options : \"bar\", \"dot\", \"lollipop\", \"network\", \"enrichmap\", \"wordcloud\", \"comparison\". Default \"bar\". split_by splitting variable(s) plot. Can \"Database\", \"Groups\", . Default c(\"Database\", \"Groups\") plots. color_by variable used coloring. Default \"Database\". group_use group(s) used enrichment plot. Default NULL. id_use List IDs used display specific terms enrichment plot. Default value NULL. pvalueCutoff p-value cutoff. Default NULL. work padjustCutoff NULL. padjustCutoff p-adjusted cutoff. Default 0.05. topTerm number top terms display. Default 6, 100 'plot_type' \"enrichmap\". compare_only_sig Whether compare significant terms. Default FALSE. topWord number top words display wordcloud. Default 100. word_type type words display wordcloud. Options \"term\" \"feature\". Default \"term\". word_size size range words wordcloud. Default c(2, 8). words_excluded Words excluded wordcloud. default value NULL, means built-words (SCP::words_excluded) used. network_layout layout algorithm use network plot. Options \"fr\", \"kk\",\"random\", \"circle\", \"tree\", \"grid\", algorithm 'igraph' package. Default \"fr\". network_labelsize label size network plot. Default 5. network_blendmode blend mode network plot. Default \"blend\". network_layoutadjust Whether adjust layout network plot avoid overlapping words. Default TRUE. network_adjscale scale adjusting network plot layout. Default 60. network_adjiter number iterations adjusting network plot layout. Default 100. enrichmap_layout layout algorithm use enrichmap plot. Options \"fr\", \"kk\",\"random\", \"circle\", \"tree\", \"grid\", algorithm 'igraph' package. Default \"fr\". enrichmap_cluster clustering algorithm use enrichmap plot. Options \"walktrap\", \"fast_greedy\", algorithm 'igraph' package. Default \"fast_greedy\". enrichmap_label label type enrichmap plot. Options \"term\" \"feature\". Default \"term\". enrichmap_labelsize label size enrichmap plot. Default 5. enrlichmap_nlabel number labels display cluster enrichmap plot. Default 4. enrichmap_show_keyword Whether show keyword terms features enrichmap plot. Default FALSE. enrichmap_mark mark shape enrichmap plot. Options \"ellipse\" \"hull\". Default \"ellipse\". enrichmap_expand expansion factor enrichmap plot. Default c(0.5, 0.5). character_width maximum width character descriptions. Default 50. lineheight line height y-axis labels. Default 0.5. palette color palette use. Default \"Spectral\". palcolor Custom colors palette. Default NULL. aspect.ratio aspect ratio plot. Default 1. legend.position position legend. Default \"right\". legend.direction direction legend. Default \"vertical\". theme_use theme use plot. Default \"theme_scp\". theme_args arguments pass theme. Default empty list. combine Whether combine multiple plots single plot. Default TRUE. nrow number rows combined plot. Default NULL, calculated based number plots. ncol number columns combined plot. Default NULL, calculated based number plots. byrow Whether fill combined plot row. Default TRUE. seed random seed use. Default 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnrichmentPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"EnrichmentPlot — EnrichmentPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunEnrichment(srt = pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", species = \"Mus_musculus\") #> [2025-09-07 20:32:33.59505] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"bar\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"bar\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",   plot_type = \"bar\", character_width = 30,   theme_use = ggplot2::theme_classic, theme_args = list(base_size = 10) ) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Endocrine\", plot_type = \"bar\", character_width = 30,     theme_use = ggplot2::theme_classic, theme_args = list(base_size = 10)): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\", color_by = \"Groups\", ncol = 2) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     plot_type = \"bar\", color_by = \"Groups\", ncol = 2): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\",   split_by = \"Database\", color_by = \"Groups\", palette = \"Set1\",   id_use = list(     \"Ductal\" = c(\"GO:0002181\", \"GO:0045787\", \"GO:0006260\", \"GO:0050679\"),     \"Ngn3 low EP\" = c(\"GO:0050678\", \"GO:0051101\", \"GO:0072091\", \"GO:0006631\"),     \"Ngn3 high EP\" = c(\"GO:0035270\", \"GO:0030325\", \"GO:0008637\", \"GO:0030856\"),     \"Pre-endocrine\" = c(\"GO:0090276\", \"GO:0031018\", \"GO:0030073\", \"GO:1903532\"),     \"Endocrine\" = c(\"GO:0009914\", \"GO:0030073\", \"GO:0009743\", \"GO:0042593\")   ) ) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     plot_type = \"bar\", split_by = \"Database\", color_by = \"Groups\",     palette = \"Set1\", id_use = list(Ductal = c(\"GO:0002181\",         \"GO:0045787\", \"GO:0006260\", \"GO:0050679\"), `Ngn3 low EP` = c(\"GO:0050678\",         \"GO:0051101\", \"GO:0072091\", \"GO:0006631\"), `Ngn3 high EP` = c(\"GO:0035270\",         \"GO:0030325\", \"GO:0008637\", \"GO:0030856\"), `Pre-endocrine` = c(\"GO:0090276\",         \"GO:0031018\", \"GO:0030073\", \"GO:1903532\"), Endocrine = c(\"GO:0009914\",         \"GO:0030073\", \"GO:0009743\", \"GO:0042593\"))): No enrichment result found. You may perform RunEnrichment first.  EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     topTerm = 3, plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\", compare_only_sig = TRUE) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     topTerm = 3, plot_type = \"comparison\", compare_only_sig = TRUE): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first.  EnrichmentPlot(pancreas_sub,   db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",   split_by = \"Groups\" ) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",     split_by = \"Groups\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",   split_by = \"Database\", color_by = \"Groups\", ) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",     split_by = \"Database\", color_by = \"Groups\", ): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",   split_by = c(\"Database\", \"Groups\") ) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",     split_by = c(\"Database\", \"Groups\")): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",   split_by = c(\"Groups\", \"Database\") ) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     group_use = c(\"Ductal\", \"Endocrine\"), plot_type = \"bar\",     split_by = c(\"Groups\", \"Database\")): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\", plot_type = \"bar\",   split_by = \"Database\", color_by = \"Groups\", palette = \"Set1\" ) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"GO_BP\", \"GO_CC\"), group_by = \"CellType\",     plot_type = \"bar\", split_by = \"Database\", color_by = \"Groups\",     palette = \"Set1\"): No enrichment result found. You may perform RunEnrichment first.  EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"dot\", palette = \"GdRd\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"dot\", palette = \"GdRd\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"lollipop\", palette = \"GdRd\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"lollipop\", palette = \"GdRd\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"wordcloud\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"wordcloud\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"wordcloud\", word_type = \"feature\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"wordcloud\", word_type = \"feature\"): No enrichment result found. You may perform RunEnrichment first.  EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"network\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"network\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"network\", id_use = c(\"GO:0050678\", \"GO:0035270\", \"GO:0090276\", \"GO:0030073\")) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"network\", id_use = c(\"GO:0050678\",         \"GO:0035270\", \"GO:0090276\", \"GO:0030073\")): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"network\", network_layoutadjust = FALSE) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"network\", network_layoutadjust = FALSE): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"network\",   topTerm = 4, network_blendmode = \"average\",   theme_use = \"theme_blank\", theme_args = list(add_coord = FALSE) ) %>% panel_fix(height = 5) #> Error in panel_fix(., height = 5): unused argument (height = 5)  EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"enrichmap\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"enrichmap\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"enrichmap\", enrichmap_expand = c(2, 1)) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"enrichmap\", enrichmap_expand = c(2,         1)): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"enrichmap\",   enrichmap_show_keyword = TRUE, character_width = 10 ) #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     group_use = \"Ductal\", plot_type = \"enrichmap\", enrichmap_show_keyword = TRUE,     character_width = 10): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", plot_type = \"enrichmap\",   topTerm = 200, enrichmap_mark = \"hull\", enrichmap_label = \"feature\", enrlichmap_nlabel = 3, character_width = 10,   theme_use = \"theme_blank\", theme_args = list(add_coord = FALSE) ) %>% panel_fix(height = 4) #> Error in panel_fix(., height = 4): unused argument (height = 4)  pancreas_sub <- RunEnrichment(srt = pancreas_sub, db = c(\"MP\", \"DO\"), group_by = \"CellType\", convert_species = TRUE, species = \"Mus_musculus\") #> [2025-09-07 20:32:33.607522] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, db = c(\"MP\", \"DO\"), group_by = \"CellType\",     convert_species = TRUE, species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = c(\"MP\", \"DO\"), group_by = \"CellType\", group_use = \"Endocrine\", ncol = 1) #> Error in EnrichmentPlot(pancreas_sub, db = c(\"MP\", \"DO\"), group_by = \"CellType\",     group_use = \"Endocrine\", ncol = 1): No enrichment result found. You may perform RunEnrichment first."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnsureSeurat5.html","id":null,"dir":"Reference","previous_headings":"","what":"Ensure Seurat object is V5-compatible — EnsureSeurat5","title":"Ensure Seurat object is V5-compatible — EnsureSeurat5","text":"function checks Seurat object V5-compatible converts needed. requires Seurat V5 installed. object already V5, returned unchanged.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnsureSeurat5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ensure Seurat object is V5-compatible — EnsureSeurat5","text":"","code":"EnsureSeurat5(srt, verbose = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnsureSeurat5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ensure Seurat object is V5-compatible — EnsureSeurat5","text":"srt Seurat object verbose Whether show verbose output","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/EnsureSeurat5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ensure Seurat object is V5-compatible — EnsureSeurat5","text":"Seurat V5 object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureCorPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Features correlation plot This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object. — FeatureCorPlot","title":"Features correlation plot This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object. — FeatureCorPlot","text":"Features correlation plot function creates correlation plot visualize pairwise correlations selected features Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureCorPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Features correlation plot This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object. — FeatureCorPlot","text":"","code":"FeatureCorPlot(   srt,   features,   group.by = NULL,   split.by = NULL,   cells = NULL,   slot = \"data\",   assay = NULL,   cor_method = \"pearson\",   adjust = 1,   margin = 1,   reverse = FALSE,   add_equation = FALSE,   add_r2 = TRUE,   add_pvalue = TRUE,   add_smooth = TRUE,   palette = \"Paired\",   palcolor = NULL,   cor_palette = \"RdBu\",   cor_palcolor = NULL,   cor_range = c(-1, 1),   pt.size = NULL,   pt.alpha = 1,   cells.highlight = NULL,   cols.highlight = \"black\",   sizes.highlight = 1,   alpha.highlight = 1,   stroke.highlight = 0.5,   calculate_coexp = FALSE,   raster = NULL,   raster.dpi = c(512, 512),   aspect.ratio = 1,   title = NULL,   subtitle = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureCorPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Features correlation plot This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object. — FeatureCorPlot","text":"srt Seurat object. features character vector specifying features compare. present assay data metadata Seurat object. group.character string specifying column metadata group cells . split.character string specifying column metadata split plot . cells character vector specifying cells include plot. NULL (default), cells included. slot character string specifying slot Seurat object use. Defaults \"data\". assay character string specifying assay use. Defaults default assay Seurat object. cor_method character string specifying correlation method use. Can \"pearson\" (default) \"spearman\". adjust numeric value specifying adjustment factor width violin plots. Defaults 1. margin numeric value specifying margin size plot. Defaults 1. reverse logical value indicating whether reverse order features plot. Defaults FALSE. add_equation logical value indicating whether add equation linear regression line scatter plot. Defaults FALSE. add_r2 logical value indicating whether add R-squared value linear regression line scatter plot. Defaults TRUE. add_pvalue logical value indicating whether add p-value linear regression line scatter plot. Defaults TRUE. add_smooth logical value indicating whether add smoothed line scatter plot. Defaults TRUE. palette character string specifying name color palette use groups. Defaults \"Paired\". palcolor character string specifying color groups. Defaults NULL. cor_palette character string specifying name color palette use correlation. Defaults \"RuBu\". cor_palcolor character string specifying color correlation. Defaults \"RuBu\". cor_range two-length numeric vector specifying range correlation. pt.size numeric value specifying size points scatter plots. NULL (default), size automatically determined based number cells. pt.alpha numeric value 0 1 specifying transparency points scatter plots. Defaults 1. cells.highlight logical value character vector specifying cells highlight scatter plots. TRUE, cells highlighted. Defaults NULL. cols.highlight character string specifying color highlighted cells. Defaults \"black\". sizes.highlight numeric value specifying size highlighted cells scatter plots. Defaults 1. alpha.highlight numeric value 0 1 specifying transparency highlighted cells scatter plots. Defaults 1. stroke.highlight numeric value specifying stroke size highlighted cells scatter plots. Defaults 0.5. calculate_coexp logical value indicating whether calculate co-expression selected features. Defaults FALSE. raster logical value indicating whether use raster graphics scatter plots. Defaults NULL. raster.dpi numeric vector specifying dpi (dots per inch) resolution raster graphics scatter plots. Defaults c(512, 512). aspect.ratio numeric value specifying aspect ratio scatter plots. Defaults 1. title character string specifying title correlation plot. Defaults NULL. subtitle character string specifying subtitle correlation plot. Defaults NULL. legend.position character string specifying position legend. Can \"right\" (default), \"left\", \"top\", \"bottom\". legend.direction character string specifying direction legend. Can \"vertical\" (default) \"horizontal\". theme_use character string specifying name theme use plot. Defaults \"theme_scp\". theme_args list arguments pass theme function. Defaults empty list. combine logical value indicating whether combine plots single plot. Defaults TRUE. nrow numeric value specifying number rows combined plot. NULL (default), number rows automatically determined. ncol numeric value specifying number columns combined plot. NULL (default), number columns automatically determined. byrow logical value indicating whether fill combined plot byrow (top bottom, left right). Defaults TRUE. force logical value indicating whether force creation plot, even contains 50 subplots. Defaults FALSE. seed numeric value specifying random seed reproducibility. Defaults 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureCorPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Features correlation plot This function creates a correlation plot to visualize the pairwise correlations between selected features in a Seurat object. — FeatureCorPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- Seurat::NormalizeData(pancreas_sub) #> Warning: The `slot` argument of `SetAssayData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the Seurat package. #>   Please report the issue at <https://github.com/satijalab/seurat/issues>. FeatureCorPlot(pancreas_sub, features = c(\"Neurog3\", \"Hes6\", \"Fev\", \"Neurod1\", \"Rbp4\", \"Pyy\"), group.by = \"SubCellType\")  FeatureCorPlot(pancreas_sub,   features = c(\"nFeature_RNA\", \"nCount_RNA\", \"nFeature_spliced\", \"nCount_spliced\", \"nFeature_unspliced\", \"nCount_unspliced\"),   group.by = \"SubCellType\", cor_palette = \"Greys\", cor_range = c(0, 1) ) #> Warning: essentially perfect fit: summary may be unreliable #> Warning: essentially perfect fit: summary may be unreliable #> Warning: essentially perfect fit: summary may be unreliable #> Warning: essentially perfect fit: summary may be unreliable  FeatureCorPlot(pancreas_sub,   features = c(\"nFeature_RNA\", \"nCount_RNA\"),   group.by = \"SubCellType\", add_equation = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Visualize feature values on a 2-dimensional reduction plot — FeatureDimPlot","title":"Visualize feature values on a 2-dimensional reduction plot — FeatureDimPlot","text":"Plotting cell points reduced 2D plane coloring according values features.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Visualize feature values on a 2-dimensional reduction plot — FeatureDimPlot","text":"","code":"FeatureDimPlot(   srt,   features,   reduction = NULL,   dims = c(1, 2),   split.by = NULL,   cells = NULL,   slot = \"data\",   assay = NULL,   show_stat = ifelse(identical(theme_use, \"theme_blank\"), FALSE, TRUE),   palette = ifelse(isTRUE(compare_features), \"Set1\", \"Spectral\"),   palcolor = NULL,   pt.size = NULL,   pt.alpha = 1,   bg_cutoff = 0,   bg_color = \"grey80\",   keep_scale = \"feature\",   lower_quantile = 0,   upper_quantile = 0.99,   lower_cutoff = NULL,   upper_cutoff = NULL,   add_density = FALSE,   density_color = \"grey80\",   density_filled = FALSE,   density_filled_palette = \"Greys\",   density_filled_palcolor = NULL,   cells.highlight = NULL,   cols.highlight = \"black\",   sizes.highlight = 1,   alpha.highlight = 1,   stroke.highlight = 0.5,   calculate_coexp = FALSE,   compare_features = FALSE,   color_blend_mode = c(\"blend\", \"average\", \"screen\", \"multiply\"),   label = FALSE,   label.size = 4,   label.fg = \"white\",   label.bg = \"black\",   label.bg.r = 0.1,   label_insitu = FALSE,   label_repel = FALSE,   label_repulsion = 20,   label_point_size = 1,   label_point_color = \"black\",   label_segment_color = \"black\",   lineages = NULL,   lineages_trim = c(0.01, 0.99),   lineages_span = 0.75,   lineages_palette = \"Dark2\",   lineages_palcolor = NULL,   lineages_arrow = arrow(length = unit(0.1, \"inches\")),   lineages_linewidth = 1,   lineages_line_bg = \"white\",   lineages_line_bg_stroke = 0.5,   lineages_whiskers = FALSE,   lineages_whiskers_linewidth = 0.5,   lineages_whiskers_alpha = 0.5,   graph = NULL,   edge_size = c(0.05, 0.5),   edge_alpha = 0.1,   edge_color = \"grey40\",   hex = FALSE,   hex.linewidth = 0.5,   hex.color = \"grey90\",   hex.bins = 50,   hex.binwidth = NULL,   raster = NULL,   raster.dpi = c(512, 512),   aspect.ratio = 1,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Visualize feature values on a 2-dimensional reduction plot — FeatureDimPlot","text":"srt Seurat object. features character vector named list features plot. Features can gene names Assay names numeric columns meta.data. reduction dimensionality reduction use. specified, use reduction returned DefaultReduction. dims Dimensions plot, must two-length numeric vector specifying x- y-dimensions. split.Name column meta.data split plot . cells Subset cells plot. slot slot pull expression data ? Default data. assay assay pull expression data . NULL, use assay returned DefaultAssay. show_stat Whether show statistical information plot. palette Name color palette name collected SCP. palcolor Custom colors used create color palette. pt.size Point size plotting. pt.alpha Point transparency. bg_cutoff Background cutoff. Points feature values lower cutoff considered background colored bg_color. bg_color Color value background points. keep_scale handle color scale across multiple plots. Options : NULL (scaling): individual plot scaled maximum expression value feature condition provided 'split.'. aware setting NULL result color scales comparable plots. \"feature\" (default; row/feature scaling): plots individual feature scaled maximum expression feature across conditions provided 'split.'. \"\" (universal scaling): plots features conditions scaled maximum expression value feature highest overall expression. lower_quantile, upper_quantile, lower_cutoff, upper_cutoff Vector minimum maximum cutoff values quantile values feature. add_density Whether add density layer plot. density_color Color density contours lines. density_filled Whether add filled contour bands instead contour lines. density_filled_palette Color palette used fill contour bands. density_filled_palcolor Custom colors used fill contour bands. cells.highlight vector cell names highlight. cols.highlight Color used highlight cells. sizes.highlight Size highlighted cells. alpha.highlight Transparency highlighted cell points. stroke.highlight Border width highlighted cell points. calculate_coexp Whether calculate co-expression value (geometric mean) features. compare_features Whether show values multiple features single plot. color_blend_mode Blend mode use compare_features = TRUE label Whether feature name labeled center location cells wieh high expression. label.size Size labels. label.fg Foreground color label. label.bg Background color label. label.bg.r Background ratio label. label_insitu Whether labels feature names instead numbers. Valid compare_features = TRUE. label_repel Logical value indicating whether label repel away center location. label_repulsion Force repulsion overlapping text labels. Defaults 20. label_point_size Size center points. label_point_color Color center points label_segment_color Color line segment labels. lineages Lineages/pseudotime add plot. specified, curves fitted using loess method. lineages_trim Trim leading trailing data lineages. lineages_span parameter α controls degree smoothing loess method. lineages_palette Color palette used lineages. lineages_palcolor Custom colors used lineages. lineages_arrow Set arrows lineages. See arrow. lineages_linewidth Width fitted curve lines lineages. lineages_line_bg Background color curve lines lineages. lineages_line_bg_stroke Border width curve lines background. lineages_whiskers Whether add whiskers lineages. lineages_whiskers_linewidth Width whiskers lineages. lineages_whiskers_alpha Transparency whiskers lineages. graph Specify graph name add edges cell neighbors plot. edge_size Size edges. edge_alpha Transparency edges. edge_color Color edges. hex Whether chane plot type point hexagonal bin. hex.linewidth Border width hexagonal bins. hex.color Border color hexagonal bins. hex.bins Number hexagonal bins. hex.binwidth Hexagonal bin width. raster Convert points raster format, default NULL automatically rasterizes plotting 100,000 cells raster.dpi Pixel resolution rasterized plots, passed geom_scattermore(). Default c(512, 512). aspect.ratio Aspect ratio panel. title text title. subtitle text subtitle plot displayed title. xlab x-axis label. ylab y-axis label. legend.position position legends (\"none\", \"left\", \"right\", \"bottom\", \"top\"). legend.direction Layout items legends (\"horizontal\" \"vertical\") theme_use Theme used. Can character string theme function. example, \"theme_blank\" ggplot2::theme_classic. theme_args arguments passed theme_use. combine Combine plots single patchwork object. FALSE, return list ggplot objects. nrow Number rows combined plot. ncol Number columns combined plot. byrow Logical value indicating plots arrange row (default) column. force Whether force drawing regardless number features greater 100. seed Random seed set reproducibility","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Visualize feature values on a 2-dimensional reduction plot — FeatureDimPlot","text":"","code":"data(\"pancreas_sub\") FeatureDimPlot(pancreas_sub, features = \"G2M_score\", reduction = \"UMAP\") #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, features = \"G2M_score\", reduction = \"UMAP\", bg_cutoff = -Inf) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, features = \"G2M_score\", reduction = \"UMAP\", theme_use = \"theme_blank\") #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, features = \"G2M_score\", reduction = \"UMAP\", theme_use = ggplot2::theme_classic, theme_args = list(base_size = 16)) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, features = \"G2M_score\", reduction = \"UMAP\") %>% panel_fix(height = 2, raster = TRUE, dpi = 30) #> Error in panel_fix(., height = 2, raster = TRUE, dpi = 30): unused arguments (height = 2, raster = TRUE, dpi = 30)  pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:32:53.363781] Start Standard_SCP #> [2025-09-07 20:32:53.363934] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector FeatureDimPlot(pancreas_sub, features = c(\"StandardPC_1\", \"StandardPC_2\"), reduction = \"UMAP\", bg_cutoff = -Inf) #> Warning: StandardPC_1,StandardPC_2 are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, features = c(\"StandardPC_1\", \"StandardPC_2\"),     reduction = \"UMAP\", bg_cutoff = -Inf): There are no valid features present.  # Label and highlight cell points FeatureDimPlot(pancreas_sub,   features = \"Rbp4\", reduction = \"UMAP\", label = TRUE,   cells.highlight = colnames(pancreas_sub)[pancreas_sub$SubCellType == \"Delta\"] ) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub,   features = \"Rbp4\", split.by = \"Phase\", reduction = \"UMAP\",   cells.highlight = TRUE, theme_use = \"theme_blank\" ) #> Error in rescale(colors_value): could not find function \"rescale\"  # Add a density layer FeatureDimPlot(pancreas_sub, features = \"Rbp4\", reduction = \"UMAP\", label = TRUE, add_density = TRUE) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, features = \"Rbp4\", reduction = \"UMAP\", label = TRUE, add_density = TRUE, density_filled = TRUE) #> Error in rescale(colors_value): could not find function \"rescale\"  # Chane the plot type from point to the hexagonal bin FeatureDimPlot(pancreas_sub, features = \"Rbp4\", reduction = \"UMAP\", hex = TRUE) #> Error in check_R(\"hexbin\"): could not find function \"check_R\" FeatureDimPlot(pancreas_sub, features = \"Rbp4\", reduction = \"UMAP\", hex = TRUE, hex.bins = 20) #> Error in check_R(\"hexbin\"): could not find function \"check_R\"  # Show lineages on the plot based on the pseudotime pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\", lineages = \"Lineage3\") #> Error in FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\",     lineages = \"Lineage3\"): Lineage3 is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\", lineages = \"Lineage3\", lineages_whiskers = TRUE) #> Error in FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\",     lineages = \"Lineage3\", lineages_whiskers = TRUE): Lineage3 is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\", lineages = \"Lineage3\", lineages_span = 0.1) #> Error in FeatureDimPlot(pancreas_sub, features = \"Lineage3\", reduction = \"UMAP\",     lineages = \"Lineage3\", lineages_span = 0.1): Lineage3 is not in the meta.data of srt object.  # Input a named feature list markers <- list(   \"Ductal\" = c(\"Sox9\", \"Anxa2\", \"Bicc1\"),   \"EPs\" = c(\"Neurog3\", \"Hes6\"),   \"Pre-endocrine\" = c(\"Fev\", \"Neurod1\"),   \"Endocrine\" = c(\"Rbp4\", \"Pyy\"),   \"Beta\" = \"Ins1\", \"Alpha\" = \"Gcg\", \"Delta\" = \"Sst\", \"Epsilon\" = \"Ghrl\" ) FeatureDimPlot(pancreas_sub,   features = markers, reduction = \"UMAP\",   theme_use = \"theme_blank\",   theme_args = list(plot.subtitle = ggplot2::element_text(size = 10), strip.text = ggplot2::element_text(size = 8)) ) #> Error in rescale(colors_value): could not find function \"rescale\"  # Plot multiple features with different scales endocrine_markers <- c(\"Beta\" = \"Ins1\", \"Alpha\" = \"Gcg\", \"Delta\" = \"Sst\", \"Epsilon\" = \"Ghrl\") FeatureDimPlot(pancreas_sub, endocrine_markers, reduction = \"UMAP\") #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, endocrine_markers, reduction = \"UMAP\", lower_quantile = 0, upper_quantile = 0.8) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, endocrine_markers, reduction = \"UMAP\", lower_cutoff = 1, upper_cutoff = 4) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, endocrine_markers, reduction = \"UMAP\", bg_cutoff = 2, lower_cutoff = 2, upper_cutoff = 4) #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, endocrine_markers, reduction = \"UMAP\", keep_scale = \"all\") #> Error in rescale(colors_value): could not find function \"rescale\" FeatureDimPlot(pancreas_sub, c(\"Delta\" = \"Sst\", \"Epsilon\" = \"Ghrl\"), split.by = \"Phase\", reduction = \"UMAP\", keep_scale = \"feature\") #> Error in rescale(colors_value): could not find function \"rescale\"  # Plot multiple features on one picture FeatureDimPlot(pancreas_sub,   features = endocrine_markers, pt.size = 1,   compare_features = TRUE, color_blend_mode = \"blend\",   label = TRUE, label_insitu = TRUE ) #> Error in rescale(value_list[[i]]): could not find function \"rescale\" FeatureDimPlot(pancreas_sub,   features = c(\"S_score\", \"G2M_score\"), pt.size = 1, palcolor = c(\"red\", \"green\"),   compare_features = TRUE, color_blend_mode = \"blend\", title = \"blend\",   label = TRUE, label_insitu = TRUE ) #> Error in rescale(value_list[[i]]): could not find function \"rescale\" FeatureDimPlot(pancreas_sub,   features = c(\"S_score\", \"G2M_score\"), pt.size = 1, palcolor = c(\"red\", \"green\"),   compare_features = TRUE, color_blend_mode = \"average\", title = \"average\",   label = TRUE, label_insitu = TRUE ) #> Error in rescale(value_list[[i]]): could not find function \"rescale\" FeatureDimPlot(pancreas_sub,   features = c(\"S_score\", \"G2M_score\"), pt.size = 1, palcolor = c(\"red\", \"green\"),   compare_features = TRUE, color_blend_mode = \"screen\", title = \"screen\",   label = TRUE, label_insitu = TRUE ) #> Error in rescale(value_list[[i]]): could not find function \"rescale\" FeatureDimPlot(pancreas_sub,   features = c(\"S_score\", \"G2M_score\"), pt.size = 1, palcolor = c(\"red\", \"green\"),   compare_features = TRUE, color_blend_mode = \"multiply\", title = \"multiply\",   label = TRUE, label_insitu = TRUE ) #> Error in rescale(value_list[[i]]): could not find function \"rescale\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot3D.html","id":null,"dir":"Reference","previous_headings":"","what":"3D-Dimensional reduction plot for gene expression visualization. — FeatureDimPlot3D","title":"3D-Dimensional reduction plot for gene expression visualization. — FeatureDimPlot3D","text":"Plotting cell points reduced 3D space coloring according gene expression cells.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot3D.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"3D-Dimensional reduction plot for gene expression visualization. — FeatureDimPlot3D","text":"","code":"FeatureDimPlot3D(   srt,   features,   reduction = NULL,   dims = c(1, 2, 3),   axis_labs = NULL,   split.by = NULL,   slot = \"data\",   assay = NULL,   calculate_coexp = FALSE,   pt.size = 1.5,   cells.highlight = NULL,   cols.highlight = \"black\",   shape.highlight = \"circle-open\",   sizes.highlight = 2,   width = NULL,   height = NULL,   save = NULL,   force = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot3D.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"3D-Dimensional reduction plot for gene expression visualization. — FeatureDimPlot3D","text":"srt Seurat object. features character vector named list features plot. Features can gene names Assay names numeric columns meta.data. reduction dimensionality reduction use. specified, use reduction returned DefaultReduction. dims Dimensions plot, must two-length numeric vector specifying x- y-dimensions. axis_labs character vector length 3 indicating labels axes. split.Name column meta.data split plot . slot slot pull expression data ? Default data. assay assay pull expression data . NULL, use assay returned DefaultAssay. calculate_coexp Whether calculate co-expression value (geometric mean) features. pt.size Point size plotting. cells.highlight vector cell names highlight. cols.highlight Color used highlight cells. shape.highlight Shape cell highlight. See scattergl-marker-symbol sizes.highlight Size highlighted cells. width Width pixels, defaults automatic sizing. height Height pixels, defaults automatic sizing. save name file save plot . Must end \".html\". force Whether force drawing regardless number features greater 100.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureDimPlot3D.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"3D-Dimensional reduction plot for gene expression visualization. — FeatureDimPlot3D","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:32:58.198609] Start Standard_SCP #> [2025-09-07 20:32:58.19881] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector FeatureDimPlot3D(pancreas_sub, features = c(\"Ghrl\", \"Ins1\", \"Gcg\", \"Ins2\"), reduction = \"StandardpcaUMAP3D\") #> Error in col2hex(cols.highlight): could not find function \"col2hex\" FeatureDimPlot3D(pancreas_sub, features = c(\"StandardPC_1\", \"StandardPC_2\"), reduction = \"StandardpcaUMAP3D\") #> Error in col2hex(cols.highlight): could not find function \"col2hex\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"FeatureHeatmap — FeatureHeatmap","title":"FeatureHeatmap — FeatureHeatmap","text":"FeatureHeatmap","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FeatureHeatmap — FeatureHeatmap","text":"","code":"FeatureHeatmap(   srt,   features = NULL,   cells = NULL,   group.by = NULL,   split.by = NULL,   within_groups = FALSE,   max_cells = 100,   cell_order = NULL,   border = TRUE,   flip = FALSE,   slot = \"counts\",   assay = NULL,   exp_method = c(\"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\"),   exp_legend_title = NULL,   limits = NULL,   lib_normalize = identical(slot, \"counts\"),   libsize = NULL,   feature_split = NULL,   feature_split_by = NULL,   n_split = NULL,   split_order = NULL,   split_method = c(\"kmeans\", \"hclust\", \"mfuzz\"),   decreasing = FALSE,   fuzzification = NULL,   cluster_features_by = NULL,   cluster_rows = FALSE,   cluster_columns = FALSE,   cluster_row_slices = FALSE,   cluster_column_slices = FALSE,   show_row_names = FALSE,   show_column_names = FALSE,   row_names_side = ifelse(flip, \"left\", \"right\"),   column_names_side = ifelse(flip, \"bottom\", \"top\"),   row_names_rot = 0,   column_names_rot = 90,   row_title = NULL,   column_title = NULL,   row_title_side = \"left\",   column_title_side = \"top\",   row_title_rot = 0,   column_title_rot = ifelse(flip, 90, 0),   anno_terms = FALSE,   anno_keys = FALSE,   anno_features = FALSE,   terms_width = unit(4, \"in\"),   terms_fontsize = 8,   keys_width = unit(2, \"in\"),   keys_fontsize = c(6, 10),   features_width = unit(2, \"in\"),   features_fontsize = c(6, 10),   IDtype = \"symbol\",   species = \"Homo_sapiens\",   db_update = FALSE,   db_version = \"latest\",   db_combine = FALSE,   convert_species = FALSE,   Ensembl_version = 103,   mirror = NULL,   db = \"GO_BP\",   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   GO_simplify = FALSE,   GO_simplify_cutoff = \"p.adjust < 0.05\",   simplify_method = \"Wang\",   simplify_similarityCutoff = 0.7,   pvalueCutoff = NULL,   padjustCutoff = 0.05,   topTerm = 5,   show_termid = FALSE,   topWord = 20,   words_excluded = NULL,   nlabel = 20,   features_label = NULL,   label_size = 10,   label_color = \"black\",   heatmap_palette = \"RdBu\",   heatmap_palcolor = NULL,   group_palette = \"Paired\",   group_palcolor = NULL,   cell_split_palette = \"simspec\",   cell_split_palcolor = NULL,   feature_split_palette = \"simspec\",   feature_split_palcolor = NULL,   cell_annotation = NULL,   cell_annotation_palette = \"Paired\",   cell_annotation_palcolor = NULL,   cell_annotation_params = if (flip) list(width = unit(5, \"mm\")) else list(height =     unit(5, \"mm\")),   feature_annotation = NULL,   feature_annotation_palette = \"Dark2\",   feature_annotation_palcolor = NULL,   feature_annotation_params = if (flip) list(height = unit(5, \"mm\")) else list(width =     unit(5, \"mm\")),   use_raster = NULL,   raster_device = \"png\",   raster_by_magick = FALSE,   height = NULL,   width = NULL,   units = \"inch\",   seed = 11,   ht_params = list() )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FeatureHeatmap — FeatureHeatmap","text":"srt Seurat object. features features include heatmap. cells character vector specifying cells include heatmap. Default NULL. group.character vector specifying groups group . Default NULL. split.character vector specifying variable split heatmap . Default NULL. within_groups logical value indicating whether create separate heatmap scales group within group. Default FALSE. max_cells integer, maximum number cells sample per group, default 100. cell_order vector cell names defining order cells, default NULL. border logical value indicating whether add border heatmap. Default TRUE. flip logical value indicating whether flip heatmap. Default FALSE. slot character vector specifying slot Seurat object use. Default \"counts\". assay character vector specifying assay Seurat object use. Default NULL. exp_method character vector specifying method calculating expression values. Default \"zscore\" options \"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\". exp_legend_title character vector specifying title legend expression value. Default NULL. limits two-length numeric vector specifying limits color scale. Default NULL. lib_normalize logical value indicating whether normalize data library size. libsize numeric vector specifying library size cell. Default NULL. feature_split factor specifying split features. Default NULL. feature_split_by character vector specifying group.use splitting features (n_split feature clusters). Default NULL. n_split integer specifying number feature splits (feature clusters) create. Default NULL. split_order numeric vector specifying order splits. Default NULL. split_method character vector specifying method splitting features. Default \"kmeans\" options \"kmeans\", \"hclust\", \"mfuzz\"). decreasing logical value indicating whether sort feature splits decreasing order. Default FALSE. fuzzification numeric value specifying fuzzification coefficient. Default NULL. cluster_features_by character vector specifying group.use clustering features. Default NULL. default, parameter set NULL, means groups used. cluster_rows logical value indicating whether cluster rows heatmap. Default FALSE. cluster_columns logical value indicating whether cluster columns heatmap. Default FALSE. cluster_row_slices logical value indicating whether cluster row slices heatmap. Default FALSE. cluster_column_slices logical value indicating whether cluster column slices heatmap. Default FALSE. show_row_names logical value indicating whether show row names heatmap. Default FALSE. show_column_names logical value indicating whether show column names heatmap. Default FALSE. row_names_side character vector specifying side place row names. column_names_side character vector specifying side place column names. row_names_rot numeric value specifying rotation angle row names. Default 0. column_names_rot numeric value specifying rotation angle column names. Default 90. row_title character vector specifying title rows. Default NULL. column_title character vector specifying title columns. Default NULL. row_title_side character vector specifying side place row title. Default \"left\". column_title_side character vector specifying side place column title. Default \"top\". row_title_rot numeric value specifying rotation angle row title. Default 0. column_title_rot numeric value specifying rotation angle column title. anno_terms logical value indicating whether include term annotations. Default FALSE. anno_keys logical value indicating whether include key annotations. Default FALSE. anno_features logical value indicating whether include feature annotations. Default FALSE. terms_width unit specifying width term annotations. Default unit(4, \"\"). terms_fontsize numeric vector specifying font size(s) term annotations. Default 8. keys_width unit specifying width key annotations. Default unit(2, \"\"). keys_fontsize two-length numeric vector specifying minimum maximum font size(s) key annotations. Default c(6, 10). features_width unit specifying width feature annotations. Default unit(2, \"\"). features_fontsize two-length numeric vector specifying minimum maximum font size(s) feature annotations. Default c(6, 10). IDtype character vector specifying type IDs features. Default \"symbol\". species character vector specifying species features. Default \"Homo_sapiens\". db_update logical value indicating whether update database. Default FALSE. db_version character vector specifying version database. Default \"latest\". db_combine logical value indicating whether use combined database. Default FALSE. convert_species logical value indicating whether use species-converted database annotation missing species. Default FALSE. Ensembl_version integer specifying Ensembl version. Default 103. mirror character vector specifying mirror Ensembl database. Default NULL. db character vector specifying database use. Default \"GO_BP\". TERM2GENE data.frame specifying TERM2GENE mapping database. Default NULL. TERM2NAME data.frame specifying TERM2NAME mapping database. Default NULL. minGSSize integer specifying minimum gene set size database. Default 10. maxGSSize integer specifying maximum gene set size database. Default 500. GO_simplify logical value indicating whether simplify gene ontology terms. Default FALSE. GO_simplify_cutoff character vector specifying cutoff GO simplification. Default \"p.adjust < 0.05\". simplify_method character vector specifying method GO simplification. Default \"Wang\". simplify_similarityCutoff numeric value specifying similarity cutoff GO simplification. Default 0.7. pvalueCutoff numeric vector specifying p-value cutoff(s) significance. Default NULL. padjustCutoff numeric value specifying adjusted p-value cutoff significance. Default 0.05. topTerm integer specifying number top terms include. Default 5. show_termid logical value indicating whether show term IDs. Default FALSE. topWord integer specifying number top words include. Default 20. words_excluded character vector specifying words exclude. Default NULL. nlabel integer specifying number labels include. Default 0. features_label character vector specifying features label. Default NULL. label_size numeric value specifying size labels. Default 10. label_color character vector specifying color labels. Default \"black\". heatmap_palette character vector specifying palette use heatmap. Default \"RdBu\". heatmap_palcolor character vector specifying heatmap color use. Default NULL. group_palette character vector specifying palette use groups. Default \"Paired\". group_palcolor character vector specifying group color use. Default NULL. cell_split_palette character vector specifying palette use cell splits. Default \"simspec\". cell_split_palcolor character vector specifying cell split color use. Default NULL. feature_split_palette character vector specifying palette use feature splits. Default \"simspec\". feature_split_palcolor character vector specifying feature split color use. Default NULL. cell_annotation character vector specifying cell annotation(s) include. Default NULL. cell_annotation_palette character vector specifying palette use cell annotations. length vector match number cell_annotation. Default \"Paired\". cell_annotation_palcolor list character vector specifying cell annotation color(s) use. length list match number cell_annotation. Default NULL. cell_annotation_params list specifying additional parameters cell annotations. Default list width = unit(1, \"cm\") flip TRUE, else list height = unit(1, \"cm\"). feature_annotation character vector specifying feature annotation(s) include. Default NULL. feature_annotation_palette character vector specifying palette use feature annotations. length vector match number feature_annotation. Default \"Dark2\". feature_annotation_palcolor list character vector specifying feature annotation color use. length list match number feature_annotation. Default NULL. feature_annotation_params list specifying additional parameters feature annotations. Default empty list. use_raster logical value indicating whether use raster device plotting. Default NULL. raster_device character vector specifying raster device use. Default \"png\". raster_by_magick logical value indicating whether use 'magick' package raster. Default FALSE. height numeric vector specifying height(s) heatmap body. Default NULL. width numeric vector specifying width(s) heatmap body. Default NULL. units character vector specifying units height width. Default \"inch\". seed integer specifying random seed. Default 11. ht_params list specifying additional parameters passed ComplexHeatmap::Heatmap function. Default empty list.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"FeatureHeatmap — FeatureHeatmap","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following object is masked from ‘package:AnnotationDbi’: #>  #>     select #> The following objects are masked from ‘package:IRanges’: #>  #>     collapse, desc, intersect, setdiff, slice, union #> The following objects are masked from ‘package:S4Vectors’: #>  #>     first, intersect, rename, setdiff, setequal, union #> The following object is masked from ‘package:Biobase’: #>  #>     combine #> The following objects are masked from ‘package:BiocGenerics’: #>  #>     combine, intersect, setdiff, setequal, union #> The following object is masked from ‘package:generics’: #>  #>     explain #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector de_filter <- filter(pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" ht1 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, group.by = \"CellType\",   split.by = \"Phase\", cell_split_palette = \"Dark2\", ) #> Error: object 'de_filter' not found ht1$plot #> Error: object 'ht1' not found panel_fix(ht1$plot, height = 4, width = 6, raster = TRUE, dpi = 50) #> Error in panel_fix(ht1$plot, height = 4, width = 6, raster = TRUE, dpi = 50): unused arguments (height = 4, width = 6, raster = TRUE, dpi = 50)  ht2 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, group.by = c(\"CellType\", \"SubCellType\"), n_split = 4,   cluster_rows = TRUE, cluster_row_slices = TRUE, cluster_columns = TRUE, cluster_column_slices = TRUE,   ht_params = list(row_gap = unit(0, \"mm\")) ) #> Error: object 'de_filter' not found ht2$plot #> Error: object 'ht2' not found  ht3 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, feature_split = de_filter$group1, group.by = \"CellType\",   species = \"Mus_musculus\", db = \"GO_BP\", anno_terms = TRUE, anno_keys = TRUE, anno_features = TRUE ) #> Error: object 'de_filter' not found ht3$plot #> Error: object 'ht3' not found  pancreas_sub <- AnnotateFeatures(pancreas_sub, species = \"Mus_musculus\", db = c(\"TF\", \"CSPA\")) #> Species: Mus_musculus #> Preparing database: TF #> Error in download(url = url, destfile = temp): could not find function \"download\" ht4 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, n_split = 4, group.by = \"CellType\",   heatmap_palette = \"viridis\",   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   cell_annotation = c(\"Phase\", \"G2M_score\"), cell_annotation_palette = c(\"Dark2\", \"Purples\") ) #> Error in FeatureHeatmap(srt = pancreas_sub, features = de_filter$gene,     n_split = 4, group.by = \"CellType\", heatmap_palette = \"viridis\",     feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\",         \"steelblue\"), c(\"forestgreen\")), cell_annotation = c(\"Phase\",         \"G2M_score\"), cell_annotation_palette = c(\"Dark2\", \"Purples\")): feature_annotation: TF,CSPA is not in the meta data of the RNA assay in the Seurat object. ht4$plot #> Error: object 'ht4' not found  ht5 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, n_split = 4, group.by = \"CellType\",   heatmap_palette = \"viridis\",   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   cell_annotation = c(\"Phase\", \"G2M_score\"), cell_annotation_palette = c(\"Dark2\", \"Purples\"),   flip = TRUE, column_title_rot = 45 ) #> Error in FeatureHeatmap(srt = pancreas_sub, features = de_filter$gene,     n_split = 4, group.by = \"CellType\", heatmap_palette = \"viridis\",     feature_annotation = c(\"TF\", \"CSPA\"), feature_annotation_palcolor = list(c(\"gold\",         \"steelblue\"), c(\"forestgreen\")), cell_annotation = c(\"Phase\",         \"G2M_score\"), cell_annotation_palette = c(\"Dark2\", \"Purples\"),     flip = TRUE, column_title_rot = 45): feature_annotation: TF,CSPA is not in the meta data of the RNA assay in the Seurat object. ht5$plot #> Error: object 'ht5' not found  pancreas_sub <- RunPAGA(   srt = pancreas_sub, assay_X = \"RNA\", group_by = \"SubCellType\",   linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", infer_pseudotime = TRUE, root_group = \"Ductal\" ) #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" ht6 <- FeatureHeatmap(   srt = pancreas_sub, features = de_filter$gene, nlabel = 10,   cell_order = names(sort(pancreas_sub$dpt_pseudotime)),   cell_annotation = c(\"CellType\", \"dpt_pseudotime\"),   cell_annotation_palette = c(\"Paired\", \"cividis\") ) #> Error in FeatureHeatmap(srt = pancreas_sub, features = de_filter$gene,     nlabel = 10, cell_order = names(sort(pancreas_sub$dpt_pseudotime)),     cell_annotation = c(\"CellType\", \"dpt_pseudotime\"), cell_annotation_palette = c(\"Paired\",         \"cividis\")): cell_annotation: dpt_pseudotime is not in the Seurat object. ht6$plot #> Error: object 'ht6' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureStatPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Statistical plot of features — FeatureStatPlot","title":"Statistical plot of features — FeatureStatPlot","text":"function generates statistical plot features.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureStatPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Statistical plot of features — FeatureStatPlot","text":"","code":"FeatureStatPlot(   srt,   stat.by,   group.by = NULL,   split.by = NULL,   bg.by = NULL,   plot.by = c(\"group\", \"feature\"),   fill.by = c(\"group\", \"feature\", \"expression\"),   cells = NULL,   slot = \"data\",   assay = NULL,   keep_empty = FALSE,   individual = FALSE,   plot_type = c(\"violin\", \"box\", \"bar\", \"dot\", \"col\"),   palette = \"Paired\",   palcolor = NULL,   alpha = 1,   bg_palette = \"Paired\",   bg_palcolor = NULL,   bg_alpha = 0.2,   add_box = FALSE,   box_color = \"black\",   box_width = 0.1,   box_ptsize = 2,   add_point = FALSE,   pt.color = \"grey30\",   pt.size = NULL,   pt.alpha = 1,   jitter.width = 0.4,   jitter.height = 0.1,   add_trend = FALSE,   trend_color = \"black\",   trend_linewidth = 1,   trend_ptsize = 2,   add_stat = c(\"none\", \"mean\", \"median\"),   stat_color = \"black\",   stat_size = 1,   stat_stroke = 1,   stat_shape = 25,   add_line = NULL,   line_color = \"red\",   line_size = 1,   line_type = 1,   cells.highlight = NULL,   cols.highlight = \"red\",   sizes.highlight = 1,   alpha.highlight = 1,   calculate_coexp = FALSE,   same.y.lims = FALSE,   y.min = NULL,   y.max = NULL,   y.trans = \"identity\",   y.nbreaks = 5,   sort = FALSE,   stack = FALSE,   flip = FALSE,   comparisons = NULL,   ref_group = NULL,   pairwise_method = \"wilcox.test\",   multiplegroup_comparisons = FALSE,   multiple_method = \"kruskal.test\",   sig_label = c(\"p.signif\", \"p.format\"),   sig_labelsize = 3.5,   aspect.ratio = NULL,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = \"Expression level\",   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureStatPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Statistical plot of features — FeatureStatPlot","text":"srt Seurat object. stat.character vector specifying features plot. group.character vector specifying groups group . Default NULL. split.character vector specifying variable split plot . Default NULL. bg.character vector specifying variable use background color. Default NULL. plot.character vector specifying plot data, group feature. Possible values \"group\", \"feature\". Default \"group\". fill.string specifying fill plot . Possible values \"group\", \"feature\", \"expression\". Default \"group\". cells character vector specifying cells include plot. Default NULL. slot string specifying slot Seurat object use. Default \"data\". assay string specifying assay use. Default NULL. keep_empty logical indicating whether keep empty levels plot. Default FALSE. individual logical indicating whether create individual plots group. Default FALSE. plot_type string specifying type plot create. Possible values \"violin\", \"box\", \"bar\", \"dot\", \"col\". Default \"violin\". palette string specifying color palette use filling. Default \"Paired\". palcolor character vector specifying specific colors use filling. Default NULL. alpha numeric value specifying transparency plot. Default 1. bg_palette string specifying color palette use background. Default \"Paired\". bg_palcolor character vector specifying specific colors use background. Default NULL. bg_alpha numeric value specifying transparency background. Default 0.2. add_box logical indicating whether add box plot plot. Default FALSE. box_color string specifying color box plot. Default \"black\". box_width numeric value specifying width box plot. Default 0.1. box_ptsize numeric value specifying size points box plot. Default 2. add_point logical indicating whether add individual data points plot. Default FALSE. pt.color string specifying color data points. Default \"grey30\". pt.size numeric value specifying size data points. NULL, size automatically determined. Default NULL. pt.alpha numeric value specifying transparency data points. Default 1. jitter.width numeric value specifying width jitter. Default 0.5. jitter.height numeric value specifying height jitter. Default 0.1. add_trend logical indicating whether add trend line plot. Default FALSE. trend_color string specifying color trend line. Default \"black\". trend_linewidth numeric value specifying width trend line. Default 1. trend_ptsize numeric value specifying size points trend line. Default 2. add_stat string specifying statistical summary add plot. Possible values \"none\", \"mean\", \"median\". Default \"none\". stat_color string specifying color statistical summary. Default \"black\". stat_size numeric value specifying size statistical summary. Default 1. cells.highlight logical character vector specifying cells highlight plot. TRUE, cells highlighted. FALSE, cells highlighted. Default NULL. cols.highlight string specifying color highlighted cells. Default \"red\". sizes.highlight numeric value specifying size highlighted cells. Default 1. alpha.highlight numeric value specifying transparency highlighted cells. Default 1. calculate_coexp logical indicating whether calculate co-expression values. Default FALSE. .y.lims logical indicating whether use y-axis limits plots. Default FALSE. y.min numeric character value specifying minimum y-axis limit. character value provided, must form \"qN\" N number 0 100 (inclusive) representing quantile use limit. Default NULL. y.max numeric character value specifying maximum y-axis limit. character value provided, must form \"qN\" N number 0 100 (inclusive) representing quantile use limit. Default NULL. y.trans string specifying transformation apply y-axis. Possible values \"identity\" \"log2\". Default \"identity\". y.nbreaks integer specifying number breaks use y-axis. Default 5. sort logical character value specifying whether sort groups x-axis. TRUE, groups sorted increasing order. FALSE, groups sorted. \"increasing\", groups sorted increasing order. \"decreasing\", groups sorted decreasing order. Default FALSE. stack logical specifying whether stack plots top . Default FALSE. flip logical specifying whether flip plot vertically. Default FALSE. comparisons list length-2 vectors. entries vector either names 2 values x-axis 2 integers correspond index groups interest, compared. ref_group string specifying reference group pairwise comparisons. Default NULL. pairwise_method string specifying method use pairwise comparisons. Default \"wilcox.test\". multiplegroup_comparisons logical indicating whether add multiple group comparisons plot. Default FALSE. multiple_method string specifying method use multiple group comparisons. Default \"kruskal.test\". sig_label string specifying label use significant comparisons. Possible values \"p.signif\" \"p.format\". Default \"p.format\". sig_labelsize numeric value specifying size significant comparison labels. Default 3.5. aspect.ratio numeric value specifying aspect ratio plot. Default NULL. title string specifying title plot. Default NULL. subtitle string specifying subtitle plot. Default NULL. xlab string specifying label x-axis. Default NULL. ylab string specifying label y-axis. Default \"Expression level\". legend.position string specifying position legend. Possible values \"right\", \"left\", \"top\", \"bottom\", \"none\". Default \"right\". legend.direction string specifying direction legend. Possible values \"vertical\" \"horizontal\". Default \"vertical\". theme_use string specifying theme use plot. Default \"theme_scp\". theme_args list arguments pass theme function. Default empty list. combine logical indicating whether combine individual plots single plot. Default TRUE. nrow integer specifying number rows combined plot. Default NULL. ncol integer specifying number columns combined plot. Default NULL. byrow logical specifying whether fill combined plot row column. Default TRUE. force logical indicating whether force plot creation even 100 levels variable. Default FALSE. seed integer specifying random seed use generating jitter. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FeatureStatPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Statistical plot of features — FeatureStatPlot","text":"","code":"data(\"pancreas_sub\") FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\") %>% panel_fix(height = 1, width = 2) #> Error in panel_fix(., height = 1, width = 2): unused arguments (height = 1, width = 2) FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", plot_type = \"box\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", plot_type = \"bar\") #> Warning: Computation failed in `stat_summary()`. #> Caused by error in `fun.data()`: #> ! The package \"Hmisc\" is required. #> Warning: Computation failed in `stat_summary()`. #> Caused by error in `fun.data()`: #> ! The package \"Hmisc\" is required. #> Warning: Computation failed in `stat_summary()`. #> Caused by error in `fun.data()`: #> ! The package \"Hmisc\" is required. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: Computation failed in `stat_summary()`. #> Caused by error in `fun.data()`: #> ! The package \"Hmisc\" is required. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", plot_type = \"dot\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", plot_type = \"col\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", add_box = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", add_point = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", add_trend = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", add_stat = \"mean\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", add_line = 0.2, line_type = 2) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", split.by = \"Phase\") #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", split.by = \"Phase\", add_box = TRUE, add_trend = TRUE) #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: Groups with fewer than two datapoints have been dropped. #> ℹ Set `drop = FALSE` to consider such groups for position adjustment purposes. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"G2M_score\", \"Fev\"), group.by = \"SubCellType\", split.by = \"Phase\", comparisons = TRUE) #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub, stat.by = c(\"Rbp4\", \"Pyy\"), group.by = \"SubCellType\", fill.by = \"expression\", palette = \"Blues\", same.y.lims = TRUE)  FeatureStatPlot(pancreas_sub, stat.by = c(\"Rbp4\", \"Pyy\"), group.by = \"SubCellType\", multiplegroup_comparisons = TRUE) #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub, stat.by = c(\"Rbp4\", \"Pyy\"), group.by = \"SubCellType\", comparisons = list(c(\"Alpha\", \"Beta\"), c(\"Alpha\", \"Delta\"))) #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub, stat.by = c(\"Rbp4\", \"Pyy\"), group.by = \"SubCellType\", comparisons = list(c(\"Alpha\", \"Beta\"), c(\"Alpha\", \"Delta\")), sig_label = \"p.format\") #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub, stat.by = c(\"Rbp4\", \"Pyy\"), group.by = \"SubCellType\", bg.by = \"CellType\", add_box = TRUE, stack = TRUE)  FeatureStatPlot(pancreas_sub,   stat.by = c(     \"Sox9\", \"Anxa2\", \"Bicc1\", # Ductal     \"Neurog3\", \"Hes6\", # EPs     \"Fev\", \"Neurod1\", # Pre-endocrine     \"Rbp4\", \"Pyy\", # Endocrine     \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon   ),   legend.position = \"top\", legend.direction = \"horizontal\",   group.by = \"SubCellType\", bg.by = \"CellType\", stack = TRUE )  FeatureStatPlot(pancreas_sub,   stat.by = c(     \"Sox9\", \"Anxa2\", \"Bicc1\", # Ductal     \"Neurog3\", \"Hes6\", # EPs     \"Fev\", \"Neurod1\", # Pre-endocrine     \"Rbp4\", \"Pyy\", # Endocrine     \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon   ),   fill.by = \"feature\", plot_type = \"box\",   group.by = \"SubCellType\", bg.by = \"CellType\", stack = TRUE, flip = TRUE ) %>% panel_fix_overall(width = 8, height = 5) # As the plot is created by combining, we can adjust the overall height and width directly.   FeatureStatPlot(pancreas_sub, stat.by = c(\"Neurog3\", \"Rbp4\", \"Ins1\"), group.by = \"CellType\", plot.by = \"group\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub, stat.by = c(\"Neurog3\", \"Rbp4\", \"Ins1\"), group.by = \"CellType\", plot.by = \"feature\") #> Setting 'group.by' to 'Features' as 'plot.by' is set to 'feature' #> Warning: The `slot` argument of `FetchData()` is deprecated as of SeuratObject 5.0.0. #> ℹ Please use the `layer` argument instead. #> ℹ The deprecated feature was likely used in the SCP package. #>   Please report the issue to the authors. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's colour values.  FeatureStatPlot(pancreas_sub,   stat.by = c(\"Neurog3\", \"Rbp4\", \"Ins1\"), group.by = \"CellType\", plot.by = \"feature\",   multiplegroup_comparisons = TRUE, sig_label = \"p.format\", sig_labelsize = 4 ) #> Setting 'group.by' to 'Features' as 'plot.by' is set to 'feature' #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub,   stat.by = c(\"Neurog3\", \"Rbp4\", \"Ins1\"), group.by = \"CellType\", plot.by = \"feature\",   comparisons = list(c(\"Neurog3\", \"Rbp4\"), c(\"Rbp4\", \"Ins1\")),   stack = TRUE ) #> Setting 'group.by' to 'Features' as 'plot.by' is set to 'feature' #> Error in check_R(\"ggpubr\"): could not find function \"check_R\" FeatureStatPlot(pancreas_sub, stat.by = c(   \"Sox9\", \"Anxa2\", \"Bicc1\", # Ductal   \"Neurog3\", \"Hes6\", # EPs   \"Fev\", \"Neurod1\", # Pre-endocrine   \"Rbp4\", \"Pyy\", # Endocrine   \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon ), group.by = \"SubCellType\", plot.by = \"feature\", stack = TRUE) #> Setting 'group.by' to 'Features' as 'plot.by' is set to 'feature'   library(Matrix) #>  #> Attaching package: ‘Matrix’ #> The following object is masked from ‘package:S4Vectors’: #>  #>     expand data <- pancreas_sub@assays$RNA@data pancreas_sub@assays$RNA@scale.data <- as_matrix(data / rowMeans(data)) #> Error in as_matrix(data/rowMeans(data)): could not find function \"as_matrix\" FeatureStatPlot(pancreas_sub,   stat.by = c(\"Neurog3\", \"Rbp4\", \"Ins1\"), group.by = \"CellType\",   slot = \"scale.data\", ylab = \"FoldChange\", same.y.lims = TRUE, y.max = 4 ) #> Warning: Neurog3,Rbp4,Ins1 are not found. #> Error in ExpressionStatPlot(exp.data = exp.data, meta.data = meta.data,     stat.by = stat.by, group.by = group.by, split.by = split.by,     bg.by = bg.by, plot.by = \"group\", fill.by = fill.by, cells = cells,     keep_empty = keep_empty, individual = individual, plot_type = plot_type,     palette = palette, palcolor = palcolor, alpha = alpha, bg_palette = bg_palette,     bg_palcolor = bg_palcolor, bg_alpha = bg_alpha, add_box = add_box,     box_color = box_color, box_width = box_width, box_ptsize = box_ptsize,     add_point = add_point, pt.color = pt.color, pt.size = pt.size,     pt.alpha = pt.alpha, jitter.width = jitter.width, jitter.height = jitter.height,     add_trend = add_trend, trend_color = trend_color, trend_linewidth = trend_linewidth,     trend_ptsize = trend_ptsize, add_stat = add_stat, stat_color = stat_color,     stat_size = stat_size, stat_stroke = stat_stroke, stat_shape = stat_shape,     add_line = add_line, line_color = line_color, line_size = line_size,     line_type = line_type, cells.highlight = cells.highlight,     cols.highlight = cols.highlight, sizes.highlight = sizes.highlight,     alpha.highlight = alpha.highlight, calculate_coexp = calculate_coexp,     same.y.lims = same.y.lims, y.min = y.min, y.max = y.max,     y.trans = y.trans, y.nbreaks = y.nbreaks, sort = sort, stack = stack,     flip = flip, comparisons = comparisons, ref_group = ref_group,     pairwise_method = pairwise_method, multiplegroup_comparisons = multiplegroup_comparisons,     multiple_method = multiple_method, sig_label = sig_label,     sig_labelsize = sig_labelsize, aspect.ratio = aspect.ratio,     title = title, subtitle = subtitle, xlab = xlab, ylab = ylab,     legend.position = legend.position, legend.direction = legend.direction,     theme_use = theme_use, theme_args = theme_args, force = force,     seed = seed): 'stat.by' must be type of numeric variable."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FetchH5.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch data from the hdf5 file — FetchH5","title":"Fetch data from the hdf5 file — FetchH5","text":"function fetches data hdf5 file. can fetch gene expression data, metadata, reduction data specified file returns Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FetchH5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch data from the hdf5 file — FetchH5","text":"","code":"FetchH5(   DataFile,   MetaFile,   name = NULL,   features = NULL,   slot = NULL,   assay = NULL,   metanames = NULL,   reduction = NULL )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FetchH5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch data from the hdf5 file — FetchH5","text":"DataFile path hdf5 file containing data. MetaFile path hdf5 file containing metadata. name name dataset hdf5 file. specified, function attempt find shared group name files. features names genes features fetch. specified, features fetched. slot slot counts hdf5 file. specified, first slot used. assay name assay use. specified, default assay hdf5 file used. metanames names metadata columns fetch. reduction name reduction fetch.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FetchH5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch data from the hdf5 file — FetchH5","text":"Seurat object fetched data.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/FetchH5.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch data from the hdf5 file — FetchH5","text":"","code":"if (FALSE) { # \\dontrun{ data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) PrepareSCExplorer(pancreas_sub, base_dir = \"./SCExplorer\") srt <- FetchH5(   DataFile = \"./SCExplorer/Data.hdf5\",   MetaFile = \"./SCExplorer/Meta.hdf5\",   features = c(\"Ins1\", \"Ghrl\"),   metanames = c(\"SubCellType\", \"Phase\"),   reduction = \"UMAP\" ) CellDimPlot(srt, group.by = c(\"SubCellType\", \"Phase\"), reduction = \"UMAP\") FeatureDimPlot(srt, features = c(\"Ins1\", \"Ghrl\"), reduction = \"UMAP\") } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GSEAPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"GSEA Plot — GSEAPlot","title":"GSEA Plot — GSEAPlot","text":"function generates various types plots Gene Set Enrichment Analysis (GSEA) results.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GSEAPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GSEA Plot — GSEAPlot","text":"","code":"GSEAPlot(   srt,   db = \"GO_BP\",   group_by = NULL,   test.use = \"wilcox\",   res = NULL,   plot_type = c(\"line\", \"bar\", \"network\", \"enrichmap\", \"wordcloud\", \"comparison\"),   group_use = NULL,   id_use = NULL,   pvalueCutoff = NULL,   padjustCutoff = 0.05,   topTerm = ifelse(plot_type == \"enrichmap\", 100, 6),   direction = c(\"pos\", \"neg\", \"both\"),   compare_only_sig = FALSE,   topWord = 100,   word_type = c(\"term\", \"feature\"),   word_size = c(2, 8),   words_excluded = NULL,   line_width = 1.5,   line_alpha = 1,   line_color = \"#6BB82D\",   n_coregene = 10,   sample_coregene = FALSE,   features_label = NULL,   label.fg = \"black\",   label.bg = \"white\",   label.bg.r = 0.1,   label.size = 4,   network_layout = \"fr\",   network_labelsize = 5,   network_blendmode = \"blend\",   network_layoutadjust = TRUE,   network_adjscale = 60,   network_adjiter = 100,   enrichmap_layout = \"fr\",   enrichmap_cluster = \"fast_greedy\",   enrichmap_label = c(\"term\", \"feature\"),   enrichmap_labelsize = 5,   enrlichmap_nlabel = 4,   enrichmap_show_keyword = FALSE,   enrichmap_mark = c(\"ellipse\", \"hull\"),   enrichmap_expand = c(0.5, 0.5),   character_width = 50,   lineheight = 0.5,   palette = \"Spectral\",   palcolor = NULL,   aspect.ratio = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GSEAPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GSEA Plot — GSEAPlot","text":"srt Seurat object containing results RunDEtest RunGSEA. specified, GSEA results extracted Seurat object automatically. specified, res arguments must provided. db database use enrichment plot. Default \"GO_BP\". group_by character vector specifying grouping variable Seurat object. argument used srt specified. test.use character vector specifying test used differential expression analysis. argument used srt specified. res Enrichment results generated RunGSEA function. provided, 'srt', 'test.use' 'group_by' ignored. plot_type type plot generate. Options : \"line\", \"comparison\", \"bar\", \"network\", \"enrichmap\", \"wordcloud\". Default \"line\". group_use group(s) used enrichment plot. Default NULL. id_use List IDs used display specific terms enrichment plot. Default value NULL. pvalueCutoff p-value cutoff. Default NULL. work padjustCutoff NULL. padjustCutoff p-adjusted cutoff. Default 0.05. topTerm number top terms display. Default 6, 100 'plot_type' \"enrichmap\". direction direction enrichment include plot. Must one \"pos\", \"neg\", \"\". default value \"\". compare_only_sig Whether compare significant terms. Default FALSE. topWord number top words display wordcloud. Default 100. word_type type words display wordcloud. Options \"term\" \"feature\". Default \"term\". word_size size range words wordcloud. Default c(2, 8). words_excluded Words excluded wordcloud. default value NULL, means built-words (SCP::words_excluded) used. line_width linewidth line plot. line_alpha alpha value line plot. line_color color line plot. n_coregene number core genes label line plot. sample_coregene Whether randomly sample core genes labeling line plot. features_label character vector feature names include labels line plot. label.fg color labels. label.bg background color labels. label.bg.r radius rounding label's background. label.size size labels. network_layout layout algorithm use network plot. Options \"fr\", \"kk\",\"random\", \"circle\", \"tree\", \"grid\", algorithm 'igraph' package. Default \"fr\". network_labelsize label size network plot. Default 5. network_blendmode blend mode network plot. Default \"blend\". network_layoutadjust Whether adjust layout network plot avoid overlapping words. Default TRUE. network_adjscale scale adjusting network plot layout. Default 60. network_adjiter number iterations adjusting network plot layout. Default 100. enrichmap_layout layout algorithm use enrichmap plot. Options \"fr\", \"kk\",\"random\", \"circle\", \"tree\", \"grid\", algorithm 'igraph' package. Default \"fr\". enrichmap_cluster clustering algorithm use enrichmap plot. Options \"walktrap\", \"fast_greedy\", algorithm 'igraph' package. Default \"fast_greedy\". enrichmap_label label type enrichmap plot. Options \"term\" \"feature\". Default \"term\". enrichmap_labelsize label size enrichmap plot. Default 5. enrlichmap_nlabel number labels display cluster enrichmap plot. Default 4. enrichmap_show_keyword Whether show keyword terms features enrichmap plot. Default FALSE. enrichmap_mark mark shape enrichmap plot. Options \"ellipse\" \"hull\". Default \"ellipse\". enrichmap_expand expansion factor enrichmap plot. Default c(0.5, 0.5). character_width maximum width character descriptions. Default 50. lineheight line height y-axis labels. Default 0.5. palette color palette use. Default \"Spectral\". palcolor Custom colors palette. Default NULL. aspect.ratio aspect ratio plot. Default 1. legend.position position legend. Default \"right\". legend.direction direction legend. Default \"vertical\". theme_use theme use plot. Default \"theme_scp\". theme_args arguments pass theme. Default empty list. combine Whether combine multiple plots single plot. Default TRUE. nrow number rows combined plot. Default NULL, calculated based number plots. ncol number columns combined plot. Default NULL, calculated based number plots. byrow Whether fill combined plot row. Default TRUE. seed random seed use. Default 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GSEAPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GSEA Plot — GSEAPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\", only.pos = FALSE, fc.threshold = 1) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunGSEA(pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", species = \"Mus_musculus\") #> [2025-09-07 20:33:31.306261] Start GSEA #> Workers: 2 #> Error in RunGSEA(pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", id_use = \"GO:0006412\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\",     id_use = \"GO:0006412\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", id_use = c(\"GO:0046903\", \"GO:0015031\", \"GO:0007600\")) %>%   panel_fix_overall(height = 6) # As the plot is created by combining, we can adjust the overall height and width directly. #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     id_use = c(\"GO:0046903\", \"GO:0015031\", \"GO:0007600\")): No enrichment result found. You may perform RunGSEA first.  GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3,     plot_type = \"comparison\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\", direction = \"neg\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3,     plot_type = \"comparison\", direction = \"neg\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\", direction = \"both\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3,     plot_type = \"comparison\", direction = \"both\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3, plot_type = \"comparison\", compare_only_sig = TRUE) #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", topTerm = 3,     plot_type = \"comparison\", compare_only_sig = TRUE): No enrichment result found. You may perform RunGSEA first.  GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\", direction = \"both\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"bar\",     direction = \"both\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub,   db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\",   plot_type = \"bar\", topTerm = 20, direction = \"both\", palcolor = c(\"red3\", \"steelblue\") ) #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\",     plot_type = \"bar\", topTerm = 20, direction = \"both\", palcolor = c(\"red3\",         \"steelblue\")): No enrichment result found. You may perform RunGSEA first.  GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", plot_type = \"network\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     plot_type = \"network\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", plot_type = \"enrichmap\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     plot_type = \"enrichmap\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", plot_type = \"wordcloud\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     plot_type = \"wordcloud\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", plot_type = \"wordcloud\", word_type = \"feature\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     plot_type = \"wordcloud\", word_type = \"feature\"): No enrichment result found. You may perform RunGSEA first."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GeneConvert.html","id":null,"dir":"Reference","previous_headings":"","what":"Gene ID conversion function using biomart — GeneConvert","title":"Gene ID conversion function using biomart — GeneConvert","text":"function can convert different gene ID types within one species two species using biomart service.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GeneConvert.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gene ID conversion function using biomart — GeneConvert","text":"","code":"GeneConvert(   geneID,   geneID_from_IDtype = \"symbol\",   geneID_to_IDtype = \"entrez_id\",   species_from = \"Homo_sapiens\",   species_to = NULL,   Ensembl_version = 103,   biomart = NULL,   mirror = NULL,   max_tries = 5 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GeneConvert.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gene ID conversion function using biomart — GeneConvert","text":"geneID vector geneID character. geneID_from_IDtype Gene ID type input geneID. e.g. \"symbol\", \"ensembl_id\", \"entrez_id\" geneID_to_IDtype Gene ID type(s) convert . e.g. \"symbol\", \"ensembl_id\", \"entrez_id\" species_from Latin names animals input geneID. e.g. \"Homo_sapiens\",\"Mus_musculus\" species_to Latin names animals output geneID. e.g. \"Homo_sapiens\",\"Mus_musculus\" Ensembl_version Ensembl database version. NULL, use current release version. biomart name BioMart database want connect . Possible options include \"ensembl\", \"protists_mart\", \"fungi_mart\", \"plants_mart\". mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. max_tries maximum number attempts connect BioMart service.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GeneConvert.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gene ID conversion function using biomart — GeneConvert","text":"list following elements: geneID_res: data.frame contains gene IDs mapped database columns: 'from_IDtype','from_geneID','to_IDtype','to_geneID' geneID_collapse: data.frame contains successfully converted gene IDs, output gene IDs collapsed list. result, 'from_geneID' column (set row names) data.frame unique. geneID_expand: data.frame contains successfully converted gene IDs, output gene IDs expanded. Ensembl_version: Ensembl database version. Datasets: Datasets available selected BioMart database. Attributes: Attributes available selected BioMart database. geneID_unmapped: character vector gene IDs unmapped database.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GeneConvert.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Gene ID conversion function using biomart — GeneConvert","text":"","code":"res <- GeneConvert(   geneID = c(\"CDK1\", \"MKI67\", \"TOP2A\", \"AURKA\", \"CTCF\"),   geneID_from_IDtype = \"symbol\",   geneID_to_IDtype = \"entrez_id\",   species_from = \"Homo_sapiens\",   species_to = \"Mus_musculus\",   Ensembl_version = 103 ) #> Connect to the Ensembl archives... #> Using the 103 version of biomart... #> Connecting to the biomart... #> Searching the dataset hsapiens ... #> Connecting to the dataset hsapiens_gene_ensembl ... #> Searching the dataset mmusculus ... #> Connecting to the dataset mmusculus_gene_ensembl ... #> Converting the geneIDs... #> 5 genes mapped with ensembl_symbol #> ============================== #> 5 genes mapped #> 0 genes unmapped #> ============================== #> Error in unnest(data = geneID_collapse, cols = colnames(geneID_collapse)[sapply(geneID_collapse,     class) %in% c(\"list\", \"AsIs\")], keep_empty = FALSE): could not find function \"unnest\" str(res) #> Error: object 'res' not found  # Convert the human genes to mouse homologs and replace the raw counts in a Seurat object. data(\"pancreas_sub\") counts <- get_seurat_data(pancreas_sub, slot = \"counts\", assay = \"RNA\") #> Error in get_seurat_data(pancreas_sub, slot = \"counts\", assay = \"RNA\"): unused argument (slot = \"counts\") res <- GeneConvert(   geneID = rownames(counts),   geneID_from_IDtype = \"symbol\",   geneID_to_IDtype = \"symbol\",   species_from = \"Mus_musculus\",   species_to = \"Homo_sapiens\",   Ensembl_version = 103 ) #> Connect to the Ensembl archives... #> Using the 103 version of biomart... #> Connecting to the biomart... #> Searching the dataset mmusculus ... #> Connecting to the dataset mmusculus_gene_ensembl ... #> Converting the geneIDs... #> ============================== #> 0 genes mapped #> 0 genes unmapped #> ============================== #> Warning: None of the gene IDs were converted # Check the number of input and converted gene IDs input_genes <- length(rownames(counts)) db_genes <- length(unique(res$geneID_res$from_geneID)) converted_genes_input <- length(unique(res$geneID_collapse$from_geneID)) converted_genes_output <- length(unique(res$geneID_expand$symbol)) cat(\"Number of input gene IDs:\", input_genes, \"\\n\") #> Number of input gene IDs: 0  cat(\"Number of gene IDs mapped in the database:\", db_genes, \"\\n\") #> Number of gene IDs mapped in the database: 0  cat(\"Number of input gene IDs that were successfully converted:\", converted_genes_input, \"\\n\") #> Number of input gene IDs that were successfully converted: 0  cat(\"Number of converted gene IDs:\", converted_genes_output, \"\\n\") #> Number of converted gene IDs: 0   homologs_counts <- aggregate(   x = counts[res$geneID_expand[, \"from_geneID\"], ],   by = list(res$geneID_expand[, \"symbol\"]), FUN = sum ) #> Error in (function (cond) .Internal(C_tryCatchHelper(addr, 1L, cond)))(structure(list(message = \"object of type 'closure' is not subsettable\",     call = counts[res$geneID_expand[, \"from_geneID\"], ], object = new(\"standardGeneric\",         .Data = function (object, ...)         standardGeneric(\"counts\"), generic = structure(\"counts\", package = \"BiocGenerics\"),         package = \"BiocGenerics\", group = list(), valueClass = character(0),         signature = \"object\", default = NULL, skeleton = (function (object,             ...)         stop(gettextf(\"invalid call in method dispatch to '%s' (no default method)\",             \"counts\"), domain = NA))(object, ...))), class = c(\"notSubsettableError\", \"error\", \"condition\"))): error in evaluating the argument 'x' in selecting a method for function 'aggregate': object of type 'closure' is not subsettable rownames(homologs_counts) <- homologs_counts[, 1] #> Error: object 'homologs_counts' not found homologs_counts <- as(as_matrix(homologs_counts[, -1]), \"dgCMatrix\") #> Error in as_matrix(homologs_counts[, -1]): could not find function \"as_matrix\" homologs_counts #> Error: object 'homologs_counts' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GraphPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"GraphPlot — GraphPlot","title":"GraphPlot — GraphPlot","text":"function plot graph nodes edges.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GraphPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GraphPlot — GraphPlot","text":"","code":"GraphPlot(   node,   edge,   transition = NULL,   node_coord = c(\"x\", \"y\"),   node_group = NULL,   node_palette = \"Paired\",   node_palcolor = NULL,   node_size = 4,   node_alpha = 1,   node_highlight = NULL,   node_highlight_color = \"red\",   label = FALSE,   label.size = 3.5,   label.fg = \"white\",   label.bg = \"black\",   label.bg.r = 0.1,   label_insitu = FALSE,   label_repel = FALSE,   label_repulsion = 20,   label_point_size = 1,   label_point_color = \"black\",   label_segment_color = \"black\",   edge_threshold = 0.01,   use_triangular = c(\"upper\", \"lower\", \"both\"),   edge_line = c(\"straight\", \"curved\"),   edge_line_curvature = 0.3,   edge_line_angle = 90,   edge_color = \"grey40\",   edge_size = c(0.2, 1),   edge_alpha = 0.5,   edge_shorten = 0,   edge_offset = 0,   edge_highlight = NULL,   edge_highlight_color = \"red\",   transition_threshold = 0.01,   transition_line = c(\"straight\", \"curved\"),   transition_line_curvature = 0.3,   transition_line_angle = 90,   transition_color = \"black\",   transition_size = c(0.2, 1),   transition_alpha = 1,   transition_arrow_type = \"closed\",   transition_arrow_angle = 20,   transition_arrow_length = unit(0.02, \"npc\"),   transition_shorten = 0.05,   transition_offset = 0,   transition_highlight = NULL,   transition_highlight_color = \"red\",   aspect.ratio = 1,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   return_layer = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GraphPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GraphPlot — GraphPlot","text":"node data frame representing nodes graph. edge matrix representing edges graph. transition matrix representing transitions nodes. node_coord character vector specifying names columns node represent x y coordinates. node_group character vector specifying name column node represents grouping nodes. node_palette character vector specifying name color palette node groups. node_palcolor character vector specifying names colors node group. node_size numeric value column name node specifying size nodes. node_alpha numeric value column name node specifying transparency nodes. node_highlight character vector specifying names nodes highlight. node_highlight_color character vector specifying color highlighting nodes. label logical value indicating whether show labels nodes. label.size numeric value specifying size labels. label.fg character vector specifying foreground color labels. label.bg character vector specifying background color labels. label.bg.r numeric value specifying background color transparency labels. label_insitu logical value indicating whether display node group labels situ numeric values. label_repel logical value indicating whether use force-directed label repulsion. label_repulsion numeric value specifying repulsion force labels. label_point_size numeric value specifying size label points. label_point_color character vector specifying color label points. label_segment_color character vector specifying color label segments. edge_threshold numeric value specifying threshold removing edges. use_triangular character vector specifying part edge matrix use (upper, lower, ). edge_line character vector specifying type line edges (straight, curved). edge_line_curvature numeric value specifying curvature curved edges. edge_line_angle numeric value specifying angle curved edges. edge_color character vector specifying color edges. edge_size numeric vector specifying range edge sizes. edge_alpha numeric value specifying transparency edges. edge_shorten numeric value specifying length edge shorten. edge_offset numeric value specifying length edge offset. edge_highlight character vector specifying names edges highlight. edge_highlight_color character vector specifying color highlighting edges. transition_threshold numeric value specifying threshold removing transitions. transition_line character vector specifying type line transitions (straight, curved). transition_line_curvature numeric value specifying curvature curved transitions. transition_line_angle numeric value specifying angle curved transitions. transition_color character vector specifying color transitions. transition_size numeric vector specifying range transition sizes. transition_alpha numeric value specifying transparency transitions. transition_arrow_type character vector specifying type arrow transitions (closed, open). transition_arrow_angle numeric value specifying angle transition arrow. transition_arrow_length numeric value specifying length transition arrow. transition_shorten numeric value specifying length transition shorten. transition_offset numeric value specifying length transition offset. transition_highlight character vector specifying names transitions highlight. transition_highlight_color character vector specifying color highlighting transitions. aspect.ratio numeric value specifying aspect ratio plot. title character value specifying title plot. subtitle character value specifying subtitle plot. xlab character value specifying label x-axis. ylab character value specifying label y-axis. legend.position character value specifying position legend. legend.direction character value specifying direction legend. theme_use character value specifying theme use. theme_args list arguments passed theme. return_layer logical value indicating whether return layers plot instead plot .","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"GroupHeatmap — GroupHeatmap","title":"GroupHeatmap — GroupHeatmap","text":"GroupHeatmap","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GroupHeatmap — GroupHeatmap","text":"","code":"GroupHeatmap(   srt,   features = NULL,   group.by = NULL,   split.by = NULL,   within_groups = FALSE,   grouping.var = NULL,   numerator = NULL,   cells = NULL,   aggregate_fun = base::mean,   exp_cutoff = 0,   border = TRUE,   flip = FALSE,   slot = \"counts\",   assay = NULL,   exp_method = c(\"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\"),   exp_legend_title = NULL,   limits = NULL,   lib_normalize = identical(slot, \"counts\"),   libsize = NULL,   feature_split = NULL,   feature_split_by = NULL,   n_split = NULL,   split_order = NULL,   split_method = c(\"kmeans\", \"hclust\", \"mfuzz\"),   decreasing = FALSE,   fuzzification = NULL,   cluster_features_by = NULL,   cluster_rows = FALSE,   cluster_columns = FALSE,   cluster_row_slices = FALSE,   cluster_column_slices = FALSE,   show_row_names = FALSE,   show_column_names = FALSE,   row_names_side = ifelse(flip, \"left\", \"right\"),   column_names_side = ifelse(flip, \"bottom\", \"top\"),   row_names_rot = 0,   column_names_rot = 90,   row_title = NULL,   column_title = NULL,   row_title_side = \"left\",   column_title_side = \"top\",   row_title_rot = 0,   column_title_rot = ifelse(flip, 90, 0),   anno_terms = FALSE,   anno_keys = FALSE,   anno_features = FALSE,   terms_width = unit(4, \"in\"),   terms_fontsize = 8,   keys_width = unit(2, \"in\"),   keys_fontsize = c(6, 10),   features_width = unit(2, \"in\"),   features_fontsize = c(6, 10),   IDtype = \"symbol\",   species = \"Homo_sapiens\",   db_update = FALSE,   db_version = \"latest\",   db_combine = FALSE,   convert_species = FALSE,   Ensembl_version = 103,   mirror = NULL,   db = \"GO_BP\",   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   GO_simplify = FALSE,   GO_simplify_cutoff = \"p.adjust < 0.05\",   simplify_method = \"Wang\",   simplify_similarityCutoff = 0.7,   pvalueCutoff = NULL,   padjustCutoff = 0.05,   topTerm = 5,   show_termid = FALSE,   topWord = 20,   words_excluded = NULL,   nlabel = 20,   features_label = NULL,   label_size = 10,   label_color = \"black\",   add_bg = FALSE,   bg_alpha = 0.5,   add_dot = FALSE,   dot_size = unit(8, \"mm\"),   add_reticle = FALSE,   reticle_color = \"grey\",   add_violin = FALSE,   fill.by = \"feature\",   fill_palette = \"Dark2\",   fill_palcolor = NULL,   heatmap_palette = \"RdBu\",   heatmap_palcolor = NULL,   group_palette = \"Paired\",   group_palcolor = NULL,   cell_split_palette = \"simspec\",   cell_split_palcolor = NULL,   feature_split_palette = \"simspec\",   feature_split_palcolor = NULL,   cell_annotation = NULL,   cell_annotation_palette = \"Paired\",   cell_annotation_palcolor = NULL,   cell_annotation_params = if (flip) list(width = unit(10, \"mm\")) else list(height =     unit(10, \"mm\")),   feature_annotation = NULL,   feature_annotation_palette = \"Dark2\",   feature_annotation_palcolor = NULL,   feature_annotation_params = if (flip) list(height = unit(5, \"mm\")) else list(width =     unit(5, \"mm\")),   use_raster = NULL,   raster_device = \"png\",   raster_by_magick = FALSE,   height = NULL,   width = NULL,   units = \"inch\",   seed = 11,   ht_params = list() )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GroupHeatmap — GroupHeatmap","text":"srt Seurat object. features features include heatmap. group.character vector specifying groups group . Default NULL. split.character vector specifying variable split heatmap . Default NULL. within_groups logical value indicating whether create separate heatmap scales group within group. Default FALSE. grouping.var character vector specifies another variable grouping, certain conditions. default value NULL. numerator character vector specifying value use numerator grouping.var grouping. Default NULL. cells character vector specifying cells include heatmap. Default NULL. aggregate_fun function use aggregating data within groups. Default base::mean. exp_cutoff numeric value specifying threshold cell counting add_dot TRUE. Default 0. border logical value indicating whether add border heatmap. Default TRUE. flip logical value indicating whether flip heatmap. Default FALSE. slot character vector specifying slot Seurat object use. Default \"counts\". assay character vector specifying assay Seurat object use. Default NULL. exp_method character vector specifying method calculating expression values. Default \"zscore\" options \"zscore\", \"raw\", \"fc\", \"log2fc\", \"log1p\". exp_legend_title character vector specifying title legend expression value. Default NULL. limits two-length numeric vector specifying limits color scale. Default NULL. lib_normalize logical value indicating whether normalize data library size. libsize numeric vector specifying library size cell. Default NULL. feature_split factor specifying split features. Default NULL. feature_split_by character vector specifying group.use splitting features (n_split feature clusters). Default NULL. n_split integer specifying number feature splits (feature clusters) create. Default NULL. split_order numeric vector specifying order splits. Default NULL. split_method character vector specifying method splitting features. Default \"kmeans\" options \"kmeans\", \"hclust\", \"mfuzz\"). decreasing logical value indicating whether sort feature splits decreasing order. Default FALSE. fuzzification numeric value specifying fuzzification coefficient. Default NULL. cluster_features_by character vector specifying group.use clustering features. Default NULL. default, parameter set NULL, means groups used. cluster_rows logical value indicating whether cluster rows heatmap. Default FALSE. cluster_columns logical value indicating whether cluster columns heatmap. Default FALSE. cluster_row_slices logical value indicating whether cluster row slices heatmap. Default FALSE. cluster_column_slices logical value indicating whether cluster column slices heatmap. Default FALSE. show_row_names logical value indicating whether show row names heatmap. Default FALSE. show_column_names logical value indicating whether show column names heatmap. Default FALSE. row_names_side character vector specifying side place row names. column_names_side character vector specifying side place column names. row_names_rot numeric value specifying rotation angle row names. Default 0. column_names_rot numeric value specifying rotation angle column names. Default 90. row_title character vector specifying title rows. Default NULL. column_title character vector specifying title columns. Default NULL. row_title_side character vector specifying side place row title. Default \"left\". column_title_side character vector specifying side place column title. Default \"top\". row_title_rot numeric value specifying rotation angle row title. Default 0. column_title_rot numeric value specifying rotation angle column title. anno_terms logical value indicating whether include term annotations. Default FALSE. anno_keys logical value indicating whether include key annotations. Default FALSE. anno_features logical value indicating whether include feature annotations. Default FALSE. terms_width unit specifying width term annotations. Default unit(4, \"\"). terms_fontsize numeric vector specifying font size(s) term annotations. Default 8. keys_width unit specifying width key annotations. Default unit(2, \"\"). keys_fontsize two-length numeric vector specifying minimum maximum font size(s) key annotations. Default c(6, 10). features_width unit specifying width feature annotations. Default unit(2, \"\"). features_fontsize two-length numeric vector specifying minimum maximum font size(s) feature annotations. Default c(6, 10). IDtype character vector specifying type IDs features. Default \"symbol\". species character vector specifying species features. Default \"Homo_sapiens\". db_update logical value indicating whether update database. Default FALSE. db_version character vector specifying version database. Default \"latest\". db_combine logical value indicating whether use combined database. Default FALSE. convert_species logical value indicating whether use species-converted database annotation missing species. Default FALSE. Ensembl_version integer specifying Ensembl version. Default 103. mirror character vector specifying mirror Ensembl database. Default NULL. db character vector specifying database use. Default \"GO_BP\". TERM2GENE data.frame specifying TERM2GENE mapping database. Default NULL. TERM2NAME data.frame specifying TERM2NAME mapping database. Default NULL. minGSSize integer specifying minimum gene set size database. Default 10. maxGSSize integer specifying maximum gene set size database. Default 500. GO_simplify logical value indicating whether simplify gene ontology terms. Default FALSE. GO_simplify_cutoff character vector specifying cutoff GO simplification. Default \"p.adjust < 0.05\". simplify_method character vector specifying method GO simplification. Default \"Wang\". simplify_similarityCutoff numeric value specifying similarity cutoff GO simplification. Default 0.7. pvalueCutoff numeric vector specifying p-value cutoff(s) significance. Default NULL. padjustCutoff numeric value specifying adjusted p-value cutoff significance. Default 0.05. topTerm integer specifying number top terms include. Default 5. show_termid logical value indicating whether show term IDs. Default FALSE. topWord integer specifying number top words include. Default 20. words_excluded character vector specifying words exclude. Default NULL. nlabel integer specifying number labels include. Default 0. features_label character vector specifying features label. Default NULL. label_size numeric value specifying size labels. Default 10. label_color character vector specifying color labels. Default \"black\". add_bg logical value indicating whether add background heatmap. Default FALSE. bg_alpha numeric value specifying alpha value background color. Default 0.5. add_dot logical value indicating whether add dots heatmap. size dot represents percentage expressed cells based specified exp_cutoff. Default FALSE. dot_size unit specifying base size dots. Default unit(8, \"mm\"). add_reticle logical value indicating whether add reticles heatmap. Default FALSE. reticle_color character vector specifying color reticles. Default \"grey\". add_violin logical value indicating whether add violins heatmap. Default FALSE. fill.character vector specifying fill violin. Possible values \"group\", \"feature\", \"expression\". Default \"feature\". fill_palette character vector specifying palette use fill. Default \"Dark2\". fill_palcolor character vector specifying fill color use. Default NULL. heatmap_palette character vector specifying palette use heatmap. Default \"RdBu\". heatmap_palcolor character vector specifying heatmap color use. Default NULL. group_palette character vector specifying palette use groups. Default \"Paired\". group_palcolor character vector specifying group color use. Default NULL. cell_split_palette character vector specifying palette use cell splits. Default \"simspec\". cell_split_palcolor character vector specifying cell split color use. Default NULL. feature_split_palette character vector specifying palette use feature splits. Default \"simspec\". feature_split_palcolor character vector specifying feature split color use. Default NULL. cell_annotation character vector specifying cell annotation(s) include. Default NULL. cell_annotation_palette character vector specifying palette use cell annotations. length vector match number cell_annotation. Default \"Paired\". cell_annotation_palcolor list character vector specifying cell annotation color(s) use. length list match number cell_annotation. Default NULL. cell_annotation_params list specifying additional parameters cell annotations. Default list width = unit(1, \"cm\") flip TRUE, else list height = unit(1, \"cm\"). feature_annotation character vector specifying feature annotation(s) include. Default NULL. feature_annotation_palette character vector specifying palette use feature annotations. length vector match number feature_annotation. Default \"Dark2\". feature_annotation_palcolor list character vector specifying feature annotation color use. length list match number feature_annotation. Default NULL. feature_annotation_params list specifying additional parameters feature annotations. Default empty list. use_raster logical value indicating whether use raster device plotting. Default NULL. raster_device character vector specifying raster device use. Default \"png\". raster_by_magick logical value indicating whether use 'magick' package raster. Default FALSE. height numeric vector specifying height(s) heatmap body. Default NULL. width numeric vector specifying width(s) heatmap body. Default NULL. units character vector specifying units height width. Default \"inch\". seed integer specifying random seed. Default 11. ht_params list specifying additional parameters passed ComplexHeatmap::Heatmap function. Default empty list.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GroupHeatmap — GroupHeatmap","text":"list following elements: plotThe heatmap plot. matrix_listA list matrix group.used heatmap. feature_splitNULL factor splitting performed heatmap. cell_metadataMeta data cells used generate heatmap. cell_metadataMeta data features used generate heatmap. enrichmentNULL enrichment result generated RunEnrichment parameters anno_terms, anno_keys, anno_features set TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/GroupHeatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GroupHeatmap — GroupHeatmap","text":"","code":"library(dplyr) data(\"pancreas_sub\") ht1 <- GroupHeatmap(pancreas_sub,   features = c(     \"Sox9\", \"Anxa2\", \"Bicc1\", # Ductal     \"Neurog3\", \"Hes6\", # EPs     \"Fev\", \"Neurod1\", # Pre-endocrine     \"Rbp4\", \"Pyy\", # Endocrine     \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon   ),   group.by = c(\"CellType\", \"SubCellType\") ) #> 'magick' package is suggested to install to give better rasterization. #>  #> Set `ht_opt$message = FALSE` to turn off this message. ht1$plot  panel_fix(ht1$plot, height = 4, width = 6, raster = TRUE, dpi = 50) #> Error in panel_fix(ht1$plot, height = 4, width = 6, raster = TRUE, dpi = 50): unused arguments (height = 4, width = 6, raster = TRUE, dpi = 50)  pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector de_filter <- filter(pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\"  ht2 <- GroupHeatmap(   srt = pancreas_sub, features = de_filter$gene, group.by = \"CellType\",   split.by = \"Phase\", cell_split_palette = \"Dark2\",   cluster_rows = TRUE, cluster_columns = TRUE ) #> Error: object 'de_filter' not found ht2$plot #> Error: object 'ht2' not found  ht3 <- GroupHeatmap(   srt = pancreas_sub, features = de_filter$gene, feature_split = de_filter$group1, group.by = \"CellType\",   species = \"Mus_musculus\", db = \"GO_BP\", anno_terms = TRUE, anno_keys = TRUE, anno_features = TRUE ) #> Error: object 'de_filter' not found ht3$plot #> Error: object 'ht3' not found  pancreas_sub <- AnnotateFeatures(pancreas_sub, species = \"Mus_musculus\", db = c(\"TF\", \"CSPA\")) #> Species: Mus_musculus #> Preparing database: TF #> Error in download(url = url, destfile = temp): could not find function \"download\" de_top <- de_filter %>%   group_by(gene) %>%   top_n(1, avg_log2FC) %>%   group_by(group1) %>%   top_n(3, avg_log2FC) #> Error: object 'de_filter' not found ht4 <- GroupHeatmap(pancreas_sub,   features = de_top$gene, feature_split = de_top$group1, group.by = \"CellType\",   heatmap_palette = \"YlOrRd\",   cell_annotation = c(\"Phase\", \"G2M_score\", \"Neurod2\"), cell_annotation_palette = c(\"Dark2\", \"Paired\", \"Paired\"),   cell_annotation_params = list(height = unit(10, \"mm\")),   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   add_dot = TRUE, add_bg = TRUE, nlabel = 0, show_row_names = TRUE ) #> Error: object 'de_top' not found ht4$plot #> Error: object 'ht4' not found  ht5 <- GroupHeatmap(pancreas_sub,   features = de_top$gene, feature_split = de_top$group1, group.by = \"CellType\",   heatmap_palette = \"YlOrRd\",   cell_annotation = c(\"Phase\", \"G2M_score\", \"Neurod2\"), cell_annotation_palette = c(\"Dark2\", \"Paired\", \"Paired\"),   cell_annotation_params = list(width = unit(10, \"mm\")),   feature_annotation = c(\"TF\", \"CSPA\"),   feature_annotation_palcolor = list(c(\"gold\", \"steelblue\"), c(\"forestgreen\")),   add_dot = TRUE, add_bg = TRUE,   flip = TRUE, column_title_rot = 45, nlabel = 0, show_row_names = TRUE ) #> Error: object 'de_top' not found ht5$plot #> Error: object 'ht5' not found  ht6 <- GroupHeatmap(pancreas_sub,   features = de_top$gene, feature_split = de_top$group1, group.by = \"CellType\",   add_violin = TRUE, cluster_rows = TRUE,   nlabel = 0, show_row_names = TRUE ) #> Error: object 'de_top' not found ht6$plot #> Error: object 'ht6' not found  ht7 <- GroupHeatmap(pancreas_sub,   features = de_top$gene, feature_split = de_top$group1, group.by = \"CellType\",   add_violin = TRUE, fill.by = \"expression\", fill_palette = \"Blues\", cluster_rows = TRUE,   nlabel = 0, show_row_names = TRUE ) #> Error: object 'de_top' not found ht7$plot #> Error: object 'ht7' not found  ht8 <- GroupHeatmap(pancreas_sub,   features = de_top$gene, group.by = \"CellType\", split.by = \"Phase\", n_split = 4,   cluster_rows = TRUE, cluster_columns = TRUE, cluster_row_slices = TRUE, cluster_column_slices = TRUE,   add_dot = TRUE, add_reticle = TRUE, heatmap_palette = \"viridis\",   nlabel = 0, show_row_names = TRUE,   ht_params = list(row_gap = unit(0, \"mm\"), row_names_gp = gpar(fontsize = 10)) ) #> Error: object 'de_top' not found ht8$plot #> Error: object 'ht8' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Harmony_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Harmony_integrate — Harmony_integrate","title":"Harmony_integrate — Harmony_integrate","text":"Harmony_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Harmony_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Harmony_integrate — Harmony_integrate","text":"","code":"Harmony_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   Harmony_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   RunHarmony_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Harmony_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Harmony_integrate — Harmony_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. Harmony_dims_use vector specifying dimensions returned RunHarmony utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). RunHarmony_params list parameters harmony::RunHarmony function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html","id":null,"dir":"Reference","previous_headings":"","what":"Integration_SCP — Integration_SCP","title":"Integration_SCP — Integration_SCP","text":"Integrate single-cell RNA-seq data using various integration methods.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Integration_SCP — Integration_SCP","text":"","code":"Integration_SCP(   srtMerge = NULL,   batch,   append = TRUE,   srtList = NULL,   assay = NULL,   integration_method = \"Uncorrected\",   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   seed = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Integration_SCP — Integration_SCP","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. integration_method character string specifying integration method use. Supported methods : \"Uncorrected\", \"Seurat\", \"scVI\", \"MNN\", \"fastMNN\", \"Harmony\", \"Scanorama\", \"BBKNN\", \"CSS\", \"LIGER\", \"Conos\", \"ComBat\". Default \"Uncorrected\". do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). seed integer specifying random seed reproducibility. Default 11. ... Additional arguments passed integration method function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Integration_SCP — Integration_SCP","text":"Seurat object.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Integration_SCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Integration_SCP — Integration_SCP","text":"","code":"data(\"panc8_sub\") panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Uncorrected\" ) #> [2025-09-07 20:33:42.971258] Start Uncorrected_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Uncorrected\",   HVF_min_intersection = 5 ) #> [2025-09-07 20:33:42.973979] Start Uncorrected_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Uncorrected\",   HVF_min_intersection = 5, scale_within_batch = TRUE ) #> [2025-09-07 20:33:42.975278] Start Uncorrected_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Seurat\" ) #> [2025-09-07 20:33:42.976604] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Seurat\",   FindIntegrationAnchors_params = list(reduction = \"rpca\") ) #> [2025-09-07 20:33:42.97822] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  if (FALSE) { # \\dontrun{ integration_methods <- c(   \"Uncorrected\", \"Seurat\", \"scVI\", \"MNN\", \"fastMNN\", \"Harmony\",   \"Scanorama\", \"BBKNN\", \"CSS\", \"LIGER\", \"Conos\", \"ComBat\" ) for (method in integration_methods) {   panc8_sub <- Integration_SCP(     srtMerge = panc8_sub, batch = \"tech\",     integration_method = method,     linear_reduction_dims_use = 1:50,     nonlinear_reduction = \"umap\"   )   print(CellDimPlot(panc8_sub,     group.by = c(\"tech\", \"celltype\"),     reduction = paste0(method, \"UMAP2D\"),     xlab = \"\", ylab = \"\", title = method,     legend.position = \"none\", theme_use = \"theme_blank\"   )) }  nonlinear_reductions <- c(\"umap\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\") panc8_sub <- Integration_SCP(   srtMerge = panc8_sub, batch = \"tech\",   integration_method = \"Seurat\",   linear_reduction_dims_use = 1:50,   nonlinear_reduction = nonlinear_reductions ) for (nr in nonlinear_reductions) {   print(CellDimPlot(panc8_sub,     group.by = c(\"tech\", \"celltype\"),     reduction = paste0(\"Seurat\", nr, \"2D\"),     xlab = \"\", ylab = \"\", title = nr,     legend.position = \"none\", theme_use = \"theme_blank\"   )) } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/IsSeurat5.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if object is Seurat V5 — IsSeurat5","title":"Check if object is Seurat V5 — IsSeurat5","text":"Check object Seurat V5","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/IsSeurat5.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if object is Seurat V5 — IsSeurat5","text":"","code":"IsSeurat5(srt)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/IsSeurat5.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if object is Seurat V5 — IsSeurat5","text":"srt Seurat object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/IsSeurat5.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if object is Seurat V5 — IsSeurat5","text":"Logical indicating object Seurat V5","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LIGER_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"LIGER_integrate — LIGER_integrate","title":"LIGER_integrate — LIGER_integrate","text":"LIGER_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LIGER_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LIGER_integrate — LIGER_integrate","text":"","code":"LIGER_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   LIGER_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   optimizeALS_params = list(),   quantilenorm_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LIGER_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LIGER_integrate — LIGER_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). LIGER_dims_use vector specifying dimensions returned LIGER utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). optimizeALS_params list parameters rliger::optimizeALS function, default empty list. quantilenorm_params list parameters rliger::quantile_norm function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LineagePlot.html","id":null,"dir":"Reference","previous_headings":"","what":"LineagePlot — LineagePlot","title":"LineagePlot — LineagePlot","text":"Generate lineage plot based pseudotime.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LineagePlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LineagePlot — LineagePlot","text":"","code":"LineagePlot(   srt,   lineages,   reduction = NULL,   dims = c(1, 2),   cells = NULL,   trim = c(0.01, 0.99),   span = 0.75,   palette = \"Dark2\",   palcolor = NULL,   lineages_arrow = arrow(length = unit(0.1, \"inches\")),   linewidth = 1,   line_bg = \"white\",   line_bg_stroke = 0.5,   whiskers = FALSE,   whiskers_linewidth = 0.5,   whiskers_alpha = 0.5,   aspect.ratio = 1,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   return_layer = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LineagePlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LineagePlot — LineagePlot","text":"srt object class Seurat. lineages character vector specifies lineages included. Typically, use pseudotime cells. reduction optional string specifying dimensionality reduction method use. dims numeric vector length 2 specifying dimensions plot. cells optional character vector specifying cells include plot. trim numeric vector length 2 specifying quantile range lineages include plot. span numeric value specifying span loess smoother. palette character string specifying color palette use lineages. palcolor optional string specifying color palette. lineages_arrow arrow object specifying arrow lineages. linewidth numeric value specifying linewidth lineages. line_bg character string specifying color background lines. line_bg_stroke numeric value specifying stroke width background lines. whiskers logical value indicating whether include whiskers plot. whiskers_linewidth numeric value specifying linewidth whiskers. whiskers_alpha numeric value specifying transparency whiskers. aspect.ratio numeric value specifying aspect ratio plot. title optional character string specifying plot title. subtitle optional character string specifying plot subtitle. xlab optional character string specifying x-axis label. ylab optional character string specifying y-axis label. legend.position character string specifying position legend. legend.direction character string specifying direction legend. theme_use character string specifying theme use plot. theme_args list additional arguments pass theme function. return_layer logical value indicating whether return plot layer. seed optional integer specifying random seed reproducibility.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/LineagePlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LineagePlot — LineagePlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", show_plot = FALSE) LineagePlot(pancreas_sub, lineages = paste0(\"Lineage\", 1:3))  LineagePlot(pancreas_sub, lineages = paste0(\"Lineage\", 1:3), whiskers = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ListDB.html","id":null,"dir":"Reference","previous_headings":"","what":"ListDB — ListDB","title":"ListDB — ListDB","text":"Retrieves information databases based given species database name.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ListDB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ListDB — ListDB","text":"","code":"ListDB(species = \"Homo_sapiens\", db = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ListDB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ListDB — ListDB","text":"species species retrieve database information. Default \"Homo_sapiens\". db pattern match database names. Default NULL, matches databases.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ListDB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ListDB — ListDB","text":"","code":"ListDB(species = \"Homo_sapiens\") #> NULL ListDB(species = \"Mus_musculus\", db = \"GO_BP\") #> NULL"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/MNN_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"MNN_integrate — MNN_integrate","title":"MNN_integrate — MNN_integrate","text":"MNN_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/MNN_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MNN_integrate — MNN_integrate","text":"","code":"MNN_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   mnnCorrect_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/MNN_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MNN_integrate — MNN_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). mnnCorrect_params list parameters batchelor::mnnCorrect function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PAGAPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"PAGA plot — PAGAPlot","title":"PAGA plot — PAGAPlot","text":"function generates PAGA plot based given Seurat object PAGA result.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PAGAPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PAGA plot — PAGAPlot","text":"","code":"PAGAPlot(   srt,   paga = srt@misc$paga,   type = \"connectivities\",   reduction = NULL,   dims = c(1, 2),   cells = NULL,   show_transition = FALSE,   node_palette = \"Paired\",   node_palcolor = NULL,   node_size = 4,   node_alpha = 1,   node_highlight = NULL,   node_highlight_color = \"red\",   label = FALSE,   label.size = 3.5,   label.fg = \"white\",   label.bg = \"black\",   label.bg.r = 0.1,   label_insitu = FALSE,   label_repel = FALSE,   label_repulsion = 20,   label_point_size = 1,   label_point_color = \"black\",   label_segment_color = \"black\",   edge_threshold = 0.01,   edge_line = c(\"straight\", \"curved\"),   edge_line_curvature = 0.3,   edge_line_angle = 90,   edge_size = c(0.2, 1),   edge_color = \"grey40\",   edge_alpha = 0.5,   edge_shorten = 0,   edge_offset = 0,   edge_highlight = NULL,   edge_highlight_color = \"red\",   transition_threshold = 0.01,   transition_line = c(\"straight\", \"curved\"),   transition_line_curvature = 0.3,   transition_line_angle = 90,   transition_size = c(0.2, 1),   transition_color = \"black\",   transition_alpha = 1,   transition_arrow_type = \"closed\",   transition_arrow_angle = 20,   transition_arrow_length = unit(0.02, \"npc\"),   transition_shorten = 0.05,   transition_offset = 0,   transition_highlight = NULL,   transition_highlight_color = \"red\",   aspect.ratio = 1,   title = \"PAGA\",   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   return_layer = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PAGAPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PAGA plot — PAGAPlot","text":"srt Seurat object containing PAGA result. paga PAGA result Seurat object. Defaults srt\\$misc\\$paga. type type plot generate. Possible values \"connectivities\" (default) \"connectivities_tree\". reduction type reduction use plot. Defaults default reduction Seurat object. dims dimensions reduction use plot. Defaults first two dimensions. cells cells include plot. Defaults cells. show_transition logical value indicating whether display transitions different cell states. Defaults FALSE. node_palette color palette use node coloring. Defaults \"Paired\". node_palcolor vector colors use node coloring. Defaults NULL. node_size size nodes plot. Defaults 4. node_alpha transparency nodes plot. Defaults 1. node_highlight group(s) highlight plot. Defaults NULL. node_highlight_color color use highlighting nodes. Defaults \"red\". label logical value indicating whether display labels nodes. Defaults FALSE. label.size size labels. Defaults 3.5. label.fg color label text. Defaults \"white\". label.bg background color labels. Defaults \"black\". label.bg.r transparency label background color. Defaults 0.1. label_insitu logical value indicating whether use -situ labeling nodes. Defaults FALSE. label_repel logical value indicating whether use repel mode labeling nodes. Defaults FALSE. label_repulsion repulsion factor repel mode. Defaults 20. label_point_size size points labels. Defaults 1. label_point_color color points labels. Defaults \"black\". label_segment_color color lines connecting points labels. Defaults \"black\". edge_threshold threshold including edges plot. Defaults 0.01. edge_line type line use edges. Possible values \"straight\" \"curved\". Defaults \"straight\". edge_line_curvature curvature factor curved edges. Defaults 0.3. edge_line_angle angle curved edges. Defaults 90. edge_size size range edges. Defaults c(0.2, 1). edge_color color edges. Defaults \"grey40\". edge_alpha transparency edges. Defaults 0.5. edge_shorten amount shorten edges. Defaults 0. edge_offset offset curved edges. Defaults 0. edge_highlight group(s) highlight plot. Defaults NULL. edge_highlight_color color use highlighting edges. Defaults \"red\". transition_threshold threshold including transitions plot. Defaults 0.01. transition_line type line use transitions. Possible values \"straight\" \"curved\". Defaults \"straight\". transition_line_curvature curvature factor curved transitions. Defaults 0.3. transition_line_angle angle curved transitions. Defaults 90. transition_size size range transitions. Defaults c(0.2, 1). transition_color color transitions. Defaults \"black\". transition_alpha transparency transitions. Defaults 1. transition_arrow_type type arrow use transitions. Possible values \"closed\", \"open\", \"triangle\". Defaults \"closed\". transition_arrow_angle angle arrow transitions. Defaults 20. transition_arrow_length length arrow transitions. Defaults unit(0.02, \"npc\"). transition_shorten amount shorten transitions. Defaults 0.05. transition_offset offset curved transitions. Defaults 0. transition_highlight group(s) highlight plot. Defaults NULL. transition_highlight_color color use highlighting transitions. Defaults \"red\". aspect.ratio aspect ratio plot. Defaults 1. title title plot. Defaults \"PAGA\". subtitle subtitle plot. Defaults NULL. xlab label x-axis. Defaults NULL. ylab label y-axis. Defaults NULL. legend.position position legend. Possible values \"right\", \"left\", \"bottom\", \"top\". Defaults \"right\". legend.direction direction legend. Possible values \"vertical\" \"horizontal\". Defaults \"vertical\". theme_use name theme use plot. Defaults \"theme_scp\". theme_args list arguments pass theme function. Defaults empty list. return_layer logical value indicating whether return plot ggplot2 layer. Defaults FALSE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PAGAPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"PAGA plot — PAGAPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunPAGA(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", return_seurat = TRUE) #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" PAGAPlot(pancreas_sub) #> Error in PAGAPlot(pancreas_sub): Cannot find the paga result. PAGAPlot(pancreas_sub, type = \"connectivities_tree\") #> Error in PAGAPlot(pancreas_sub, type = \"connectivities_tree\"): Cannot find the paga result. PAGAPlot(pancreas_sub, reduction = \"PCA\") #> Error in PAGAPlot(pancreas_sub, reduction = \"PCA\"): Cannot find the paga result. PAGAPlot(pancreas_sub, reduction = \"PAGAUMAP2D\") #> Error in PAGAPlot(pancreas_sub, reduction = \"PAGAUMAP2D\"): Cannot find the paga result. PAGAPlot(pancreas_sub, edge_shorten = 0.05) #> Error in PAGAPlot(pancreas_sub, edge_shorten = 0.05): Cannot find the paga result. PAGAPlot(pancreas_sub, label = TRUE) #> Error in PAGAPlot(pancreas_sub, label = TRUE): Cannot find the paga result. PAGAPlot(pancreas_sub, label = TRUE, label_insitu = TRUE) #> Error in PAGAPlot(pancreas_sub, label = TRUE, label_insitu = TRUE): Cannot find the paga result. PAGAPlot(pancreas_sub, label = TRUE, label_insitu = TRUE, label_repel = TRUE) #> Error in PAGAPlot(pancreas_sub, label = TRUE, label_insitu = TRUE, label_repel = TRUE): Cannot find the paga result. PAGAPlot(pancreas_sub, edge_line = \"curved\") #> Error in PAGAPlot(pancreas_sub, edge_line = \"curved\"): Cannot find the paga result. PAGAPlot(pancreas_sub, node_size = \"GroupSize\") #> Error in PAGAPlot(pancreas_sub, node_size = \"GroupSize\"): Cannot find the paga result. PAGAPlot(pancreas_sub, node_highlight = \"Ductal\") #> Error in PAGAPlot(pancreas_sub, node_highlight = \"Ductal\"): Cannot find the paga result. PAGAPlot(pancreas_sub, edge_highlight = paste(\"Pre-endocrine\", levels(pancreas_sub$SubCellType), sep = \"-\")) #> Error in PAGAPlot(pancreas_sub, edge_highlight = paste(\"Pre-endocrine\",     levels(pancreas_sub$SubCellType), sep = \"-\")): Cannot find the paga result.  pancreas_sub <- RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", return_seurat = TRUE) #> Python module 'scvelo' is required for velocity analysis but is not installed. #> To install, run: PrepareEnv() and then check_Python('scvelo') #> Error in RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\",     nonlinear_reduction = \"UMAP\", return_seurat = TRUE): Required Python module 'scvelo' is not available. Please install it first. PAGAPlot(pancreas_sub, show_transition = TRUE) #> Error in PAGAPlot(pancreas_sub, show_transition = TRUE): Cannot find the paga result. PAGAPlot(pancreas_sub, show_transition = TRUE, transition_offset = 0.02) #> Error in PAGAPlot(pancreas_sub, show_transition = TRUE, transition_offset = 0.02): Cannot find the paga result."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare the gene annotation databases — PrepareDB","title":"Prepare the gene annotation databases — PrepareDB","text":"function prepares gene annotation databases given species set annotation sources. retrieves necessary information various annotation packages external resources organizes list. list contains annotation data specified annotation source.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare the gene annotation databases — PrepareDB","text":"","code":"PrepareDB(   species = c(\"Homo_sapiens\", \"Mus_musculus\"),   db = c(\"GO\", \"GO_BP\", \"GO_CC\", \"GO_MF\", \"KEGG\", \"WikiPathway\", \"Reactome\", \"CORUM\",     \"MP\", \"DO\", \"HPO\", \"PFAM\", \"CSPA\", \"Surfaceome\", \"SPRomeDB\", \"VerSeDa\", \"TFLink\",     \"hTFtarget\", \"TRRUST\", \"JASPAR\", \"ENCODE\", \"MSigDB\", \"CellTalk\", \"CellChat\",     \"Chromosome\", \"GeneType\", \"Enzyme\", \"TF\"),   db_IDtypes = c(\"symbol\", \"entrez_id\", \"ensembl_id\"),   db_version = \"latest\",   db_update = FALSE,   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   biomart = NULL,   max_tries = 5,   custom_TERM2GENE = NULL,   custom_TERM2NAME = NULL,   custom_species = NULL,   custom_IDtype = NULL,   custom_version = NULL )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare the gene annotation databases — PrepareDB","text":"species character vector specifying species gene annotation databases prepared. Default c(\"Homo_sapiens\", \"Mus_musculus\"). db character vector specifying annotation sources included gene annotation databases. Default c(\"GO\", \"GO_BP\", \"GO_CC\", \"GO_MF\", \"KEGG\", \"WikiPathway\", \"Reactome\", \"CORUM\", \"MP\", \"\", \"HPO\", \"PFAM\", \"CSPA\", \"Surfaceome\", \"SPRomeDB\", \"VerSeDa\", \"TFLink\", \"hTFtarget\", \"TRRUST\", \"JASPAR\", \"ENCODE\", \"MSigDB\", \"CellTalk\", \"CellChat\", \"Chromosome\", \"GeneType\", \"Enzyme\", \"TF\"). db_IDtypes character vector specifying desired ID types used gene identifiers gene annotation databases. Default c(\"symbol\", \"entrez_id\", \"ensembl_id\"). db_version character vector specifying version gene annotation databases retrieved. Default \"latest\". db_update logical value indicating whether gene annotation databases forcefully updated. set FALSE, function attempt load cached databases instead. Default FALSE. convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. biomart name BioMart database want connect . Possible options include \"ensembl\", \"protists_mart\", \"fungi_mart\", \"plants_mart\". max_tries maximum number attempts connect BioMart service. custom_TERM2GENE data frame containing custom TERM2GENE mapping specified species annotation source. Default NULL. custom_TERM2NAME data frame containing custom TERM2NAME mapping specified species annotation source. Default NULL. custom_species character vector specifying species name used custom database. Default NULL. custom_IDtype character vector specifying ID type used custom database. Default NULL. custom_version character vector specifying version used custom database. Default NULL.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare the gene annotation databases — PrepareDB","text":"list containing prepared gene annotation databases: TERM2GENE: mapping gene identifiers terms TERM2NAME: mapping terms names semData: semantic similarity data gene sets (Gene Ontology terms)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare the gene annotation databases — PrepareDB","text":"`PrepareDB` function prepares gene annotation databases given species set annotation sources. retrieves necessary information various annotation packages external resources organizes list. function also supports creating custom databases based user-provided gene sets.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareDB.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare the gene annotation databases — PrepareDB","text":"","code":"if (interactive()) {   db_list <- PrepareDB(species = \"Homo_sapiens\", db = \"GO_BP\")   ListDB(species = \"Homo_sapiens\", db = \"GO_BP\")   head(db_list[[\"Homo_sapiens\"]][[\"GO_BP\"]][[\"TERM2GENE\"]])    # Based on homologous gene conversion, prepare a gene annotation database that originally does not exist in the species.   db_list <- PrepareDB(species = \"Homo_sapiens\", db = \"MP\")   ListDB(species = \"Homo_sapiens\", db = \"MP\")   head(db_list[[\"Homo_sapiens\"]][[\"MP\"]][[\"TERM2GENE\"]])    # Prepare databases for other species   db_list <- PrepareDB(species = \"Macaca_fascicularis\", db = \"GO_BP\")   ListDB(species = \"Macaca_fascicularis\", db = \"GO_BP\")   head(db_list[[\"Macaca_fascicularis\"]][[\"GO_BP\"]][[\"TERM2GENE\"]])    db_list <- PrepareDB(species = \"Saccharomyces_cerevisiae\", db = \"GO_BP\")   ListDB(species = \"Saccharomyces_cerevisiae\", db = \"GO_BP\")   head(db_list[[\"Saccharomyces_cerevisiae\"]][[\"GO_BP\"]][[\"TERM2GENE\"]])    # Prepare databases for Arabidopsis (plant)   db_list <- PrepareDB(     species = \"Arabidopsis_thaliana\",     db = c(       \"GO_BP\", \"GO_CC\", \"GO_MF\", \"KEGG\", \"WikiPathway\",       \"ENZYME\", \"Chromosome\"     ),     biomart = \"plants_mart\"   )   head(db_list[[\"Arabidopsis_thaliana\"]][[\"KEGG\"]][[\"TERM2GENE\"]])    # You can also build a custom database based on the gene sets you have   ccgenes <- CC_GenePrefetch(\"Homo_sapiens\")   custom_TERM2GENE <- rbind(     data.frame(term = \"S_genes\", gene = ccgenes[[\"cc_S_genes\"]]),     data.frame(term = \"G2M_genes\", gene = ccgenes[[\"cc_G2M_genes\"]])   )   str(custom_TERM2GENE)    # Set convert_species = TRUE to build a custom database for both species, with the name \"CellCycle\"   db_list <- PrepareDB(     species = c(\"Homo_sapiens\", \"Mus_musculus\"), db = \"CellCycle\", convert_species = TRUE,     custom_TERM2GENE = custom_TERM2GENE, custom_species = \"Homo_sapiens\", custom_IDtype = \"symbol\", custom_version = \"Seurat_v4\"   )   ListDB(db = \"CellCycle\")    db_list <- PrepareDB(species = \"Mus_musculus\", db = \"CellCycle\")   head(db_list[[\"Mus_musculus\"]][[\"CellCycle\"]][[\"TERM2GENE\"]]) }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareEnv.html","id":null,"dir":"Reference","previous_headings":"","what":"Install the SCP python environment — PrepareEnv","title":"Install the SCP python environment — PrepareEnv","text":"Install python packages SCP environment automatically. environment created using Conda environment.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareEnv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install the SCP python environment — PrepareEnv","text":"","code":"PrepareEnv(   method = \"auto\",   pip = FALSE,   user = FALSE,   force = FALSE,   update = \"all\",   python_version = \"3.10\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareEnv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install the SCP python environment — PrepareEnv","text":"method Installation method. default, \"auto\" automatically find method work local environment. Change default force specific installation method. Note \"virtualenv\" method available Windows. pip Whether use pip installing packages. relevant `conda = \"auto\". user Whether install packages user site library, instead default system site library. Note argument relevant using Conda package manager. relevant `pip = TRUE`. force Force reinstall SCP python environment. update Whether update packages already exist within environment. Note parameter supported Conda package manager. available options \"default\", \"\", \"selected\". \"default\" updates selected packages latest versions specified. \"\" Update packages environment. alternative \"selected\" update selected packages latest versions leaving packages. within environment alone. python_version Python version use SCP environment. Default \"3.10\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareSCExplorer.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Seurat objects for the SCExplorer — PrepareSCExplorer","title":"Prepare Seurat objects for the SCExplorer — PrepareSCExplorer","text":"function prepares one multiple Seurat objects SCExplorer app. takes Seurat object list Seurat objects input outputs two hdf5 files: one data one metadata.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareSCExplorer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Seurat objects for the SCExplorer — PrepareSCExplorer","text":"","code":"PrepareSCExplorer(   object,   base_dir = \"SCExplorer\",   DataFile = \"Data.hdf5\",   MetaFile = \"Meta.hdf5\",   assays = \"RNA\",   slots = c(\"counts\", \"data\"),   ignore_nlevel = 100,   write_tools = FALSE,   write_misc = FALSE,   compression_level = 6,   overwrite = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareSCExplorer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Seurat objects for the SCExplorer — PrepareSCExplorer","text":"object Seurat object list Seurat objects. base_dir base directory SCExplorer hdf5 files written. Default \"SCExplorer\". DataFile Path output data file. provided, file named \"Data.hdf5\" current directory. MetaFile Path output meta file. provided, file named \"Meta.hdf5\" current directory. assays Character vector specifying assays include data file. Default \"RNA\". slots Character vector specifying slots include data file. Default \"data\". ignore_nlevel number levels metadata field ignored. Default 100. write_tools logical value indicating whether write tools information meta file. Default FALSE. write_misc logical value indicating whether write miscellaneous information meta file. Default FALSE. compression_level Compression level HDF5 dataset. Default 6. overwrite Logical value indicating whether overwrite existing data data file. Default FALSE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/PrepareSCExplorer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Seurat objects for the SCExplorer — PrepareSCExplorer","text":"","code":"if (FALSE) { # \\dontrun{ data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) PrepareSCExplorer(pancreas_sub, base_dir = \"./SCExplorer\") } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ProjectionPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Projection Plot — ProjectionPlot","title":"Projection Plot — ProjectionPlot","text":"function generates projection plot, can used compare two groups cells dimensionality reduction space.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ProjectionPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Projection Plot — ProjectionPlot","text":"","code":"ProjectionPlot(   srt_query,   srt_ref,   query_group = NULL,   ref_group = NULL,   query_reduction = \"ref.embeddings\",   ref_reduction = srt_query[[query_reduction]]@misc[[\"reduction.model\"]] %||% NULL,   query_param = list(palette = \"Set1\", cells.highlight = TRUE),   ref_param = list(palette = \"Paired\"),   xlim = NULL,   ylim = NULL,   pt.size = 0.8,   stroke.highlight = 0.5 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ProjectionPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Projection Plot — ProjectionPlot","text":"srt_query object class Seurat storing query group cells. srt_ref object class Seurat storing reference group cells. query_group grouping variable query group cells. ref_group grouping variable reference group cells. query_reduction name reduction query group cells. ref_reduction name reduction reference group cells. query_param list parameters customizing query group plot. Available parameters: palette (color palette groups) cells.highlight (whether highlight cells). ref_param list parameters customizing reference group plot. Available parameters: palette (color palette groups) cells.highlight (whether highlight cells). xlim x-axis limits plot. provided, limits calculated based data. ylim y-axis limits plot. provided, limits calculated based data. pt.size size points plot. stroke.highlight size stroke highlight cells.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ProjectionPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Projection Plot — ProjectionPlot","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"Seurat\") #> [2025-09-07 20:33:50.776011] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunKNNMap(srt_query = srt_query, srt_ref = srt_ref, ref_umap = \"SeuratUMAP2D\") #> Error in srt_ref[[ref_umap]]: ‘SeuratUMAP2D’ not found in this Seurat object #>   ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RecoverCounts.html","id":null,"dir":"Reference","previous_headings":"","what":"Attempt to recover raw counts from the normalized matrix. — RecoverCounts","title":"Attempt to recover raw counts from the normalized matrix. — RecoverCounts","text":"Attempt recover raw counts normalized matrix.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RecoverCounts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Attempt to recover raw counts from the normalized matrix. — RecoverCounts","text":"","code":"RecoverCounts(   srt,   assay = NULL,   trans = c(\"expm1\", \"exp\", \"none\"),   min_count = c(1, 2, 3),   tolerance = 0.1,   sf = NULL,   verbose = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RecoverCounts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Attempt to recover raw counts from the normalized matrix. — RecoverCounts","text":"srt Seurat object. assay Name assay recover counts. trans transformation function applied data presumed log-normalized. min_count Minimum UMI count genes. tolerance recovering raw counts, nCount cell theoretically calculated integer. However, due decimal point preservation normalization, calculated nCount usually floating point number close integer. tolerance difference integer. Default 0.1 sf Set scaling factor manually. verbose Whether show messages.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RecoverCounts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Attempt to recover raw counts from the normalized matrix. — RecoverCounts","text":"","code":"data(\"pancreas_sub\") raw_counts <- pancreas_sub@assays$RNA$counts  # Normalized the data pancreas_sub <- Seurat::NormalizeData(pancreas_sub)  # Now replace counts with the log-normalized data matrix pancreas_sub@assays$RNA$counts <- pancreas_sub@assays$RNA$data  # Recover the counts and compare with the raw counts matrix pancreas_sub <- RecoverCounts(pancreas_sub) #> The presumed scale factor: 3474, 3090, 3614, 3433, 3314, 3235, 2901, 3432, 3267, 3157 #> Warning: Scale factor is not unique. No changes to be made. identical(raw_counts, pancreas_sub@assays$RNA$counts) #> [1] FALSE"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RemoveEnv.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove SCP Python environment — RemoveEnv","title":"Remove SCP Python environment — RemoveEnv","text":"function removes SCP Python environment system. prompt confirmation deletion unless `prompt = FALSE`.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RemoveEnv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove SCP Python environment — RemoveEnv","text":"","code":"RemoveEnv(envname = \"SCP_env\", prompt = TRUE, conda = \"auto\")"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RemoveEnv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove SCP Python environment — RemoveEnv","text":"envname name conda environment remove. Default \"SCP_env\". prompt Whether prompt confirmation removing. Default TRUE. conda path conda executable. Default \"auto\" automatically finds conda.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RemoveEnv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove SCP Python environment — RemoveEnv","text":"NULL (invisibly). Messages indicate success failure.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RemoveEnv.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove SCP Python environment — RemoveEnv","text":"","code":"if (FALSE) { # \\dontrun{ # Remove with confirmation prompt RemoveEnv()  # Remove without prompt RemoveEnv(prompt = FALSE) } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameClusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename clusters for the Seurat object — RenameClusters","title":"Rename clusters for the Seurat object — RenameClusters","text":"Rename clusters Seurat object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameClusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename clusters for the Seurat object — RenameClusters","text":"","code":"RenameClusters(   srt,   group.by,   nameslist = list(),   name = \"newclusters\",   keep_levels = FALSE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameClusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename clusters for the Seurat object — RenameClusters","text":"srt Seurat object. group.old group used rename cells. nameslist named list new cluster value. name name new cluster stored Seurat object. keep_levels old group factor, keep order levels.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameClusters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename clusters for the Seurat object — RenameClusters","text":"","code":"data(\"pancreas_sub\") levels(pancreas_sub@meta.data[[\"SubCellType\"]]) #> [1] \"Ductal\"        \"Ngn3 low EP\"   \"Ngn3 high EP\"  \"Pre-endocrine\" \"Beta\"          \"Alpha\"         \"Delta\"         #> [8] \"Epsilon\"        # Rename all clusters pancreas_sub <- RenameClusters(pancreas_sub, group.by = \"SubCellType\", nameslist = letters[1:8]) CellDimPlot(pancreas_sub, \"newclusters\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Rename specified clusters pancreas_sub <- RenameClusters(pancreas_sub,   group.by = \"SubCellType\",   nameslist = list(\"a\" = \"Alpha\", \"b\" = \"Beta\") ) CellDimPlot(pancreas_sub, \"newclusters\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Merge and rename clusters pancreas_sub <- RenameClusters(pancreas_sub,   group.by = \"SubCellType\",   nameslist = list(\"EndocrineClusters\" = c(\"Alpha\", \"Beta\", \"Epsilon\", \"Delta\")),   name = \"Merged\", keep_levels = TRUE ) CellDimPlot(pancreas_sub, \"Merged\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"Rename features for the Seurat object — RenameFeatures","title":"Rename features for the Seurat object — RenameFeatures","text":"Rename features Seurat object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rename features for the Seurat object — RenameFeatures","text":"","code":"RenameFeatures(srt, newnames = NULL, assays = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Rename features for the Seurat object — RenameFeatures","text":"srt Seurat object. newnames vector length features Seurat object, characters named old features. assays Assays rename.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RenameFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Rename features for the Seurat object — RenameFeatures","text":"","code":"data(\"panc8_sub\") head(rownames(panc8_sub)) #> [1] \"A1BG\"   \"A1CF\"   \"A2M\"    \"A4GALT\" \"AAAS\"   \"AACS\"   # Simply convert genes from human to mouse and preprocess the data genenames <- make.unique(capitalize(rownames(panc8_sub), force_tolower = TRUE)) #> Error in capitalize(rownames(panc8_sub), force_tolower = TRUE): could not find function \"capitalize\" panc8_rename <- RenameFeatures(panc8_sub, newnames = genenames) #> Error: object 'genenames' not found head(rownames(panc8_rename)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'head': error in evaluating the argument 'x' in selecting a method for function 'rownames': object 'panc8_rename' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunALRA.html","id":null,"dir":"Reference","previous_headings":"","what":"Run ALRA imputation — RunALRA","title":"Run ALRA imputation — RunALRA","text":"function performs ALRA (Adaptively-thresholded Low Rank Approximation) imputation gene expression matrix.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunALRA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run ALRA imputation — RunALRA","text":"","code":"RunALRA(data_mat, k = NULL, q = 0.01, verbose = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunALRA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run ALRA imputation — RunALRA","text":"data_mat Expression matrix genes rows cells columns k Number dimensions SVD (default: NULL, automatically determined) q Quantile automatic k selection (default: 0.01) verbose Print progress messages","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunALRA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run ALRA imputation — RunALRA","text":"Imputed expression matrix","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCSSMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell reference mapping with CSS method — RunCSSMap","title":"Single-cell reference mapping with CSS method — RunCSSMap","text":"Single-cell reference mapping CSS method","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCSSMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell reference mapping with CSS method — RunCSSMap","text":"","code":"RunCSSMap(   srt_query,   srt_ref,   query_assay = NULL,   ref_assay = srt_ref[[ref_css]]@assay.used,   ref_css = NULL,   ref_umap = NULL,   ref_group = NULL,   projection_method = c(\"model\", \"knn\"),   nn_method = NULL,   k = 30,   distance_metric = \"cosine\",   vote_fun = \"mean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCSSMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-cell reference mapping with CSS method — RunCSSMap","text":"srt_query object class Seurat storing query cells. srt_ref object class Seurat storing reference cells. query_assay character string specifying assay name query cells. provided, default assay query object used. ref_assay character string specifying assay name reference cells. provided, default assay reference object used. ref_css character string specifying name CSS reduction reference object use calculating distance metric. ref_umap character string specifying name UMAP reduction reference object. provided, first UMAP reduction found reference object used. ref_group character string specifying metadata column name reference object use grouping. projection_method character string specifying projection method use. Options \"model\" \"knn\". \"model\" selected, function try use pre-trained UMAP model reference object projection. \"knn\" selected, function directly find nearest neighbors using distance metric. nn_method character string specifying nearest neighbor search method use. Options \"raw\", \"annoy\", \"rann\". \"raw\" selected, function use brute-force method find nearest neighbors. \"annoy\" selected, function use Annoy library approximate nearest neighbor search. \"rann\" selected, function use RANN library approximate nearest neighbor search. provided, function choose search method based size query reference datasets. k integer specifying number nearest neighbors find cell query object. distance_metric character string specifying distance metric use calculating pairwise distances cells. Options include: \"pearson\", \"spearman\", \"cosine\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". Additional distance metrics can also used, \"euclidean\", \"manhattan\", \"hamming\", etc. vote_fun character string specifying function used aggregating nearest neighbors reference object. Options \"mean\", \"median\", \"sum\", \"min\", \"max\", \"sd\", \"var\", etc. provided, default \"mean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCSSMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-cell reference mapping with CSS method — RunCSSMap","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"CSS\") #> [2025-09-07 20:33:57.752679] Start CSS_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunCSSMap(srt_query = srt_query, srt_ref = srt_ref, ref_css = \"CSS\", ref_umap = \"CSSUMAP2D\") #> Error in check_R(\"quadbiolab/simspec\"): could not find function \"check_R\" ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCellQC.html","id":null,"dir":"Reference","previous_headings":"","what":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","title":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","text":"function handles multiple quality control methods single-cell RNA-seq data.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCellQC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","text":"","code":"RunCellQC(   srt,   assay = \"RNA\",   split.by = NULL,   return_filtered = FALSE,   qc_metrics = c(\"doublets\", \"outlier\", \"umi\", \"gene\", \"mito\", \"ribo\", \"ribo_mito_ratio\",     \"species\"),   db_method = \"scDblFinder\",   db_rate = NULL,   db_coefficient = 0.01,   outlier_threshold = c(\"log10_nCount:lower:2.5\", \"log10_nCount:higher:5\",     \"log10_nFeature:lower:2.5\", \"log10_nFeature:higher:5\", \"featurecount_dist:lower:2.5\"),   outlier_n = 1,   UMI_threshold = 3000,   gene_threshold = 1000,   mito_threshold = 20,   mito_pattern = c(\"MT-\", \"Mt-\", \"mt-\"),   mito_gene = NULL,   ribo_threshold = 50,   ribo_pattern = c(\"RP[SL]\\\\d+\\\\w{0,1}\\\\d*$\", \"Rp[sl]\\\\d+\\\\w{0,1}\\\\d*$\",     \"rp[sl]\\\\d+\\\\w{0,1}\\\\d*$\"),   ribo_gene = NULL,   ribo_mito_ratio_range = c(1, Inf),   species = NULL,   species_gene_prefix = NULL,   species_percent = 95,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCellQC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". split.Name sample variable split Seurat object. Default NULL. return_filtered Logical indicating whether return cell-filtered Seurat object. Default FALSE. qc_metrics character vector specifying quality control metrics applied. Default `c(\"doublets\", \"outlier\", \"umi\", \"gene\", \"mito\", \"ribo\", \"ribo_mito_ratio\", \"species\")`. db_method Doublet-calling methods used. Can one scDblFinder, Scrublet, DoubletDetection, scds_cxds, scds_bcds, scds_hybrid db_rate expected doublet rate. default assumed 1% per thousand cells captured (4% among 4000 thousand cells), appropriate 10x datasets. db_coefficient coefficient used calculate doublet rate. Default 0.01. Doublet rate calculated `ncol(srt) / 1000 * db_coefficient` outlier_threshold character vector specifying outlier threshold. Default `c(\"log10_nCount:lower:2.5\", \"log10_nCount:higher:5\", \"log10_nFeature:lower:2.5\", \"log10_nFeature:higher:5\", \"featurecount_dist:lower:2.5\")`. See isOutlier. outlier_n Minimum number outlier metrics meet conditions determining outlier cells. Default 1. UMI_threshold UMI number threshold. Cells exceed threshold considered kept. Default 3000. gene_threshold Gene number threshold. Cells exceed threshold considered kept. Default 1000. mito_threshold Percentage UMI counts mitochondrial genes. Cells exceed threshold considered discarded. Default 20. mito_pattern Regex patterns match mitochondrial genes. Default `c(\"MT-\", \"Mt-\", \"mt-\")`. mito_gene defined mitochondrial genes. features provided, ignore mito_pattern matching. Default NULL. ribo_threshold Percentage UMI counts ribosomal genes. Cells exceed threshold considered discarded. Default 50. ribo_pattern Regex patterns match ribosomal genes. Default `c(\"RP[SL]\\d+\\w0,1\\d*$\", \"Rp[sl]\\d+\\w0,1\\d*$\", \"rp[sl]\\d+\\w0,1\\d*$\")`. ribo_gene defined ribosomal genes. features provided, ignore ribo_pattern matching. Default NULL. ribo_mito_ratio_range numeric vector specifying range ribosomal/mitochondrial gene expression ratios ribo_mito_ratio outlier cells. Default c(1, Inf). species Species used suffix QC metrics. first species interest. Default NULL. species_gene_prefix Species gene prefix used calculate QC metrics species. Default NULL. species_percent Percentage UMI counts first species. Cells exceed threshold considered kept. Default 95. seed Set random seed. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCellQC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","text":"Returns Seurat object QC results stored meta.data layer.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunCellQC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run cell-level quality control for single cell RNA-seq data. — RunCellQC","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunCellQC(pancreas_sub) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellStatPlot(   srt = pancreas_sub,   stat.by = c(     \"db_qc\", \"outlier_qc\", \"umi_qc\", \"gene_qc\",     \"mito_qc\", \"ribo_qc\", \"ribo_mito_ratio_qc\", \"species_qc\"   ),   plot_type = \"upset\", stat_level = \"Fail\" ) #> Error in StatPlot(meta.data = meta.data, stat.by = stat.by, group.by = group.by,     split.by = split.by, bg.by = bg.by, flip = flip, NA_color = NA_color,     NA_stat = NA_stat, keep_empty = keep_empty, individual = individual,     stat_level = stat_level, plot_type = plot_type, stat_type = stat_type,     position = position, palette = palette, palcolor = palcolor,     alpha = alpha, bg_palette = bg_palette, bg_palcolor = bg_palcolor,     bg_alpha = bg_alpha, label = label, label.size = label.size,     label.fg = label.fg, label.bg = label.bg, label.bg.r = label.bg.r,     aspect.ratio = aspect.ratio, title = title, subtitle = subtitle,     xlab = xlab, ylab = ylab, legend.position = legend.position,     legend.direction = legend.direction, theme_use = theme_use,     theme_args = theme_args, combine = combine, nrow = nrow,     ncol = ncol, byrow = byrow, force = force, seed = seed): db_qc is not in the meta.data. table(pancreas_sub$CellQC) #> Error in x[[i, drop = TRUE]]: ‘CellQC’ not found in this Seurat object #>  Did you mean \"CellType\"?  data(\"ifnb_sub\") ifnb_sub <- RunCellQC(ifnb_sub, split.by = \"stim\", UMI_threshold = 1000, gene_threshold = 550) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellStatPlot(   srt = ifnb_sub,   stat.by = c(     \"db_qc\", \"outlier_qc\", \"umi_qc\", \"gene_qc\",     \"mito_qc\", \"ribo_qc\", \"ribo_mito_ratio_qc\", \"species_qc\"   ),   plot_type = \"upset\", stat_level = \"Fail\" ) #> Error in StatPlot(meta.data = meta.data, stat.by = stat.by, group.by = group.by,     split.by = split.by, bg.by = bg.by, flip = flip, NA_color = NA_color,     NA_stat = NA_stat, keep_empty = keep_empty, individual = individual,     stat_level = stat_level, plot_type = plot_type, stat_type = stat_type,     position = position, palette = palette, palcolor = palcolor,     alpha = alpha, bg_palette = bg_palette, bg_palcolor = bg_palcolor,     bg_alpha = bg_alpha, label = label, label.size = label.size,     label.fg = label.fg, label.bg = label.bg, label.bg.r = label.bg.r,     aspect.ratio = aspect.ratio, title = title, subtitle = subtitle,     xlab = xlab, ylab = ylab, legend.position = legend.position,     legend.direction = legend.direction, theme_use = theme_use,     theme_args = theme_args, combine = combine, nrow = nrow,     ncol = ncol, byrow = byrow, force = force, seed = seed): db_qc is not in the meta.data. table(ifnb_sub$CellQC) #> Error in x[[i, drop = TRUE]]: ‘CellQC’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDEtest.html","id":null,"dir":"Reference","previous_headings":"","what":"Differential gene test — RunDEtest","title":"Differential gene test — RunDEtest","text":"function utilizes Seurat package perform differential expression (DE) test gene expression data. Users flexibility specify custom cell groups, marker types, various options DE analysis.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDEtest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Differential gene test — RunDEtest","text":"","code":"RunDEtest(   srt,   group_by = NULL,   group1 = NULL,   group2 = NULL,   cells1 = NULL,   cells2 = NULL,   features = NULL,   markers_type = c(\"all\", \"paired\", \"conserved\", \"disturbed\"),   grouping.var = NULL,   meta.method = c(\"maximump\", \"minimump\", \"wilkinsonp\", \"meanp\", \"sump\", \"votep\"),   test.use = \"wilcox\",   only.pos = TRUE,   fc.threshold = 1.5,   base = 2,   pseudocount.use = 1,   mean.fxn = NULL,   min.pct = 0.1,   min.diff.pct = -Inf,   max.cells.per.ident = Inf,   latent.vars = NULL,   min.cells.feature = 3,   min.cells.group = 3,   norm.method = \"LogNormalize\",   p.adjust.method = \"bonferroni\",   slot = \"data\",   assay = NULL,   BPPARAM = BiocParallel::bpparam(),   seed = 11,   verbose = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDEtest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Differential gene test — RunDEtest","text":"srt Seurat object. group_by grouping variable dataset define groups conditions differential test. provided, function uses \"active.ident\" variable Seurat object. group1 vector cell IDs character vector specifying cells belong first group. group_by group1 provided, group1 takes precedence. group2 vector cell IDs character vector specifying cells belong second group. parameter used group_by group1 provided. cells1 vector cell IDs specifying cells belong group1. provided, group1 ignored. cells2 vector cell IDs specifying cells belong group2. parameter used cells1 provided. features vector gene names specifying features consider differential test. provided, features dataset considered. markers_type character value specifying type markers find. Possible values \"\", \"paired\", \"conserved\", \"disturbed\". grouping.var character value specifying grouping variable finding conserved disturbed markers. parameter used markers_type \"conserved\" \"disturbed\". meta.method character value specifying method use combining p-values conserved markers test. Possible values \"maximump\", \"minimump\", \"wilkinsonp\", \"meanp\", \"sump\", \"votep\". test.use Denotes test use. Available options : \"wilcox\" : Identifies differentially expressed genes two  groups cells using Wilcoxon Rank Sum test (default); use fast  implementation Presto installed \"wilcox_limma\" : Identifies differentially expressed genes two  groups cells using limma implementation Wilcoxon Rank Sum test;  set option reproduce results Seurat v4 \"bimod\" : Likelihood-ratio test single cell gene expression,  (McDavid et al., Bioinformatics, 2013) \"roc\" : Identifies 'markers' gene expression using ROC analysis.  gene, evaluates (using AUC) classifier built gene alone,  classify two groups cells. AUC value 1 means  expression values gene alone can perfectly classify two  groupings (.e. cells cells.1 exhibit higher level  cells cells.2). AUC value 0 also means perfect  classification, direction. value 0.5 implies  gene predictive power classify two groups. Returns  'predictive power' (abs(AUC-0.5) * 2) ranked matrix putative differentially  expressed genes. \"t\" : Identify differentially expressed genes two groups  cells using Student's t-test. \"negbinom\" : Identifies differentially expressed genes two   groups cells using negative binomial generalized linear model.   Use UMI-based datasets \"poisson\" : Identifies differentially expressed genes two   groups cells using poisson generalized linear model.   Use UMI-based datasets \"LR\" : Uses logistic regression framework determine differentially  expressed genes. Constructs logistic regression model predicting group  membership based feature individually compares null  model likelihood ratio test. \"MAST\" : Identifies differentially expressed genes two groups  cells using hurdle model tailored scRNA-seq data. Utilizes MAST  package run DE testing. \"DESeq2\" : Identifies differentially expressed genes two groups  cells based model using DESeq2 uses negative binomial  distribution (Love et al, Genome Biology, 2014).test support  pre-filtering genes based average difference (percent detection rate)  cell groups. However, genes may pre-filtered based  minimum detection rate (min.pct) across cell groups. use method,  please install DESeq2, using instructions  https://bioconductor.org/packages/release/bioc/html/DESeq2.html .pos return positive markers (FALSE default) fc.threshold numeric value used filter genes testing based average fold change /among two groups. default, set 1.5 base base respect logarithms computed. pseudocount.use Pseudocount add averaged expression values calculating logFC. 1 default. mean.fxn Function use fold change average difference calculation. default depends value fc.slot: \"counts\" : difference log mean counts, pseudocount. \"data\" : difference log average exponentiated data, pseudocount.  adjusts differences sequencing depth cells, assumes \"data\"  log-normalized. \"scale.data\" : difference means scale.data. min.pct test genes detected minimum fraction min.pct cells either two populations. Meant speed function testing genes infrequently expressed. Default 0.01 min.diff.pct test genes show minimum difference fraction detection two groups. Set -Inf default max.cells.per.ident sample identity class max number. Default downsampling. activated default (set Inf) latent.vars Variables test, used test.use one 'LR', 'negbinom', 'poisson', 'MAST' min.cells.feature Minimum number cells expressing feature least one two groups, currently used poisson negative binomial tests min.cells.group Minimum number cells one groups norm.method Normalization method fold change calculation slot 'data'. Default \"LogNormalize\". p.adjust.method character value specifying method use adjusting p-values. Default \"bonferroni\". slot Slot pull data ; note test.use \"negbinom\", \"poisson\", \"DESeq2\", slot set \"counts\" assay Assay use differential expression testing BPPARAM BiocParallelParam object specifying parallelization parameters differential test. Default BiocParallel::bpparam(). seed integer value specifying seed. Default 11. verbose logical value indicating whether display progress messages differential test. Default TRUE. ... Additional arguments pass FindMarkers function.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDEtest.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Differential gene test — RunDEtest","text":"","code":"library(dplyr) data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"SubCellType\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector AllMarkers <- filter(pancreas_sub@tools$DEtest_SubCellType$AllMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" table(AllMarkers$group1) #> Error: object 'AllMarkers' not found ht1 <- GroupHeatmap(pancreas_sub, features = AllMarkers$gene, feature_split = AllMarkers$group1, group.by = \"SubCellType\") #> Error: object 'AllMarkers' not found ht1$plot #> Error: object 'ht1' not found  TopMarkers <- AllMarkers %>%   group_by(gene) %>%   top_n(1, avg_log2FC) %>%   group_by(group1) %>%   top_n(3, avg_log2FC) #> Error: object 'AllMarkers' not found ht2 <- GroupHeatmap(pancreas_sub, features = TopMarkers$gene, feature_split = TopMarkers$group1, group.by = \"SubCellType\", show_row_names = TRUE) #> Error: object 'TopMarkers' not found ht2$plot #> Error: object 'ht2' not found  pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"SubCellType\", markers_type = \"paired\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector PairedMarkers <- filter(pancreas_sub@tools$DEtest_SubCellType$PairedMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" table(PairedMarkers$group1) #> Error: object 'PairedMarkers' not found ht3 <- GroupHeatmap(pancreas_sub, features = PairedMarkers$gene, feature_split = PairedMarkers$group1, group.by = \"SubCellType\") #> Error: object 'PairedMarkers' not found ht3$plot #> Error: object 'ht3' not found  data(\"panc8_sub\") panc8_sub <- Integration_SCP(panc8_sub, batch = \"tech\", integration_method = \"Seurat\") #> [2025-09-07 20:34:04.063412] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(panc8_sub, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  panc8_sub <- RunDEtest(panc8_sub, group_by = \"celltype\", grouping.var = \"tech\", markers_type = \"conserved\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector ConservedMarkers1 <- filter(panc8_sub@tools$DEtest_celltype$ConservedMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" table(ConservedMarkers1$group1) #> Error: object 'ConservedMarkers1' not found ht4 <- GroupHeatmap(panc8_sub,   slot = \"data\",   features = ConservedMarkers1$gene, feature_split = ConservedMarkers1$group1,   group.by = \"tech\", split.by = \"celltype\", within_groups = TRUE ) #> Error: object 'ConservedMarkers1' not found ht4$plot #> Error: object 'ht4' not found  panc8_sub <- RunDEtest(panc8_sub, group_by = \"tech\", grouping.var = \"celltype\", markers_type = \"conserved\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector ConservedMarkers2 <- filter(panc8_sub@tools$DEtest_tech$ConservedMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" table(ConservedMarkers2$group1) #> Error: object 'ConservedMarkers2' not found ht4 <- GroupHeatmap(panc8_sub,   slot = \"data\",   features = ConservedMarkers2$gene, feature_split = ConservedMarkers2$group1,   group.by = \"tech\", split.by = \"celltype\" ) #> Error: object 'ConservedMarkers2' not found ht4$plot #> Error: object 'ht4' not found  panc8_sub <- RunDEtest(panc8_sub, group_by = \"celltype\", grouping.var = \"tech\", markers_type = \"disturbed\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector DisturbedMarkers <- filter(panc8_sub@tools$DEtest_celltype$DisturbedMarkers_wilcox, p_val_adj < 0.05 & avg_log2FC > 1 & var1 == \"smartseq2\") #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" table(DisturbedMarkers$group1) #> Error: object 'DisturbedMarkers' not found ht5 <- GroupHeatmap(panc8_sub,   slot = \"data\",   features = DisturbedMarkers$gene, feature_split = DisturbedMarkers$group1,   group.by = \"celltype\", split.by = \"tech\" ) #> Error: object 'DisturbedMarkers' not found ht5$plot #> Error: object 'ht5' not found  gene_specific <- names(which(table(DisturbedMarkers$gene) == 1)) #> Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'which': object 'DisturbedMarkers' not found DisturbedMarkers_specific <- DisturbedMarkers[DisturbedMarkers$gene %in% gene_specific, ] #> Error: object 'DisturbedMarkers' not found table(DisturbedMarkers_specific$group1) #> Error: object 'DisturbedMarkers_specific' not found ht6 <- GroupHeatmap(panc8_sub,   slot = \"data\",   features = DisturbedMarkers_specific$gene, feature_split = DisturbedMarkers_specific$group1,   group.by = \"celltype\", split.by = \"tech\" ) #> Error: object 'DisturbedMarkers_specific' not found ht6$plot #> Error: object 'ht6' not found  ht7 <- GroupHeatmap(panc8_sub,   slot = \"data\", aggregate_fun = function(x) mean(expm1(x)) + 1,   features = DisturbedMarkers_specific$gene, feature_split = DisturbedMarkers_specific$group1,   group.by = \"celltype\", grouping.var = \"tech\", numerator = \"smartseq2\" ) #> Error: object 'DisturbedMarkers_specific' not found ht7$plot #> Error: object 'ht7' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDM.html","id":null,"dir":"Reference","previous_headings":"","what":"Run DM (diffusion map) — RunDM","title":"Run DM (diffusion map) — RunDM","text":"Run DM (diffusion map)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run DM (diffusion map) — RunDM","text":"","code":"RunDM(object, ...)  # S3 method for class 'Seurat' RunDM(   object,   reduction = \"pca\",   dims = 1:30,   features = NULL,   assay = NULL,   layer = \"data\",   ndcs = 2,   sigma = \"local\",   k = 30,   dist.method = \"euclidean\",   reduction.name = \"dm\",   reduction.key = \"DM_\",   verbose = TRUE,   seed.use = 11,   ... )  # Default S3 method RunDM(   object,   assay = NULL,   layer = \"data\",   ndcs = 2,   sigma = \"local\",   k = 30,   dist.method = \"euclidean\",   reduction.key = \"DM_\",   verbose = TRUE,   seed.use = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run DM (diffusion map) — RunDM","text":"object object. can Seurat object matrix-like object. ... Additional arguments passed DiffusionMap function. reduction character string specifying reduction used. dims integer vector specifying dimensions used. Default 1:30. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". ndcs integer specifying number diffusion components (dimensions) computed. Default 2. sigma character string specifying diffusion scale parameter Gaussian kernel. Currently supported values \"local\" (default) \"global\". k integer specifying number nearest neighbors used construction graph. Default 30. dist.method character string specifying distance metric used construction knn graph. Currently supported values \"euclidean\" \"cosine\". Default \"euclidean\". reduction.name character string specifying name reduction stored Seurat object. Default \"dm\". reduction.key character string specifying prefix column names basis vectors. Default \"DM_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run DM (diffusion map) — RunDM","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunDM(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> Error in check_R(\"destiny\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"dm\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDimReduction.html","id":null,"dir":"Reference","previous_headings":"","what":"Run dimensionality reduction — RunDimReduction","title":"Run dimensionality reduction — RunDimReduction","text":"Run dimensionality reduction","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDimReduction.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run dimensionality reduction — RunDimReduction","text":"","code":"RunDimReduction(   srt,   prefix = \"\",   features = NULL,   assay = NULL,   layer = \"data\",   linear_reduction = NULL,   linear_reduction_dims = 50,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = NULL,   nonlinear_reduction_dims = 2,   reduction_use = NULL,   reduction_dims = NULL,   graph_use = NULL,   neighbor_use = NULL,   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   verbose = TRUE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDimReduction.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run dimensionality reduction — RunDimReduction","text":"srt Seurat object. prefix prefix used name result. features Use features expression data run linear nonlinear dimensionality reduction. assay Specific assay get data . layer Specific layer get data . linear_reduction Method linear dimensionality reduction. Options \"pca\", \"ica\", \"nmf\", \"mds\", \"glmpca\". linear_reduction_dims Total number dimensions compute store linear_reduction. linear_reduction_params parameters passed linear_reduction method. force_linear_reduction Whether force linear dimensionality reduction. nonlinear_reduction Method nonlinear dimensionality reduction. Options \"umap\", \"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\" nonlinear_reduction_dims Total number dimensions compute store nonlinear_reduction. reduction_use dimensional reduction use input nonlinear_reduction. reduction_dims dimensions use input nonlinear_reduction, used features NULL. graph_use Name graph use nonlinear_reduction. neighbor_use Name neighbor use nonlinear_reduction. nonlinear_reduction_params parameters passed nonlinear_reduction method. force_nonlinear_reduction Whether force nonlinear dimensionality reduction. verbose Show messages. seed Set seed.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDoubletCalling.html","id":null,"dir":"Reference","previous_headings":"","what":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","title":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","text":"Identification heterotypic (neotypic) doublets single-cell RNAseq data.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDoubletCalling.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","text":"","code":"RunDoubletCalling(   srt,   assay = \"RNA\",   db_method = \"scDblFinder\",   db_rate = ncol(srt)/1000 * 0.01,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDoubletCalling.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". db_method Doublet-calling methods used. Can one scDblFinder, Scrublet, DoubletDetection, scds_cxds, scds_bcds, scds_hybrid db_rate expected doublet rate. default assumed 1% per thousand cells captured (4% among 4000 thousand cells), appropriate 10x datasets. ... Arguments passed corresponding doublet-calling method.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDoubletCalling.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","text":"Returns Seurat object doublet prediction results prediction scores stored meta.data layer.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDoubletCalling.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run doublet-calling for single cell RNA-seq data. — RunDoubletCalling","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDoubletCalling(pancreas_sub, db_method = \"scDblFinder\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scDblFinder_class\") #> Error in CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scDblFinder_class\"): db.scDblFinder_class is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scDblFinder_score\") #> Warning: db.scDblFinder_score are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scDblFinder_score\"): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"RunDynamicEnrichment — RunDynamicEnrichment","title":"RunDynamicEnrichment — RunDynamicEnrichment","text":"function calculates gene-set scores specified database (db) lineage using specified scoring method (score_method). treats scores expression values uses input RunDynamicFeatures function identify dynamically enriched terms along lineage.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RunDynamicEnrichment — RunDynamicEnrichment","text":"","code":"RunDynamicEnrichment(   srt,   lineages,   score_method = \"AUCell\",   slot = \"data\",   assay = NULL,   min_expcells = 20,   r.sq = 0.2,   dev.expl = 0.2,   padjust = 0.05,   IDtype = \"symbol\",   species = \"Homo_sapiens\",   db = \"GO_BP\",   db_update = FALSE,   db_version = \"latest\",   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   BPPARAM = BiocParallel::bpparam(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RunDynamicEnrichment — RunDynamicEnrichment","text":"srt Seurat object containing results differential expression analysis (RunDEtest). specified, genes groups extracted Seurat object automatically. specified, geneID geneID_groups arguments must provided. lineages character vector specifying lineages plot. score_method method use scoring. Can \"Seurat\", \"AUCell\", \"UCell\". Defaults \"Seurat\". slot character vector specifying slot Seurat object use. Default \"counts\". assay character vector specifying assay Seurat object use. Default NULL. min_expcells numeric value specifying minimum number expected cells. Default 20. r.sq numeric value specifying R-squared threshold. Default 0.2. dev.expl numeric value specifying deviance explained threshold. Default 0.2. padjust numeric value specifying p-value adjustment threshold. Default 0.05. IDtype character vector specifying type gene IDs srt object geneID argument. argument used convert gene IDs different type IDtype different result_IDtype. species character vector specifying species analysis performed. db character vector specifying name database used enrichment analysis. db_update logical value indicating whether gene annotation databases forcefully updated. set FALSE, function attempt load cached databases instead. Default FALSE. db_version character vector specifying version database used. argument ignored db_update TRUE. Default \"latest\". convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. TERM2GENE data frame specifying gene-term mapping custom database. first column contain term IDs, second column contain gene IDs. TERM2NAME data frame specifying term-name mapping custom database. first column contain term IDs, second column contain corresponding term names. minGSSize numeric value specifying minimum size gene set considered enrichment analysis. maxGSSize numeric value specifying maximum size gene set considered enrichment analysis. BPPARAM BiocParallelParam object specifying parallel back-end used parallel computation. Defaults BiocParallel::bpparam(). seed random seed reproducibility. Defaults 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicEnrichment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RunDynamicEnrichment — RunDynamicEnrichment","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. pancreas_sub <- RunDynamicFeatures(pancreas_sub, lineages = \"Lineage1\", n_candidates = 200) #> [2025-09-07 20:34:14.510821] Start RunDynamicFeatures #> Workers: 2 #> Error in check_R(\"mgcv\"): could not find function \"check_R\" ht1 <- DynamicHeatmap(   srt = pancreas_sub,   lineages = \"Lineage1\",   cell_annotation = \"SubCellType\",   n_split = 4 ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = \"Lineage1\", cell_annotation = \"SubCellType\",     n_split = 4): lineages: Lineage1 is not in the meta data of the Seurat object ht1$plot #> Error: object 'ht1' not found  pancreas_sub <- RunDynamicEnrichment(   srt = pancreas_sub,   lineages = \"Lineage1\",   score_method = \"AUCell\",   db = \"GO_BP\",   species = \"Mus_musculus\" ) #> [2025-09-07 20:34:14.514509] Start RunDynamicFeatures #> Workers: 2 #> Error in RunDynamicEnrichment(srt = pancreas_sub, lineages = \"Lineage1\",     score_method = \"AUCell\", db = \"GO_BP\", species = \"Mus_musculus\"): Lineage1 info not found in the srt object. Should perform RunDynamicFeatures first! ht2 <- DynamicHeatmap(   srt = pancreas_sub,   assay = \"GO_BP\",   lineages = \"Lineage1_GO_BP\",   cell_annotation = \"SubCellType\",   n_split = 4,   split_method = \"kmeans-peaktime\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, assay = \"GO_BP\", lineages = \"Lineage1_GO_BP\",     cell_annotation = \"SubCellType\", n_split = 4, split_method = \"kmeans-peaktime\"): lineages: Lineage1_GO_BP is not in the meta data of the Seurat object ht2$plot #> Error: object 'ht2' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicFeatures.html","id":null,"dir":"Reference","previous_headings":"","what":"RunDynamicFeatures — RunDynamicFeatures","title":"RunDynamicFeatures — RunDynamicFeatures","text":"Calculates dynamic features lineages single-cell RNA-seq dataset.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicFeatures.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RunDynamicFeatures — RunDynamicFeatures","text":"","code":"RunDynamicFeatures(   srt,   lineages,   features = NULL,   suffix = lineages,   n_candidates = 1000,   minfreq = 5,   family = NULL,   slot = \"counts\",   assay = NULL,   libsize = NULL,   BPPARAM = BiocParallel::bpparam(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicFeatures.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RunDynamicFeatures — RunDynamicFeatures","text":"srt Seurat object. lineages character vector specifying lineage names dynamic features calculated. features character vector specifying features (genes metadata variables) dynamic features calculated. NULL, n_candidates must provided. suffix character vector specifying suffix append output slot names lineage. Defaults lineage names. n_candidates integer specifying number candidate features select features NULL. Defaults 1000. minfreq integer specifying minimum frequency threshold candidate features. Features frequency less minfreq excluded. Defaults 5. family character character vector specifying family distributions use generalized additive models (GAMs). family set NULL, appropriate family automatically determined based data. length(family) 1, family used features. Otherwise, family must length features. slot character vector specifying slot Seurat object use. Default \"counts\". assay character vector specifying assay Seurat object use. Default NULL. libsize numeric numeric vector specifying library size correction factors cell. NULL, library size correction factors calculated based expression matrix. length(libsize) 1, value used cells. Otherwise, libsize must length number cells srt. Defaults NULL. BPPARAM BiocParallelParam object specifying parallelization parameters computing dynamic features. Defaults BiocParallel::bpparam(). seed integer specifying seed random number generation. Defaults 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicFeatures.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"RunDynamicFeatures — RunDynamicFeatures","text":"Returns modified Seurat object calculated dynamic features stored tools slot.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunDynamicFeatures.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RunDynamicFeatures — RunDynamicFeatures","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. pancreas_sub <- RunDynamicFeatures(pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"), n_candidates = 200) #> [2025-09-07 20:34:17.367034] Start RunDynamicFeatures #> Workers: 2 #> Error in check_R(\"mgcv\"): could not find function \"check_R\" names(pancreas_sub@tools$DynamicFeatures_Lineage1) #> NULL head(pancreas_sub@tools$DynamicFeatures_Lineage1$DynamicFeatures) #> NULL ht <- DynamicHeatmap(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   cell_annotation = \"SubCellType\",   n_split = 6, reverse_ht = \"Lineage1\" ) #> Error in DynamicHeatmap(srt = pancreas_sub, lineages = c(\"Lineage1\", \"Lineage2\"),     cell_annotation = \"SubCellType\", n_split = 6, reverse_ht = \"Lineage1\"): lineages: Lineage1 is not in the meta data of the Seurat object ht$plot #> Error: object 'ht' not found  DynamicPlot(   srt = pancreas_sub,   lineages = c(\"Lineage1\", \"Lineage2\"),   features = c(\"Nnat\", \"Irx1\"),   group.by = \"SubCellType\",   compare_lineages = TRUE,   compare_features = FALSE ) #> Error in check_R(\"MatrixGenerics\"): could not find function \"check_R\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunEnrichment.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","title":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","text":"Perform enrichment analysis (-representation) genes","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunEnrichment.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","text":"","code":"RunEnrichment(   srt = NULL,   group_by = NULL,   test.use = \"wilcox\",   DE_threshold = \"avg_log2FC > 0 & p_val_adj < 0.05\",   geneID = NULL,   geneID_groups = NULL,   geneID_exclude = NULL,   IDtype = \"symbol\",   result_IDtype = \"symbol\",   species = \"Homo_sapiens\",   db = \"GO_BP\",   db_update = FALSE,   db_version = \"latest\",   db_combine = FALSE,   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   unlimited_db = c(\"Chromosome\", \"GeneType\", \"TF\", \"Enzyme\", \"CSPA\"),   GO_simplify = FALSE,   GO_simplify_cutoff = \"p.adjust < 0.05\",   simplify_method = \"Wang\",   simplify_similarityCutoff = 0.7,   BPPARAM = BiocParallel::bpparam(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunEnrichment.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","text":"srt Seurat object containing results differential expression analysis (RunDEtest). specified, genes groups extracted Seurat object automatically. specified, geneID geneID_groups arguments must provided. group_by character vector specifying grouping variable Seurat object. argument used srt specified. test.use character vector specifying test used differential expression analysis. argument used srt specified. DE_threshold character vector specifying filter condition differential expression analysis. argument used srt specified. geneID character vector specifying gene IDs. geneID_groups factor vector specifying group labels gene. geneID_exclude character vector specifying gene IDs excluded analysis. IDtype character vector specifying type gene IDs srt object geneID argument. argument used convert gene IDs different type IDtype different result_IDtype. result_IDtype character vector specifying desired type gene ID used output. argument used convert gene IDs IDtype result_IDtype. species character vector specifying species analysis performed. db character vector specifying name database used enrichment analysis. db_update logical value indicating whether gene annotation databases forcefully updated. set FALSE, function attempt load cached databases instead. Default FALSE. db_version character vector specifying version database used. argument ignored db_update TRUE. Default \"latest\". db_combine logical value indicating whether combine multiple databases one. TRUE, database specified db combined one named \"Combined\". convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. TERM2GENE data frame specifying gene-term mapping custom database. first column contain term IDs, second column contain gene IDs. TERM2NAME data frame specifying term-name mapping custom database. first column contain term IDs, second column contain corresponding term names. minGSSize numeric value specifying minimum size gene set considered enrichment analysis. maxGSSize numeric value specifying maximum size gene set considered enrichment analysis. unlimited_db character vector specifying names databases size restrictions. GO_simplify logical value indicating whether simplify GO terms. TRUE, additional results simplified GO terms returned. GO_simplify_cutoff character vector specifying filter condition simplification GO terms. argument used GO_simplify TRUE. simplify_method character vector specifying method used simplification GO terms. argument used GO_simplify TRUE. simplify_similarityCutoff numeric value specifying similarity cutoff simplification GO terms. argument used GO_simplify TRUE. BPPARAM BiocParallelParam object specifying parallel back-end used parallel computation. Defaults BiocParallel::bpparam(). seed random seed reproducibility. Defaults 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunEnrichment.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","text":"input Seurat object, returns modified Seurat object enrichment result stored tools slot. input geneID vector without geneID_groups, return enrichment result directly. Enrichment result list following component: enrichment: data.frame containing enrichment results. results: list enrichResult objects DOSE package. geneMap: data.frame containing ID mapping table input gene IDs. input: data.frame containing input gene IDs gene ID groups. DE_threshold: specific threshold differential expression analysis (returned input Seurat object).","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunEnrichment.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform the enrichment analysis (over-representation) on the genes — RunEnrichment","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunEnrichment(   srt = pancreas_sub, group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",   db = \"GO_BP\", species = \"Mus_musculus\" ) #> [2025-09-07 20:34:19.10242] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",     db = \"GO_BP\", species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first.  pancreas_sub <- RunEnrichment(   srt = pancreas_sub, group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",   db = c(\"MSigDB\", \"MSigDB_MH\"), species = \"Mus_musculus\" ) #> [2025-09-07 20:34:19.104649] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",     db = c(\"MSigDB\", \"MSigDB_MH\"), species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = \"MSigDB\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"MSigDB\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first. EnrichmentPlot(pancreas_sub, db = \"MSigDB_MH\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"MSigDB_MH\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first.  # Remove redundant GO terms pancreas_sub <- RunEnrichment(srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", GO_simplify = TRUE, species = \"Mus_musculus\") #> [2025-09-07 20:34:19.107153] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\",     GO_simplify = TRUE, species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = \"GO_BP_sim\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"GO_BP_sim\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first.  # Use a combined database pancreas_sub <- RunEnrichment(   srt = pancreas_sub, group_by = \"CellType\",   db = c(\"KEGG\", \"WikiPathway\", \"Reactome\", \"PFAM\", \"MP\"),   db_combine = TRUE,   species = \"Mus_musculus\" ) #> [2025-09-07 20:34:19.109414] Start Enrichment #> Workers: 2 #> Error in RunEnrichment(srt = pancreas_sub, group_by = \"CellType\", db = c(\"KEGG\",     \"WikiPathway\", \"Reactome\", \"PFAM\", \"MP\"), db_combine = TRUE,     species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. EnrichmentPlot(pancreas_sub, db = \"Combined\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in EnrichmentPlot(pancreas_sub, db = \"Combined\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunEnrichment first.  # Or use \"geneID\" and \"geneID_groups\" as input to run enrichment de_df <- dplyr::filter(pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox, p_val_adj < 0.05) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" enrich_out <- RunEnrichment(geneID = de_df[[\"gene\"]], geneID_groups = de_df[[\"group1\"]], db = \"GO_BP\", species = \"Mus_musculus\") #> [2025-09-07 20:34:19.111893] Start Enrichment #> Workers: 2 #> Error: object 'de_df' not found EnrichmentPlot(res = enrich_out, db = \"GO_BP\", plot_type = \"comparison\") #> Error: object 'enrich_out' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunFR.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Force-Directed Layout (Fruchterman-Reingold algorithm) — RunFR","title":"Run Force-Directed Layout (Fruchterman-Reingold algorithm) — RunFR","text":"Run Force-Directed Layout (Fruchterman-Reingold algorithm)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunFR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Force-Directed Layout (Fruchterman-Reingold algorithm) — RunFR","text":"","code":"RunFR(object, ...)  # S3 method for class 'Seurat' RunFR(   object,   reduction = NULL,   dims = NULL,   features = NULL,   assay = NULL,   layer = \"data\",   graph = NULL,   neighbor = NULL,   k.param = 20,   ndim = 2,   niter = 500,   reduction.name = \"FR\",   reduction.key = \"FR_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunFR(   object,   ndim = 2,   niter = 500,   reduction.key = \"FR_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunFR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Force-Directed Layout (Fruchterman-Reingold algorithm) — RunFR","text":"object object. can Seurat object, Neighbor object, Graph object. ... Additional arguments passed layout_with_fr function. reduction character string specifying reduction used. Default NULL. dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". graph character string specifying name Graph object used. Default NULL. neighbor character string specifying name Neighbor object used. Default NULL. k.param integer specifying number nearest neighbors consider. Default 20. ndim integer specifying number dimensions force-directed layout. Default 2. niter integer specifying number iterations force-directed layout. Default 500. reduction.name character string specifying name reduction stored Seurat object. Default \"fr\". reduction.key character string specifying prefix column names force-directed layout embeddings. Default \"FR_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunFR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Force-Directed Layout (Fruchterman-Reingold algorithm) — RunFR","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunFR(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> Computing nearest neighbor graph #> Computing SNN #> Error in validObject(.Object): invalid class “DimReduc” object: 'assay.orig' must be a 1-length character CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"fr\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGLMPCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Run GLMPCA (generalized version of principal components analysis) — RunGLMPCA","title":"Run GLMPCA (generalized version of principal components analysis) — RunGLMPCA","text":"Run GLMPCA (generalized version principal components analysis)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGLMPCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run GLMPCA (generalized version of principal components analysis) — RunGLMPCA","text":"","code":"RunGLMPCA(object, ...)  # S3 method for class 'Seurat' RunGLMPCA(   object,   assay = NULL,   layer = \"counts\",   features = NULL,   L = 5,   fam = c(\"poi\", \"nb\", \"nb2\", \"binom\", \"mult\", \"bern\"),   rev.gmlpca = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.name = \"glmpca\",   reduction.key = \"GLMPC_\",   verbose = TRUE,   seed.use = 11,   ... )  # S3 method for class 'Assay' RunGLMPCA(   object,   assay = NULL,   layer = \"counts\",   features = NULL,   L = 5,   fam = c(\"poi\", \"nb\", \"nb2\", \"binom\", \"mult\", \"bern\"),   rev.gmlpca = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.key = \"GLMPC_\",   verbose = TRUE,   seed.use = 11,   ... )  # Default S3 method RunGLMPCA(   object,   assay = NULL,   layer = \"counts\",   features = NULL,   L = 5,   fam = c(\"poi\", \"nb\", \"nb2\", \"binom\", \"mult\", \"bern\"),   rev.gmlpca = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.key = \"GLMPC_\",   verbose = TRUE,   seed.use = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGLMPCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run GLMPCA (generalized version of principal components analysis) — RunGLMPCA","text":"object object. can Seurat object, assay object, matrix-like object. ... Additional arguments passed glmpca function. assay character string specifying assay used analysis. Default NULL. layer character string specifying layer name used analysis. Default \"counts\". features character vector specifying features used analysis. Default NULL, uses variable features. L integer specifying number components computed. Default 5. fam character string specifying family generalized linear model used. Currently supported values \"poi\", \"nb\", \"nb2\", \"binom\", \"mult\", \"bern\". Default \"poi\". rev.gmlpca logical value indicating whether perform reverse GLMPCA (.e., transpose input matrix) running analysis. Default FALSE. ndims.print integer vector specifying dimensions (number components) print output. Default 1:5. nfeatures.print integer specifying number features print output. Default 30. reduction.name character string specifying name reduction stored Seurat object. Default \"glmpca\". reduction.key character string specifying prefix column names basis vectors. Default \"GLMPC_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGLMPCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run GLMPCA (generalized version of principal components analysis) — RunGLMPCA","text":"","code":"pancreas_sub <- RunGLMPCA(object = pancreas_sub) #> Error in check_R(\"glmpca\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"glmpca\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGSEA.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","title":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","text":"Perform enrichment analysis (GSEA) genes","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGSEA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","text":"","code":"RunGSEA(   srt = NULL,   group_by = NULL,   test.use = \"wilcox\",   DE_threshold = \"p_val_adj < 0.05\",   scoreType = \"std\",   geneID = NULL,   geneScore = NULL,   geneID_groups = NULL,   geneID_exclude = NULL,   IDtype = \"symbol\",   result_IDtype = \"symbol\",   species = \"Homo_sapiens\",   db = \"GO_BP\",   db_update = FALSE,   db_version = \"latest\",   db_combine = FALSE,   convert_species = TRUE,   Ensembl_version = 103,   mirror = NULL,   TERM2GENE = NULL,   TERM2NAME = NULL,   minGSSize = 10,   maxGSSize = 500,   unlimited_db = c(\"Chromosome\", \"GeneType\", \"TF\", \"Enzyme\", \"CSPA\"),   GO_simplify = FALSE,   GO_simplify_cutoff = \"p.adjust < 0.05\",   simplify_method = \"Wang\",   simplify_similarityCutoff = 0.7,   BPPARAM = BiocParallel::bpparam(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGSEA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","text":"srt Seurat object containing results differential expression analysis (RunDEtest). specified, genes groups extracted Seurat object automatically. specified, geneID geneID_groups arguments must provided. group_by character vector specifying grouping variable Seurat object. argument used srt specified. test.use character vector specifying test used differential expression analysis. argument used srt specified. DE_threshold character vector specifying filter condition differential expression analysis. argument used srt specified. scoreType parameter defines GSEA score type. Possible options \"std\", \"pos\", \"neg\". default (\"std\") enrichment score computed original GSEA. \"pos\" \"neg\" score types intended used one-tailed tests (.e. one interested positive (\"pos\") negateive (\"neg\") enrichment). geneID character vector specifying gene IDs. geneScore numeric vector specifies gene scores, example, log2(fold change) values gene expression. geneID_groups factor vector specifying group labels gene. geneID_exclude character vector specifying gene IDs excluded analysis. IDtype character vector specifying type gene IDs srt object geneID argument. argument used convert gene IDs different type IDtype different result_IDtype. result_IDtype character vector specifying desired type gene ID used output. argument used convert gene IDs IDtype result_IDtype. species character vector specifying species analysis performed. db character vector specifying name database used enrichment analysis. db_update logical value indicating whether gene annotation databases forcefully updated. set FALSE, function attempt load cached databases instead. Default FALSE. db_version character vector specifying version database used. argument ignored db_update TRUE. Default \"latest\". db_combine logical value indicating whether combine multiple databases one. TRUE, database specified db combined one named \"Combined\". convert_species logical value indicating whether use species-converted database annotation missing specified species. default value TRUE. Ensembl_version Ensembl database version. NULL, use current release version. mirror Specify Ensembl mirror connect . valid options 'www', 'uswest', 'useast', 'asia'. TERM2GENE data frame specifying gene-term mapping custom database. first column contain term IDs, second column contain gene IDs. TERM2NAME data frame specifying term-name mapping custom database. first column contain term IDs, second column contain corresponding term names. minGSSize numeric value specifying minimum size gene set considered enrichment analysis. maxGSSize numeric value specifying maximum size gene set considered enrichment analysis. unlimited_db character vector specifying names databases size restrictions. GO_simplify logical value indicating whether simplify GO terms. TRUE, additional results simplified GO terms returned. GO_simplify_cutoff character vector specifying filter condition simplification GO terms. argument used GO_simplify TRUE. simplify_method character vector specifying method used simplification GO terms. argument used GO_simplify TRUE. simplify_similarityCutoff numeric value specifying similarity cutoff simplification GO terms. argument used GO_simplify TRUE. BPPARAM BiocParallelParam object specifying parallel back-end used parallel computation. Defaults BiocParallel::bpparam(). seed random seed reproducibility. Defaults 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGSEA.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","text":"input Seurat object, returns modified Seurat object enrichment result stored tools slot. input geneID vector without geneID_groups, return enrichment result directly. Enrichment result list following component: enrichment: data.frame containing enrichment results. results: list gseaResult objects DOSE package. geneMap: data.frame containing ID mapping table input gene IDs. input: data.frame containing input gene IDs gene ID groups. DE_threshold: specific threshold differential expression analysis (returned input Seurat object).","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunGSEA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Perform the enrichment analysis (GSEA) on the genes — RunGSEA","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\", only.pos = FALSE, fc.threshold = 1) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunGSEA(pancreas_sub,   group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",   scoreType = \"std\", db = \"GO_BP\", species = \"Mus_musculus\" ) #> [2025-09-07 20:34:28.815792] Start GSEA #> Workers: 2 #> Error in RunGSEA(pancreas_sub, group_by = \"CellType\", DE_threshold = \"p_val_adj < 0.05\",     scoreType = \"std\", db = \"GO_BP\", species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", plot_type = \"comparison\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\", id_use = \"GO:0006412\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Ductal\",     id_use = \"GO:0006412\"): No enrichment result found. You may perform RunGSEA first. GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\", id_use = c(\"GO:0046903\", \"GO:0015031\", \"GO:0007600\")) #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP\", group_by = \"CellType\", group_use = \"Endocrine\",     id_use = c(\"GO:0046903\", \"GO:0015031\", \"GO:0007600\")): No enrichment result found. You may perform RunGSEA first.  # Remove redundant GO terms pancreas_sub <- RunGSEA(srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\", GO_simplify = TRUE, species = \"Mus_musculus\") #> [2025-09-07 20:34:28.818727] Start GSEA #> Workers: 2 #> Error in RunGSEA(srt = pancreas_sub, group_by = \"CellType\", db = \"GO_BP\",     GO_simplify = TRUE, species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. GSEAPlot(pancreas_sub, db = \"GO_BP_sim\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in GSEAPlot(pancreas_sub, db = \"GO_BP_sim\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunGSEA first.  # Use a combined database pancreas_sub <- RunGSEA(   srt = pancreas_sub, group_by = \"CellType\",   db = c(\"KEGG\", \"WikiPathway\", \"Reactome\", \"PFAM\", \"MP\"),   db_combine = TRUE,   species = \"Mus_musculus\" ) #> [2025-09-07 20:34:28.820904] Start GSEA #> Workers: 2 #> Error in RunGSEA(srt = pancreas_sub, group_by = \"CellType\", db = c(\"KEGG\",     \"WikiPathway\", \"Reactome\", \"PFAM\", \"MP\"), db_combine = TRUE,     species = \"Mus_musculus\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. GSEAPlot(pancreas_sub, db = \"Combined\", group_by = \"CellType\", plot_type = \"comparison\") #> Error in GSEAPlot(pancreas_sub, db = \"Combined\", group_by = \"CellType\",     plot_type = \"comparison\"): No enrichment result found. You may perform RunGSEA first.  # Or use \"geneID\", \"geneScore\" and \"geneID_groups\" as input to run GSEA de_df <- dplyr::filter(pancreas_sub@tools$DEtest_CellType$AllMarkers_wilcox, p_val_adj < 0.05) #> Error in UseMethod(\"filter\"): no applicable method for 'filter' applied to an object of class \"NULL\" gsea_out <- RunGSEA(geneID = de_df[[\"gene\"]], geneScore = de_df[[\"avg_log2FC\"]], geneID_groups = de_df[[\"group1\"]], db = \"GO_BP\", species = \"Mus_musculus\") #> [2025-09-07 20:34:28.823426] Start GSEA #> Workers: 2 #> Error: object 'de_df' not found GSEAPlot(res = gsea_out, db = \"GO_BP\", plot_type = \"comparison\") #> Error: object 'gsea_out' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunHarmony2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Harmony algorithm — RunHarmony2","title":"Run Harmony algorithm — RunHarmony2","text":"modified version harmony::RunHarmony specifically designed compatibility RunSymphonyMap.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunHarmony2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Harmony algorithm — RunHarmony2","text":"","code":"RunHarmony2(object, ...)  # S3 method for class 'Seurat' RunHarmony2(   object,   group.by.vars,   reduction = \"pca\",   dims.use = 1:30,   project.dim = TRUE,   reduction.name = \"Harmony\",   reduction.key = \"Harmony_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunHarmony2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Harmony algorithm — RunHarmony2","text":"object Seurat object. ... Additional arguments passed RunHarmony function. group..vars character vector specifying batch variable name. reduction character string specifying reduction used. Default \"pca\". dims.use integer vector specifying dimensions used. Default 1:30. project.dim logical value indicating whether project dimension reduction loadings. Default TRUE. reduction.name character string specifying name reduction stored Seurat object. Default \"Harmony\". reduction.key character string specifying prefix column names Harmony embeddings. Default \"Harmony_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunHarmony2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Harmony algorithm — RunHarmony2","text":"","code":"panc8_sub <- Standard_SCP(panc8_sub) #> [2025-09-07 20:34:29.05731] Start Standard_SCP #> [2025-09-07 20:34:29.057466] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector panc8_sub <- RunHarmony2(panc8_sub, group.by.vars = \"tech\", reduction = \"Standardpca\") #> Error in check_R(\"harmony@1.1.0\"): could not find function \"check_R\" CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\"), reduction = \"Standardpca\") #> Error in DefaultReduction(srt, pattern = reduction): Unable to find any reductions. CellDimPlot(panc8_sub, group.by = c(\"tech\", \"celltype\"), reduction = \"Harmony\") #> Error in DefaultReduction(srt, pattern = reduction): Unable to find any reductions."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunImputation.html","id":null,"dir":"Reference","previous_headings":"","what":"Run imputation methods on Seurat object — RunImputation","title":"Run imputation methods on Seurat object — RunImputation","text":"function performs imputation Seurat object using various methods including ALRA, MAGIC, etc. imputed values stored new assay Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunImputation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run imputation methods on Seurat object — RunImputation","text":"","code":"RunImputation(   srt,   assay = NULL,   slot = \"data\",   method = c(\"alra\", \"magic\", \"knn_smooth\"),   new_assay = NULL,   features = NULL,   verbose = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunImputation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run imputation methods on Seurat object — RunImputation","text":"srt object class Seurat. assay Name assay use imputation. slot Name slot use imputation (default: \"data\"). method Imputation method use. One \"alra\", \"magic\", \"knn_smooth\". new_assay Name new assay store imputed data (default: paste0(method, \"_imputed\")). features Features use imputation. NULL, uses variable features. verbose Print progress messages.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunImputation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run imputation methods on Seurat object — RunImputation","text":"Seurat object imputed values stored new assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell reference mapping with KNN method — RunKNNMap","title":"Single-cell reference mapping with KNN method — RunKNNMap","text":"function performs single-cell reference mapping using K-nearest neighbor (KNN) method. takes two single-cell datasets input: srt_query srt_ref. function maps cells srt_query dataset srt_ref dataset based similarity distance.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell reference mapping with KNN method — RunKNNMap","text":"","code":"RunKNNMap(   srt_query,   srt_ref,   query_assay = NULL,   ref_assay = NULL,   ref_umap = NULL,   ref_group = NULL,   features = NULL,   nfeatures = 2000,   query_reduction = NULL,   ref_reduction = NULL,   query_dims = 1:30,   ref_dims = 1:30,   projection_method = c(\"model\", \"knn\"),   nn_method = NULL,   k = 30,   distance_metric = \"cosine\",   vote_fun = \"mean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-cell reference mapping with KNN method — RunKNNMap","text":"srt_query object class Seurat storing query cells. srt_ref object class Seurat storing reference cells. query_assay character string specifying assay name query cells. provided, default assay query object used. ref_assay character string specifying assay name reference cells. provided, default assay reference object used. ref_umap character string specifying name UMAP reduction reference object. provided, first UMAP reduction found reference object used. ref_group character string specifying metadata column name reference object use grouping. features character vector specifying features used calculating distance metric. provided, function use variable features calculated Seurat package. nfeatures integer specifying number highly variable features calculated features provided. query_reduction character string specifying name dimensionality reduction query object use calculating distance metric. ref_reduction character string specifying name dimensionality reduction reference object use calculating distance metric. query_dims numeric vector specifying dimension indices query reduction used calculating distance metric. ref_dims numeric vector specifying dimension indices reference reduction used calculating distance metric. projection_method character string specifying projection method use. Options \"model\" \"knn\". \"model\" selected, function try use pre-trained UMAP model reference object projection. \"knn\" selected, function directly find nearest neighbors using distance metric. nn_method character string specifying nearest neighbor search method use. Options \"raw\", \"annoy\", \"rann\". \"raw\" selected, function use brute-force method find nearest neighbors. \"annoy\" selected, function use Annoy library approximate nearest neighbor search. \"rann\" selected, function use RANN library approximate nearest neighbor search. provided, function choose search method based size query reference datasets. k integer specifying number nearest neighbors find cell query object. distance_metric character string specifying distance metric use calculating pairwise distances cells. Options include: \"pearson\", \"spearman\", \"cosine\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". Additional distance metrics can also used, \"euclidean\", \"manhattan\", \"hamming\", etc. vote_fun character string specifying function used aggregating nearest neighbors reference object. Options \"mean\", \"median\", \"sum\", \"min\", \"max\", \"sd\", \"var\", etc. provided, default \"mean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-cell reference mapping with KNN method — RunKNNMap","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"Seurat\") #> [2025-09-07 20:34:30.868806] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunKNNMap(srt_query = srt_query, srt_ref = srt_ref, ref_umap = \"SeuratUMAP2D\") #> Error in srt_ref[[ref_umap]]: ‘SeuratUMAP2D’ not found in this Seurat object #>   ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNPredict.html","id":null,"dir":"Reference","previous_headings":"","what":"RunKNNPredict — RunKNNPredict","title":"RunKNNPredict — RunKNNPredict","text":"function performs KNN prediction annotate cell types based reference scRNA-seq bulk RNA-seq data.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNPredict.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RunKNNPredict — RunKNNPredict","text":"","code":"RunKNNPredict(   srt_query,   srt_ref = NULL,   bulk_ref = NULL,   query_group = NULL,   ref_group = NULL,   query_assay = NULL,   ref_assay = NULL,   query_reduction = NULL,   ref_reduction = NULL,   query_dims = 1:30,   ref_dims = 1:30,   query_collapsing = !is.null(query_group),   ref_collapsing = TRUE,   return_full_distance_matrix = FALSE,   features = NULL,   features_type = c(\"HVF\", \"DE\"),   feature_source = \"both\",   nfeatures = 2000,   DEtest_param = list(max.cells.per.ident = 200, test.use = \"wilcox\"),   DE_threshold = \"p_val_adj < 0.05\",   nn_method = NULL,   distance_metric = \"cosine\",   k = 30,   filter_lowfreq = 0,   prefix = \"KNNPredict\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNPredict.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RunKNNPredict — RunKNNPredict","text":"srt_query object class Seurat annotated cell types. srt_ref object class Seurat storing reference cells. bulk_ref cell atlas matrix, cell types represented columns genes represented rows, example, SCP::ref_scHCL. Either `srt_ref` `bulk_ref` must provided. query_group character vector specifying column name `srt_query` metadata represents cell grouping. ref_group character vector specifying column name `srt_ref` metadata represents cell grouping. query_assay character vector specifying assay used query data. Defaults default assay `srt_query` object. ref_assay character vector specifying assay used reference data. Defaults default assay `srt_ref` object. query_reduction character vector specifying dimensionality reduction method used query data. NULL, function use default reduction method specified `srt_query` object. ref_reduction character vector specifying dimensionality reduction method used reference data. NULL, function use default reduction method specified `srt_ref` object. query_dims numeric vector specifying dimensions used query data. Defaults first 30 dimensions. ref_dims numeric vector specifying dimensions used reference data. Defaults first 30 dimensions. query_collapsing boolean value indicating whether query data collapsed group-level average expression values. TRUE, function calculate average expression values group query data annotation performed separately group. Otherwise use raw expression values cell. ref_collapsing boolean value indicating whether reference data collapsed group-level average expression values. TRUE, function calculate average expression values group reference data annotation performed separately group. Otherwise use raw expression values cell. return_full_distance_matrix boolean value indicating whether full distance matrix returned. TRUE, function return distance matrix used KNN prediction, otherwise return annotated cell types. features character vector specifying features (genes) used KNN prediction. NULL, features query reference data used. features_type character vector specifying type features used KNN prediction. Must one \"HVF\" (highly variable features) \"DE\" (differentially expressed features). Defaults \"HVF\". feature_source character vector specifying source features used KNN prediction. Must one \"\", \"query\", \"ref\". Defaults \"\". nfeatures integer specifying maximum number features used KNN prediction. Defaults 2000. DEtest_param list parameters passed differential expression test function `features_type` set \"DE\". Defaults `list(max.cells.per.ident = 200, test.use = \"wilcox\")`. DE_threshold Threshold used filter DE features. Default \"p_val < 0.05\". using \"roc\" test, DE_threshold needs reassigned. e.g. \"power > 0.5\". nn_method character vector specifying method used finding nearest neighbors. Must one \"raw\", \"rann\", \"annoy\". Defaults \"raw\". distance_metric character vector specifying distance metric used calculating similarity cells. Must one \"cosine\", \"euclidean\", \"manhattan\", \"hamming\". Defaults \"cosine\". k integer specifying number nearest neighbors considered KNN prediction. Defaults 30. filter_lowfreq integer specifying threshold filtering low-frequency cell types predicted results. Cell types frequency lower `filter_lowfreq` labelled \"unreliable\". Defaults 0, means filtering performed. prefix character vector specifying prefix added resulting annotations. Defaults \"KNNPredict\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNPredict.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RunKNNPredict — RunKNNPredict","text":"","code":"# Annotate cells using bulk RNA-seq data data(\"pancreas_sub\") data(\"ref_scMCA\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:34:32.977103] Start Standard_SCP #> [2025-09-07 20:34:32.97729] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunKNNPredict(srt_query = pancreas_sub, bulk_ref = ref_scMCA) #> Use 820 features to calculate distance. #> Detected query data type: raw_counts #> Detected reference data type: log_normalized_counts #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Removal of low credible cell types from the predicted results pancreas_sub <- RunKNNPredict(srt_query = pancreas_sub, bulk_ref = ref_scMCA, filter_lowfreq = 30) #> Use 820 features to calculate distance. #> Detected query data type: raw_counts #> Detected reference data type: log_normalized_counts #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Annotate clusters using bulk RNA-seq data pancreas_sub <- RunKNNPredict(srt_query = pancreas_sub, query_group = \"SubCellType\", bulk_ref = ref_scMCA) #> Use 820 features to calculate distance. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: log_normalized_counts #> Detected reference data type: log_normalized_counts #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... #> Error: No cell overlap between new meta data and Seurat object CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Annotate using single cell RNA-seq data data(\"panc8_sub\") # Simply convert genes from human to mouse and preprocess the data genenames <- make.unique(capitalize(rownames(panc8_sub), force_tolower = TRUE)) #> Error in capitalize(rownames(panc8_sub), force_tolower = TRUE): could not find function \"capitalize\" panc8_sub <- RenameFeatures(panc8_sub, newnames = genenames) #> Error: object 'genenames' not found panc8_sub <- check_srtMerge(panc8_sub, batch = \"tech\")[[\"srtMerge\"]] #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> [2025-09-07 20:34:36.18739] Spliting srtMerge into srtList by column tech... ... #> [2025-09-07 20:34:36.368877] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector  pancreas_sub <- RunKNNPredict(srt_query = pancreas_sub, srt_ref = panc8_sub, ref_group = \"celltype\") #> Use the HVF to calculate distance metric. #> Use 2 features to calculate distance. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: raw_counts #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Detected reference data type: log_normalized_counts #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  FeatureDimPlot(pancreas_sub, features = \"KNNPredict_simil\") #> Error in rescale(colors_value): could not find function \"rescale\"  pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_sub,   ref_group = \"celltype\", ref_collapsing = FALSE ) #> Use the HVF to calculate distance metric. #> Use 2 features to calculate distance. #> Detected query data type: raw_counts #> Detected reference data type: unknown #> Warning: Data type is unknown or different between query and reference. #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  FeatureDimPlot(pancreas_sub, features = \"KNNPredict_prob\") #> Error in rescale(colors_value): could not find function \"rescale\"  pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_sub,   query_group = \"SubCellType\", ref_group = \"celltype\" ) #> Use the HVF to calculate distance metric. #> Use 2 features to calculate distance. #> Warning: Exponentiation yielded infinite values. `data` may not be log-normed. #> Detected query data type: log_normalized_counts #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Warning: NAs introduced by coercion to integer range #> Detected reference data type: log_normalized_counts #> Calculate similarity... #> Use 'raw' method to find neighbors. #> Predict cell type... #> Error: No cell overlap between new meta data and Seurat object CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  FeatureDimPlot(pancreas_sub, features = \"KNNPredict_simil\") #> Error in rescale(colors_value): could not find function \"rescale\"  # Annotate with DE gene instead of HVF pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_sub,   ref_group = \"celltype\",   features_type = \"DE\", feature_source = \"ref\" ) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  FeatureDimPlot(pancreas_sub, features = \"KNNPredict_simil\") #> Error in rescale(colors_value): could not find function \"rescale\"  pancreas_sub <- RunKNNPredict(   srt_query = pancreas_sub, srt_ref = panc8_sub,   query_group = \"SubCellType\", ref_group = \"celltype\",   features_type = \"DE\", feature_source = \"both\" ) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, group.by = \"KNNPredict_classification\", label = TRUE) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  FeatureDimPlot(pancreas_sub, features = \"KNNPredict_simil\") #> Error in rescale(colors_value): could not find function \"rescale\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNSmooth.html","id":null,"dir":"Reference","previous_headings":"","what":"Run KNN-based smoothing imputation — RunKNNSmooth","title":"Run KNN-based smoothing imputation — RunKNNSmooth","text":"function performs k-nearest neighbor based smoothing imputation gene expression matrix.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNSmooth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run KNN-based smoothing imputation — RunKNNSmooth","text":"","code":"RunKNNSmooth(data_mat, k = 15, verbose = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNSmooth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run KNN-based smoothing imputation — RunKNNSmooth","text":"data_mat Expression matrix genes rows cells columns k Number nearest neighbors (default: 15) verbose Print progress messages","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunKNNSmooth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run KNN-based smoothing imputation — RunKNNSmooth","text":"Imputed expression matrix","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunLargeVis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run LargeVis (Dimensionality Reduction with a LargeVis-like method) — RunLargeVis","title":"Run LargeVis (Dimensionality Reduction with a LargeVis-like method) — RunLargeVis","text":"Run LargeVis (Dimensionality Reduction LargeVis-like method)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunLargeVis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run LargeVis (Dimensionality Reduction with a LargeVis-like method) — RunLargeVis","text":"","code":"RunLargeVis(object, ...)  # S3 method for class 'Seurat' RunLargeVis(   object,   reduction = \"pca\",   dims = NULL,   features = NULL,   assay = NULL,   layer = \"data\",   perplexity = 50,   n_neighbors = perplexity * 3,   n_components = 2,   metric = \"euclidean\",   n_epochs = -1,   learning_rate = 1,   scale = \"maxabs\",   init = \"lvrandom\",   init_sdev = NULL,   repulsion_strength = 7,   negative_sample_rate = 5,   nn_method = NULL,   n_trees = 50,   search_k = 2 * n_neighbors * n_trees,   n_threads = NULL,   n_sgd_threads = 0,   grain_size = 1,   kernel = \"gauss\",   pca = NULL,   pca_center = TRUE,   pcg_rand = TRUE,   fast_sgd = FALSE,   batch = FALSE,   opt_args = NULL,   epoch_callback = NULL,   pca_method = NULL,   reduction.name = \"largevis\",   reduction.key = \"LargeVis_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunLargeVis(   object,   assay = NULL,   perplexity = 50,   n_neighbors = perplexity * 3,   n_components = 2,   metric = \"euclidean\",   n_epochs = -1,   learning_rate = 1,   scale = \"maxabs\",   init = \"lvrandom\",   init_sdev = NULL,   repulsion_strength = 7,   negative_sample_rate = 5,   nn_method = NULL,   n_trees = 50,   search_k = 2 * n_neighbors * n_trees,   n_threads = NULL,   n_sgd_threads = 0,   grain_size = 1,   kernel = \"gauss\",   pca = NULL,   pca_center = TRUE,   pcg_rand = TRUE,   fast_sgd = FALSE,   batch = FALSE,   opt_args = NULL,   epoch_callback = NULL,   pca_method = NULL,   reduction.key = \"LargeVis_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunLargeVis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run LargeVis (Dimensionality Reduction with a LargeVis-like method) — RunLargeVis","text":"object object. can Seurat object matrix-like object. ... Additional arguments passed lvish function. reduction character string specifying reduction used. Default \"pca\". dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". perplexity Controls size local neighborhood used manifold approximation. analogous n_neighbors umap. Change , rather n_neighbors. n_neighbors number neighbors use calculating perplexity. Usually set three times value perplexity. Must least large perplexity. n_components integer specifying number LargeVis components. Default 2. metric Type distance metric use find nearest neighbors.  nn_method = \"annoy\" can one : \"euclidean\" (default) \"cosine\" \"manhattan\" \"hamming\" \"correlation\" (distance based Pearson correlation) \"categorical\" (see ) nn_method = \"hnsw\" can one : \"euclidean\" \"cosine\" \"correlation\" rnndescent installed nn_method = \"nndescent\" specified many metrics avaiable, including: \"braycurtis\" \"canberra\" \"chebyshev\" \"dice\" \"hamming\" \"hellinger\" \"jaccard\" \"jensenshannon\" \"kulsinski\" \"rogerstanimoto\" \"russellrao\" \"sokalmichener\" \"sokalsneath\" \"spearmanr\" \"symmetrickl\" \"tsss\" \"yule\" details see package documentation rnndescent. nn_method = \"fnn\", distance metric always \"euclidean\". X data frame matrix, multiple metrics can specified, passing list argument, name item list one metric names . value list item vector giving names integer ids columns included calculation, e.g. metric = list(euclidean = 1:4, manhattan = 5:10). metric calculation results separate fuzzy simplicial set, intersected together produce final set. Metric names can repeated. non-numeric columns removed data frame, safer use column names integer ids. Factor columns can also used specifying metric name \"categorical\". Factor columns treated different numeric columns although multiple factor columns can specified vector, factor column specified processed individually. specify non-factor column, coerced factor. given data block, may override pca pca_center arguments block, providing list one unnamed item containing column names ids, pca pca_center overrides named items, e.g. metric = list(euclidean = 1:4, manhattan = list(5:10, pca_center = FALSE)). exists allow mixed binary real-valued data included PCA applied , centering applied real-valued data (typical apply centering binary data PCA applied). n_epochs Number epochs use optimization embedded coordinates. default calculate number epochs dynamically based dataset size, give number edge samples LargeVis defaults. usually substantially larger UMAP defaults. n_epochs = 0, coordinates determined \"init\" returned. learning_rate Initial learning rate used optimization coordinates. scale Scaling apply X data frame matrix: \"none\" FALSE NULL scaling. \"Z\" \"scale\" TRUE Scale column   zero mean variance 1. \"maxabs\" Center column mean 0, divide   element maximum absolute value entire matrix. \"range\" Range scale entire matrix, smallest   element 0 largest 1. \"colrange\" Scale column range (0,1). lvish, default \"maxabs\", consistency LargeVis. init Type initialization coordinates. Options : \"spectral\" Spectral embedding using normalized Laplacian    fuzzy 1-skeleton, Gaussian noise added. \"normlaplacian\". Spectral embedding using normalized    Laplacian fuzzy 1-skeleton, without noise. \"random\". Coordinates assigned using uniform random    distribution -10 10. \"lvrandom\". Coordinates assigned using Gaussian    distribution standard deviation 1e-4, used LargeVis    (Tang et al., 2016) t-SNE. \"laplacian\". Spectral embedding using Laplacian Eigenmap    (Belkin Niyogi, 2002). \"pca\". first two principal components PCA    X X data frame, 2-dimensional classical    MDS X class \"dist\". \"spca\". Like \"pca\", dimension scaled    standard deviation 1e-4, give distribution similar    used t-SNE LargeVis. alias init = \"pca\",    init_sdev = 1e-4. \"agspectral\" \"approximate global\" modification    \"spectral\" edges graph value 1,    sets random number edges (negative_sample_rate edges per    vertex) 0.1, approximate effect non-local affinities. matrix initial coordinates. spectral initializations, (\"spectral\", \"normlaplacian\", \"laplacian\", \"agspectral\"), one connected component identified, spectral initialization attempted. Instead PCA-based initialization attempted. verbose = TRUE number connected components logged console. existence multiple connected components implies global view data attained initialization. Increasing value n_neighbors may help. init_sdev non-NULL, scales dimension initialized coordinates (including user-supplied matrix) standard deviation. default scaling carried , except init = \"spca\", case value 0.0001. Scaling input may help unscaled versions result initial coordinates large inter-point distances outliers. usually results small gradients optimization little progress made layout. Shrinking initial embedding rescaling can help circumstances. Scaling result init = \"pca\" usually recommended init = \"spca\" alias init = \"pca\", init_sdev = 1e-4 spectral initializations scaled versions usually necessary unless using large value n_neighbors (e.g. n_neighbors = 150 higher). compatibility recent versions Python UMAP package, using init = \"spectral\", also set init_sdev = \"range\", range scale columns containing initial data 0-10. set default maintain backwards compatibility previous versions uwot. repulsion_strength Weighting applied negative samples low dimensional embedding optimization. Values higher one result greater weight given negative samples. negative_sample_rate number negative edge/1-simplex samples use per positive edge/1-simplex sample optimizing low dimensional embedding. nn_method Method finding nearest neighbors. Options : \"fnn\". Use exact nearest neighbors via     FNN package. \"annoy\" Use approximate nearest neighbors via     RcppAnnoy package. \"hnsw\" Use approximate nearest neighbors     Hierarchical Navigable Small World (HNSW) method (Malkov Yashunin,     2018) via     RcppHNSW package.     RcppHNSW dependency package: option     available installed RcppHNSW . Also,     HNSW supports following arguments metric:     \"euclidean\", \"cosine\" \"correlation\". \"nndescent\" Use approximate nearest neighbors     Nearest Neighbor Descent method (Dong et al., 2011) via     rnndescent     package. rnndescent dependency package:     option available installed rnndescent     . default, X less 4,096 vertices, exact nearest neighbors found. Otherwise, approximate nearest neighbors used. may also pass precalculated nearest neighbor data argument. must list consisting two elements: \"idx\". n_vertices x n_neighbors matrix   containing integer indexes nearest neighbors X.   vertex considered nearest neighbor, .e.   idx[, 1] == 1:n_vertices. \"dist\". n_vertices x n_neighbors matrix   containing distances nearest neighbors. Multiple nearest neighbor data (e.g. two different precomputed metrics) can passed passing list containing nearest neighbor data lists items. n_neighbors parameter ignored using precomputed nearest neighbor data. n_trees Number trees build constructing nearest neighbor index. trees specified, larger index, better results. search_k, determines accuracy Annoy nearest neighbor search. used nn_method \"annoy\". Sensible values 10 100. search_k Number nodes search neighbor retrieval. larger k, accurate results, longer search takes. n_trees, determines accuracy Annoy nearest neighbor search. used nn_method \"annoy\". n_threads Number threads use (except stochastic gradient descent). Default half number concurrent threads supported system. nearest neighbor search, applies nn_method = \"annoy\". n_threads > 1, Annoy index temporarily written disk location determined tempfile. n_sgd_threads Number threads use stochastic gradient descent. set > 1, aware batch = FALSE, results reproducible, even set.seed called fixed seed running. Set \"auto\" use value n_threads. grain_size minimum amount work thread. value set high enough, less n_threads n_sgd_threads used processing, might give performance improvement overhead thread management context switching outweighing improvement due concurrent processing. left default (1) work spread evenly threads specified. kernel Type kernel function create input probabilities. Can one \"gauss\" (default) \"knn\". \"gauss\" uses usual Gaussian weighted similarities. \"knn\" assigns equal probabilities every edge nearest neighbor graph, zero otherwise, using perplexity nearest neighbors. n_neighbors parameter ignored case. pca set positive integer value, reduce data number columns using PCA. applied distance metric \"hamming\", dimensions data larger number specified (.e. number rows columns must larger value parameter). > 100 columns data frame matrix, reducing number columns way may substantially increase performance nearest neighbor search cost potential decrease accuracy. many t-SNE applications, value 50 recommended, although guarantee appropriate settings. pca_center TRUE, center columns X carrying PCA. binary data, recommended set FALSE. pcg_rand TRUE, use PCG random number generator (O'Neill, 2014) optimization. Otherwise, use faster (probably less statistically good) Tausworthe \"taus88\" generator. default TRUE. parameter superseded rng_type – set, rng_type takes precedence. fast_sgd TRUE, following combination parameters set: pcg_rand = TRUE n_sgd_threads = \"auto\". default FALSE. Setting TRUE speed stochastic optimization phase, give potentially less accurate embedding, exactly reproducible even fixed seed. visualization, fast_sgd = TRUE give perfectly good results. generic dimensionality reduction, safer leave fast_sgd = FALSE. fast_sgd = TRUE, user-supplied values pcg_rand n_sgd_threads, ignored. batch TRUE, embedding coordinates updated end epoch rather epoch. batch mode, results reproducible fixed random seed even n_sgd_threads > 1, cost slightly higher memory use. may also modify learning_rate increase n_epochs, whether provides speed increase single-threaded optimization likely dataset hardware-dependent. opt_args list optimizer parameters, used batch = TRUE. default optimization method used Adam (Kingma Ba, 2014). method optimization method use. Either \"adam\"   \"sgd\" (stochastic gradient descent). Default: \"adam\". beta1 (Adam ). weighting parameter   exponential moving average first moment estimator. Effectively   momentum parameter. floating point value 0 1.   Higher values can smooth oscillatory updates poorly-conditioned   situations may allow larger learning_rate   specified, high can cause divergence. Default: 0.5. beta2 (Adam ). weighting parameter   exponential moving average uncentered second moment estimator.   floating point value 0 1. Controls degree   adaptivity step-size. Higher values put weight previous   time steps. Default: 0.9. eps (Adam ). Intended small value prevent   division zero, practice can also affect convergence due   interaction beta2. Higher values reduce effect   step-size adaptivity bring behavior closer stochastic gradient   descent momentum. Typical values 1e-8 1e-3. Default:   1e-7. alpha initial learning rate. Default: value   learning_rate parameter. epoch_callback function invoked end every epoch. signature : (epoch, n_epochs, coords), : epoch current epoch number (1   n_epochs). n_epochs Number epochs use optimization   embedded coordinates. coords embedded coordinates end current   epoch, matrix dimensions (N, n_components). pca_method Method carry PCA dimensionality reduction pca parameter specified. Allowed values : \"irlba\", \"rsvd\", \"bigstatsr\", \"svd\", \"auto\"(default. Uses \"irlba\", unless 50 case \"svd\" used.) reduction.name character string specifying name reduction stored Seurat object. Default \"largevis\". reduction.key character string specifying prefix column names LargeVis embeddings. Default \"LargeVis_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunLargeVis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run LargeVis (Dimensionality Reduction with a LargeVis-like method) — RunLargeVis","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunLargeVis(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> 20:34:42 Read 1000 rows and found 2000 numeric columns #> 20:34:42 Normalizing by max-abs #> 20:34:42 Using FNN for neighbor search, n_neighbors = 150 #> 20:34:43 Commencing calibration for perplexity = 50 using 2 threads #> 20:34:45 Initializing from random Gaussian with sd = 1e-4 #> 20:34:45 Commencing optimization for 265696 epochs, with 217614 positive edges #> 20:34:45 Using rng type: pcg #> 20:37:19 Optimization finished CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"largevis\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMAGIC.html","id":null,"dir":"Reference","previous_headings":"","what":"Run MAGIC imputation — RunMAGIC","title":"Run MAGIC imputation — RunMAGIC","text":"function performs MAGIC (Markov Affinity-based Graph Imputation Cells) imputation gene expression matrix.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMAGIC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run MAGIC imputation — RunMAGIC","text":"","code":"RunMAGIC(data_mat, t = 3, k = 10, verbose = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMAGIC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run MAGIC imputation — RunMAGIC","text":"data_mat Expression matrix genes rows cells columns t Time parameter diffusion (default: 3) k Number nearest neighbors (default: 10) verbose Print progress messages","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMAGIC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run MAGIC imputation — RunMAGIC","text":"Imputed expression matrix","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMDS.html","id":null,"dir":"Reference","previous_headings":"","what":"Run MDS (multi-dimensional scaling) — RunMDS","title":"Run MDS (multi-dimensional scaling) — RunMDS","text":"Run MDS (multi-dimensional scaling)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMDS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run MDS (multi-dimensional scaling) — RunMDS","text":"","code":"RunMDS(object, ...)  # S3 method for class 'Seurat' RunMDS(   object,   assay = NULL,   layer = \"data\",   features = NULL,   nmds = 50,   dist.method = \"euclidean\",   mds.method = \"cmdscale\",   rev.mds = FALSE,   reduction.name = \"mds\",   reduction.key = \"MDS_\",   verbose = TRUE,   seed.use = 11,   ... )  # S3 method for class 'Assay' RunMDS(   object,   assay = NULL,   layer = \"data\",   features = NULL,   nmds = 50,   dist.method = \"euclidean\",   mds.method = \"cmdscale\",   rev.mds = FALSE,   reduction.key = \"MDS_\",   verbose = TRUE,   seed.use = 11,   ... )  # Default S3 method RunMDS(   object,   assay = NULL,   layer = \"data\",   nmds = 50,   dist.method = \"euclidean\",   mds.method = \"cmdscale\",   rev.mds = FALSE,   reduction.key = \"MDS_\",   verbose = TRUE,   seed.use = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMDS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run MDS (multi-dimensional scaling) — RunMDS","text":"object object. can Seurat object, assay object, matrix-like object. ... Additional arguments passed stats::cmdscale, MASS::isoMDS MASS::sammon function. assay character string specifying assay used analysis. Default NULL. layer character string specifying layer name used analysis. Default \"data\". features character vector specifying features used analysis. Default NULL, uses variable features. nmds integer specifying number dimensions computed. Default 50. dist.method character string specifying distance metric used. Currently supported values \"euclidean\", \"chisquared\",\"kullback\", \"jeffreys\", \"jensen\", \"manhattan\", \"maximum\", \"canberra\", \"minkowski\", \"hamming\". Default \"euclidean\". mds.method character string specifying MDS algorithm used. Currently supported values \"cmdscale\", \"isoMDS\", \"sammon\". Default \"cmdscale\". rev.mds logical value indicating whether perform reverse MDS (.e., transpose input matrix) running analysis. Default FALSE. reduction.name character string specifying name reduction stored Seurat object. Default \"mds\". reduction.key character string specifying prefix column names basis vectors. Default \"MDS_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMDS.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run MDS (multi-dimensional scaling) — RunMDS","text":"","code":"pancreas_sub <- RunMDS(object = pancreas_sub) CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"mds\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Monocle2 analysis — RunMonocle2","title":"Run Monocle2 analysis — RunMonocle2","text":"Runs Monocle2 algorithm Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Monocle2 analysis — RunMonocle2","text":"","code":"RunMonocle2(   srt,   assay = NULL,   slot = \"counts\",   expressionFamily = \"negbinomial.size\",   features = NULL,   feature_type = \"HVF\",   disp_filter = \"mean_expression >= 0.1 & dispersion_empirical >= 1 * dispersion_fit\",   max_components = 2,   reduction_method = \"DDRTree\",   norm_method = \"log\",   residualModelFormulaStr = NULL,   pseudo_expr = 1,   root_state = NULL,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Monocle2 analysis — RunMonocle2","text":"srt Seurat object. assay name assay Seurat object use analysis. Defaults NULL, case default assay object used. slot slot Seurat object use analysis. Default \"counts\". expressionFamily distribution family use modeling gene expression. Default \"negbinomial.size\". features vector gene names indices specifying features use analysis. Defaults NULL, case features determined feature_type. feature_type type features use analysis. Possible values \"HVF\" highly variable features \"Disp\" features selected based dispersion. Default \"HVF\". disp_filter string specifying filter use feature_type \"Disp\". Default \"mean_expression >= 0.1 & dispersion_empirical >= 1 * dispersion_fit\". max_components maximum number dimensions use dimensionality reduction. Default 2. reduction_method dimensionality reduction method use. Possible values \"DDRTree\" \"UMAP\". Default \"DDRTree\". norm_method normalization method use. Possible values \"log\" \"none\". Default \"log\". residualModelFormulaStr model formula specifying effects subtract. Default NULL. pseudo_expr Amount increase expression values dimensionality reduction. Default 1. root_state state use root trajectory. NULL, prompt user input. seed integer specifying random seed use. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Monocle2 analysis — RunMonocle2","text":"","code":"if (interactive()) {   data(\"pancreas_sub\")   pancreas_sub <- RunMonocle2(srt = pancreas_sub)   names(pancreas_sub@tools$Monocle2)   trajectory <- pancreas_sub@tools$Monocle2$trajectory    CellDimPlot(pancreas_sub, group.by = \"Monocle2_State\", reduction = \"DDRTree\", label = TRUE, theme_use = \"theme_blank\") + trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle2_State\", reduction = \"UMAP\", label = TRUE, theme_use = \"theme_blank\")   FeatureDimPlot(pancreas_sub, features = \"Monocle2_Pseudotime\", reduction = \"UMAP\", theme_use = \"theme_blank\")    pancreas_sub <- RunMonocle2(     srt = pancreas_sub,     feature_type = \"Disp\", disp_filter = \"mean_expression >= 0.01 & dispersion_empirical >= 1 * dispersion_fit\"   )   trajectory <- pancreas_sub@tools$Monocle2$trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle2_State\", reduction = \"DDRTree\", label = TRUE, theme_use = \"theme_blank\") + trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle2_State\", reduction = \"UMAP\", label = TRUE, theme_use = \"theme_blank\")   FeatureDimPlot(pancreas_sub, features = \"Monocle2_Pseudotime\", reduction = \"UMAP\", theme_use = \"theme_blank\") }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle3.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Monocle3 analysis — RunMonocle3","title":"Run Monocle3 analysis — RunMonocle3","text":"Runs Monocle3 algorithm Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Monocle3 analysis — RunMonocle3","text":"","code":"RunMonocle3(   srt,   assay = NULL,   slot = \"counts\",   reduction = DefaultReduction(srt),   clusters = NULL,   graph = NULL,   partition_qval = 0.05,   k = 50,   cluster_method = \"louvain\",   num_iter = 2,   resolution = NULL,   use_partition = NULL,   close_loop = TRUE,   root_pr_nodes = NULL,   root_cells = NULL,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Monocle3 analysis — RunMonocle3","text":"srt Seurat object. assay name assay Seurat object use analysis. Defaults NULL, case default assay object used. slot slot Seurat object use analysis. Default \"counts\". reduction reduction used. Defaults NULL, case default reduction Seurat object used. clusters cluster variable Seurat object use analysis. Defaults NULL, case use Monocle clusters used. graph name graph slot Seurat object use analysis. Defaults NULL, case Monocle graph used. partition_qval q-value threshold partitioning cells. Defaults 0.05. k number nearest neighbors consider clustering. Defaults 50. cluster_method clustering method use. Defaults \"louvain\". num_iter number iterations clustering. Defaults 2. resolution resolution parameter clustering. Defaults NULL. use_partition Whether use partitions learn disjoint graph partition. specified, user prompted input. Defaults NULL. close_loop Whether close loops graph. Defaults TRUE. root_pr_nodes root nodes order cells. specified, user prompted input. Defaults NULL. root_cells root cells order cells. specified, user prompted input. Defaults NULL. seed random seed use reproducibility. Defaults 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunMonocle3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Monocle3 analysis — RunMonocle3","text":"","code":"if (interactive()) {   data(\"pancreas_sub\")   # Use Monocle clusters to infer the trajectories   pancreas_sub <- RunMonocle3(srt = pancreas_sub, reduction = \"UMAP\")   names(pancreas_sub@tools$Monocle3)   trajectory <- pancreas_sub@tools$Monocle3$trajectory   milestones <- pancreas_sub@tools$Monocle3$milestones    CellDimPlot(pancreas_sub, group.by = \"Monocle3_partitions\", reduction = \"UMAP\", label = TRUE, theme_use = \"theme_blank\") + trajectory + milestones   CellDimPlot(pancreas_sub, group.by = \"Monocle3_clusters\", reduction = \"UMAP\", label = TRUE, theme_use = \"theme_blank\") + trajectory   FeatureDimPlot(pancreas_sub, features = \"Monocle3_Pseudotime\", reduction = \"UMAP\", theme_use = \"theme_blank\") + trajectory    ## Select the lineage using monocle3::choose_graph_segments   # cds <- pancreas_sub@tools$Monocle3$cds   # cds_sub <- monocle3::choose_graph_segments(cds, starting_pr_node = NULL, ending_pr_nodes = NULL)   # pancreas_sub$Lineages_1 <- NA   # pancreas_sub$Lineages_1[colnames(cds_sub)] <- pancreas_sub$Monocle3_Pseudotime[colnames(cds_sub)]   # CellDimPlot(pancreas_sub, group.by = \"SubCellType\", lineages = \"Lineages_1\", lineages_span = 0.1, theme_use = \"theme_blank\")    # Use Seurat clusters to infer the trajectories   pancreas_sub <- Standard_SCP(pancreas_sub)   CellDimPlot(pancreas_sub, group.by = c(\"Standardclusters\", \"CellType\"), label = TRUE, theme_use = \"theme_blank\")   pancreas_sub <- RunMonocle3(srt = pancreas_sub, clusters = \"Standardclusters\")   trajectory <- pancreas_sub@tools$Monocle3$trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle3_partitions\", reduction = \"StandardUMAP2D\", label = TRUE, theme_use = \"theme_blank\") + trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle3_clusters\", reduction = \"StandardUMAP2D\", label = TRUE, theme_use = \"theme_blank\") + trajectory   FeatureDimPlot(pancreas_sub, features = \"Monocle3_Pseudotime\", reduction = \"StandardUMAP2D\", theme_use = \"theme_blank\") + trajectory    # Use custom graphs and cell clusters to infer the partitions and trajectories, respectively   pancreas_sub <- Standard_SCP(pancreas_sub, cluster_resolution = 5)   CellDimPlot(pancreas_sub, group.by = c(\"Standardclusters\", \"CellType\"), label = TRUE)   pancreas_sub <- RunMonocle3(     srt = pancreas_sub,     clusters = \"Standardclusters\", graph = \"Standardpca_SNN\"   )   trajectory <- pancreas_sub@tools$Monocle3$trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle3_partitions\", reduction = \"StandardUMAP2D\", label = TRUE, theme_use = \"theme_blank\") + trajectory   CellDimPlot(pancreas_sub, group.by = \"Monocle3_clusters\", reduction = \"StandardUMAP2D\", label = TRUE, theme_use = \"theme_blank\") + trajectory   FeatureDimPlot(pancreas_sub, features = \"Monocle3_Pseudotime\", reduction = \"StandardUMAP2D\", theme_use = \"theme_blank\") + trajectory }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunNMF.html","id":null,"dir":"Reference","previous_headings":"","what":"Run NMF (non-negative matrix factorization) — RunNMF","title":"Run NMF (non-negative matrix factorization) — RunNMF","text":"Run NMF (non-negative matrix factorization)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunNMF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run NMF (non-negative matrix factorization) — RunNMF","text":"","code":"RunNMF(object, ...)  # S3 method for class 'Seurat' RunNMF(   object,   assay = NULL,   layer = \"data\",   features = NULL,   nbes = 50,   nmf.method = \"RcppML\",   tol = 1e-05,   maxit = 100,   rev.nmf = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.name = \"nmf\",   reduction.key = \"BE_\",   verbose = TRUE,   seed.use = 11,   ... )  # S3 method for class 'Assay' RunNMF(   object,   assay = NULL,   layer = \"data\",   features = NULL,   nbes = 50,   nmf.method = \"RcppML\",   tol = 1e-05,   maxit = 100,   rev.nmf = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.key = \"BE_\",   verbose = TRUE,   seed.use = 11,   ... )  # Default S3 method RunNMF(   object,   assay = NULL,   layer = \"data\",   nbes = 50,   nmf.method = \"RcppML\",   tol = 1e-05,   maxit = 100,   rev.nmf = FALSE,   ndims.print = 1:5,   nfeatures.print = 30,   reduction.key = \"BE_\",   verbose = TRUE,   seed.use = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunNMF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run NMF (non-negative matrix factorization) — RunNMF","text":"object object. can Seurat object, Assay object, matrix-like object. ... Additional arguments passed RcppML::nmf NMF::nmf function. assay character string specifying assay used analysis. Default NULL. layer character string specifying layer name used analysis. Default \"data\". features character vector specifying features used analysis. Default NULL, uses variable features. nbes integer specifying number basis vectors (components) computed. Default 50. nmf.method character string specifying NMF algorithm used. Currently supported values \"RcppML\" \"NMF\". Default \"RcppML\". tol numeric value specifying tolerance convergence (applicable nmf.method \"RcppML\"). Default 1e-5. maxit integer specifying maximum number iterations convergence (applicable nmf.method \"RcppML\"). Default 100. rev.nmf logical value indicating whether perform reverse NMF (.e., transpose input matrix) running analysis. Default FALSE. ndims.print integer vector specifying dimensions (number basis vectors) print output. Default 1:5. nfeatures.print integer specifying number features print output. Default 30. reduction.name character string specifying name reduction stored Seurat object. Default \"nmf\". reduction.key character string specifying prefix column names basis vectors. Default \"BE_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunNMF.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run NMF (non-negative matrix factorization) — RunNMF","text":"","code":"pancreas_sub <- RunNMF(object = pancreas_sub) #> Error in check_R(\"zdebruine/RcppML\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"nmf\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPAGA.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PAGA analysis — RunPAGA","title":"Run PAGA analysis — RunPAGA","text":"PAGA graph-based method used infer cellular trajectories. function runs PAGA analysis Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPAGA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PAGA analysis — RunPAGA","text":"","code":"RunPAGA(   srt = NULL,   assay_X = \"RNA\",   slot_X = \"counts\",   assay_layers = c(\"spliced\", \"unspliced\"),   slot_layers = \"counts\",   adata = NULL,   group_by = NULL,   linear_reduction = NULL,   nonlinear_reduction = NULL,   basis = NULL,   n_pcs = 30,   n_neighbors = 30,   use_rna_velocity = FALSE,   vkey = \"stochastic\",   embedded_with_PAGA = FALSE,   paga_layout = \"fr\",   threshold = 0.1,   point_size = 20,   infer_pseudotime = FALSE,   root_group = NULL,   root_cell = NULL,   n_dcs = 10,   n_branchings = 0,   min_group_size = 0.01,   palette = \"Paired\",   palcolor = NULL,   show_plot = TRUE,   save = FALSE,   dpi = 300,   dirpath = \"./\",   fileprefix = \"\",   return_seurat = !is.null(srt) )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPAGA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PAGA analysis — RunPAGA","text":"srt Seurat object. assay_X Assay convert main data matrix (X) anndata object. slot_X Slot name assay_X Seurat object. assay_layers Assays convert layers anndata object. slot_layers Slot names assay_layers Seurat object. adata anndata object. group_by Variable use grouping cells Seurat object. linear_reduction Linear reduction method use, e.g., \"PCA\". nonlinear_reduction Non-linear reduction method use, e.g., \"UMAP\". basis basis use reduction, e.g., \"UMAP\". n_pcs Number principal components use linear reduction. Default 30. n_neighbors Number neighbors use constructing KNN graph. Default 30. use_rna_velocity Whether use RNA velocity PAGA analysis. Default FALSE. vkey name RNA velocity data use use_rna_velocity TRUE. Default \"stochastic\". embedded_with_PAGA Whether embed data using PAGA layout. Default FALSE. paga_layout layout plotting PAGA graph. See See layout param scanpy.pl.paga function. threshold threshold plotting PAGA graph. Edges weights threshold draw. point_size point size plotting. infer_pseudotime Whether infer pseudotime. root_group group use root pseudotime inference. root_cell cell use root pseudotime inference. n_dcs TThe number diffusion components use pseudotime inference. n_branchings Number branchings detect. min_group_size minimum size group (fraction total number cells) consider potential branching point. palette palette use coloring cells. palcolor vector colors use palette. show_plot Whether show PAGA plot. save Whether save PAGA plots. dpi DPI (dots per inch) saving PAGA plot. dirpath directory save PAGA plots. fileprefix file prefix use PAGA plots. return_seurat Whether return Seurat object instead anndata object. Default TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPAGA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PAGA analysis — RunPAGA","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunPAGA(srt = pancreas_sub, assay_X = \"RNA\", group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\") #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"draw_graph_fr\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.  PAGAPlot(pancreas_sub, reduction = \"UMAP\") #> Error in PAGAPlot(pancreas_sub, reduction = \"UMAP\"): Cannot find the paga result. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", paga = pancreas_sub@misc$paga) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   pancreas_sub <- RunPAGA(   srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\",   embedded_with_PAGA = TRUE, infer_pseudotime = TRUE, root_group = \"Ductal\" ) #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" head(pancreas_sub[[]]) #>                     orig.ident nCount_RNA nFeature_RNA     S_score   G2M_score nCount_spliced nFeature_spliced #> CAGCCGAAGCGATATA SeuratProject      10653         3295  0.33188155  0.54532743          10653             3295 #> AGTGTCATCGCCGTGA SeuratProject       4596         2053 -0.07156909 -0.08865353           4596             2053 #> GATGAAAAGTTGTAGA SeuratProject      14091         3864  0.08940628  0.77610326          14091             3864 #> CACAGTACATCCGTGG SeuratProject       5484         2510 -0.25927997 -0.25941831           5484             2510 #> CGGAGCTCATTGGGCC SeuratProject       7357         2674 -0.11764368  0.46237856           7357             2674 #> AGAGCTTGTGTGACCC SeuratProject       6498         2516 -0.11406432 -0.17830831           6498             2516 #>                  nCount_unspliced nFeature_unspliced      CellType   SubCellType Phase #> CAGCCGAAGCGATATA             1587               1063        Ductal        Ductal   G2M #> AGTGTCATCGCCGTGA             1199                803 Pre-endocrine Pre-endocrine    G1 #> GATGAAAAGTTGTAGA             2166               1379   Ngn3 low EP   Ngn3 low EP   G2M #> CACAGTACATCCGTGG             1339                859     Endocrine          Beta    G1 #> CGGAGCTCATTGGGCC              976                745        Ductal        Ductal   G2M #> AGAGCTTGTGTGACCC              822                591        Ductal        Ductal    G1 names(pancreas_sub@reductions) #> [1] \"PCA\"  \"UMAP\" FeatureDimPlot(pancreas_sub, features = \"dpt_pseudotime\", reduction = \"PAGAUMAP2D\") #> Warning: dpt_pseudotime are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, features = \"dpt_pseudotime\", reduction = \"PAGAUMAP2D\"): There are no valid features present. PAGAPlot(pancreas_sub, reduction = \"PAGAUMAP2D\") #> Error in PAGAPlot(pancreas_sub, reduction = \"PAGAUMAP2D\"): Cannot find the paga result. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"PAGAUMAP2D\", paga = pancreas_sub@misc$paga) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPCAMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell reference mapping with PCA method — RunPCAMap","title":"Single-cell reference mapping with PCA method — RunPCAMap","text":"Single-cell reference mapping PCA method","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPCAMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell reference mapping with PCA method — RunPCAMap","text":"","code":"RunPCAMap(   srt_query,   srt_ref,   query_assay = NULL,   ref_assay = srt_ref[[ref_pca]]@assay.used,   ref_pca = NULL,   ref_dims = 1:30,   ref_umap = NULL,   ref_group = NULL,   projection_method = c(\"model\", \"knn\"),   nn_method = NULL,   k = 30,   distance_metric = \"cosine\",   vote_fun = \"mean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPCAMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-cell reference mapping with PCA method — RunPCAMap","text":"srt_query object class Seurat storing query cells. srt_ref object class Seurat storing reference cells. query_assay character string specifying assay name query cells. provided, default assay query object used. ref_assay character string specifying assay name reference cells. provided, default assay reference object used. ref_pca character string specifying name PCA reduction reference object use calculating distance metric. NULL (default), automatically detected first PCA reduction. ref_dims numeric vector specifying dimension indices reference reduction used calculating distance metric. ref_umap character string specifying name UMAP reduction reference object. provided, first UMAP reduction found reference object used. ref_group character string specifying metadata column name reference object use grouping. projection_method character string specifying projection method use. Options \"model\" \"knn\". \"model\" selected, function try use pre-trained UMAP model reference object projection. \"knn\" selected, function directly find nearest neighbors using distance metric. nn_method character string specifying nearest neighbor search method use. Options \"raw\", \"annoy\", \"rann\". \"raw\" selected, function use brute-force method find nearest neighbors. \"annoy\" selected, function use Annoy library approximate nearest neighbor search. \"rann\" selected, function use RANN library approximate nearest neighbor search. provided, function choose search method based size query reference datasets. k integer specifying number nearest neighbors find cell query object. distance_metric character string specifying distance metric use calculating pairwise distances cells. Options include: \"pearson\", \"spearman\", \"cosine\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". Additional distance metrics can also used, \"euclidean\", \"manhattan\", \"hamming\", etc. vote_fun character string specifying function used aggregating nearest neighbors reference object. Options \"mean\", \"median\", \"sum\", \"min\", \"max\", \"sd\", \"var\", etc. provided, default \"mean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPCAMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-cell reference mapping with PCA method — RunPCAMap","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"Seurat\") #> [2025-09-07 20:37:27.1628] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunPCAMap(srt_query = srt_query, srt_ref = srt_ref, ref_pca = \"Seuratpca\", ref_umap = \"SeuratUMAP2D\") #> Error in srt_ref[[ref_pca]]: ‘Seuratpca’ not found in this Seurat object #>   ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPHATE.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) — RunPHATE","title":"Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) — RunPHATE","text":"Run PHATE (Potential Heat-diffusion Affinity-based Trajectory Embedding)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPHATE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) — RunPHATE","text":"","code":"RunPHATE(object, ...)  # S3 method for class 'Seurat' RunPHATE(   object,   reduction = \"pca\",   dims = NULL,   features = NULL,   assay = NULL,   layer = \"data\",   n_components = 2,   knn = 5,   decay = 40,   n_landmark = 2000,   t = \"auto\",   gamma = 1,   n_pca = 100,   knn_dist = \"euclidean\",   knn_max = NULL,   t_max = 100,   do_cluster = FALSE,   n_clusters = \"auto\",   max_clusters = 100,   reduction.name = \"phate\",   reduction.key = \"PHATE_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunPHATE(   object,   assay = NULL,   n_components = 2,   knn = 5,   decay = 40,   n_landmark = 2000,   t = \"auto\",   gamma = 1,   n_pca = 100,   knn_dist = \"euclidean\",   knn_max = NULL,   t_max = 100,   do_cluster = FALSE,   n_clusters = \"auto\",   max_clusters = 100,   reduction.key = \"PHATE_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPHATE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) — RunPHATE","text":"object object. can Seurat object matrix-like object. ... Additional arguments passed phate.PHATE function. reduction character string specifying reduction used. Default \"pca\". dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". n_components integer specifying number PHATE components. Default 2. knn integer specifying number nearest neighbors build kernel. Default 5. decay integer specifying sets decay rate kernel tails. Default 40. n_landmark integer specifying number landmarks use fast PHATE. Default 2000. t character string specifying power diffusion operator powered. sets level diffusion. ‘auto’, t selected according knee point Von Neumann Entropy diffusion operator. Default \"auto\". gamma numeric value specifying informational distance constant -1 1. gamma=1 gives PHATE log potential, gamma=0 gives square root potential. Default 1. n_pca integer specifying number principal components use calculating neighborhoods. extremely large datasets, using n_pca < 20 allows neighborhoods calculated roughly log(n_samples) time. Default 100. knn_dist character string specifying distance metric k-nearest neighbors. Recommended values: \"euclidean, \"cosine, \"precomputed\". Default \"euclidean\". knn_max integer specifying maximum number neighbors alpha decaying kernel computed point. large datasets, setting knn_max small multiple knn can speed computation significantly. Default NULL. t_max integer specifying maximum t test. Default 100. do_cluster logical value indicating whether perform clustering PHATE embeddings. Default FALSE. n_clusters integer specifying number clusters identified. Default \"auto\". max_clusters integer specifying maximum number clusters test. Default 100. reduction.name character string specifying name reduction stored Seurat object. Default \"phate\". reduction.key character string specifying prefix column names PHATE embeddings. Default \"PHATE_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPHATE.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PHATE (Potential of Heat-diffusion for Affinity-based Trajectory Embedding) — RunPHATE","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunPHATE(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> Error in check_Python(\"phate\"): could not find function \"check_Python\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"phate\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPaCMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP","title":"Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP","text":"Run PaCMAP (Pairwise Controlled Manifold Approximation)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPaCMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP","text":"","code":"RunPaCMAP(object, ...)  # S3 method for class 'Seurat' RunPaCMAP(   object,   reduction = \"pca\",   dims = NULL,   features = NULL,   assay = NULL,   layer = \"data\",   n_components = 2,   n.neighbors = NULL,   MN_ratio = 0.5,   FP_ratio = 2,   distance_method = \"euclidean\",   lr = 1,   num_iters = 450L,   apply_pca = TRUE,   init = \"random\",   reduction.name = \"pacmap\",   reduction.key = \"PaCMAP_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunPaCMAP(   object,   assay = NULL,   n_components = 2,   n.neighbors = NULL,   MN_ratio = 0.5,   FP_ratio = 2,   distance_method = \"euclidean\",   lr = 1,   num_iters = 450L,   apply_pca = TRUE,   init = \"random\",   reduction.key = \"PaCMAP_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPaCMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP","text":"object object. can Seurat object matrix-like object. ... Additional arguments passed pacmap.PaCMAP function. reduction character string specifying reduction used. Default \"pca\". dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". n_components integer specifying number PaCMAP components. Default 2. n.neighbors integer specifying number neighbors considered k-Nearest Neighbor graph. Default 10 dataset whose sample size smaller 10000. large dataset whose sample size (n) larger 10000, default value : 10 + 15 * (log10(n) - 4). MN_ratio numeric value specifying ratio ratio number mid-near pairs number neighbors. Default 0.5. FP_ratio numeric value specifying ratio ratio number pairs number neighbors. Default 2. distance_method character string specifying distance metric used. Default \"euclidean\". lr numeric value specifying learning rate AdaGrad optimizer. Default 1. num_iters integer specifying number iterations PaCMAP optimization. Default 450. apply_pca logical value indicating whether pacmap apply PCA data constructing k-Nearest Neighbor graph. Using PCA preprocess data can largely accelerate DR process without losing much accuracy. Notice option affect initialization optimization process. Default TRUE. init character string specifying initialization lower dimensional embedding. One \"pca\" \"random\". Default \"random\". reduction.name character string specifying name reduction stored Seurat object. Default \"pacmap\". reduction.key character string specifying prefix column names PaCMAP embeddings. Default \"PaCMAP_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPaCMAP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run PaCMAP (Pairwise Controlled Manifold Approximation) — RunPaCMAP","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunPaCMAP(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> Error in check_Python(\"pacmap\"): could not find function \"check_Python\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"pacmap\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPalantir.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Palantir analysis — RunPalantir","title":"Run Palantir analysis — RunPalantir","text":"Run Palantir analysis","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPalantir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Palantir analysis — RunPalantir","text":"","code":"RunPalantir(   srt = NULL,   assay_X = \"RNA\",   slot_X = \"counts\",   assay_layers = c(\"spliced\", \"unspliced\"),   slot_layers = \"counts\",   adata = NULL,   group_by = NULL,   linear_reduction = NULL,   nonlinear_reduction = NULL,   basis = NULL,   n_pcs = 30,   n_neighbors = 30,   dm_n_components = 10,   dm_alpha = 0,   dm_n_eigs = NULL,   early_group = NULL,   early_cell = NULL,   terminal_cells = NULL,   terminal_groups = NULL,   num_waypoints = 1200,   scale_components = TRUE,   use_early_cell_as_start = TRUE,   adjust_early_cell = FALSE,   adjust_terminal_cells = FALSE,   max_iterations = 25,   n_jobs = 8,   point_size = 20,   palette = \"Paired\",   palcolor = NULL,   show_plot = TRUE,   save = FALSE,   dpi = 300,   dirpath = \"./\",   fileprefix = \"\",   return_seurat = !is.null(srt) )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPalantir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Palantir analysis — RunPalantir","text":"srt Seurat object. assay_X Assay convert main data matrix (X) anndata object. slot_X Slot name assay_X Seurat object. assay_layers Assays convert layers anndata object. slot_layers Slot names assay_layers Seurat object. adata anndata object. group_by Variable use grouping cells Seurat object. linear_reduction Linear reduction method use, e.g., \"PCA\". nonlinear_reduction Non-linear reduction method use, e.g., \"UMAP\". basis basis use reduction, e.g., \"UMAP\". n_pcs Number principal components use linear reduction. Default 30. n_neighbors Number neighbors use constructing KNN graph. Default 30. dm_n_components number diffusion components calculate. dm_alpha Normalization parameter diffusion operator. dm_n_eigs Number eigen vectors use. early_group Name group start Palantir analysis . early_cell Name cell start Palantir analysis . terminal_cells Character vector specifying terminal cells Palantir analysis. terminal_groups Character vector specifying terminal groups Palantir analysis. num_waypoints Number waypoints included. scale_components cell fate probabilities scaled component independently? use_early_cell_as_start starting cell terminal group set early_cell? adjust_early_cell Whether adjust early cell cell minimum pseudotime value. adjust_terminal_cells hether adjust terminal cells cells maximum pseudotime value terminal group. max_iterations Maximum number iterations pseudotime convergence. n_jobs number parallel jobs run. point_size point size plotting. palette palette use coloring cells. palcolor vector colors use palette. show_plot Whether show PAGA plot. save Whether save PAGA plots. dpi DPI (dots per inch) saving PAGA plot. dirpath directory save PAGA plots. fileprefix file prefix use PAGA plots. return_seurat Whether return Seurat object instead anndata object. Default TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunPalantir.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Palantir analysis — RunPalantir","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunPalantir(   srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\",   early_group = \"Ductal\", use_early_cell_as_start = TRUE,   terminal_groups = c(\"Alpha\", \"Beta\", \"Delta\", \"Epsilon\") ) #> Error in check_Python(\"palantir\"): could not find function \"check_Python\" head(pancreas_sub[[]]) #>                     orig.ident nCount_RNA nFeature_RNA     S_score   G2M_score nCount_spliced nFeature_spliced #> CAGCCGAAGCGATATA SeuratProject      10653         3295  0.33188155  0.54532743          10653             3295 #> AGTGTCATCGCCGTGA SeuratProject       4596         2053 -0.07156909 -0.08865353           4596             2053 #> GATGAAAAGTTGTAGA SeuratProject      14091         3864  0.08940628  0.77610326          14091             3864 #> CACAGTACATCCGTGG SeuratProject       5484         2510 -0.25927997 -0.25941831           5484             2510 #> CGGAGCTCATTGGGCC SeuratProject       7357         2674 -0.11764368  0.46237856           7357             2674 #> AGAGCTTGTGTGACCC SeuratProject       6498         2516 -0.11406432 -0.17830831           6498             2516 #>                  nCount_unspliced nFeature_unspliced      CellType   SubCellType Phase #> CAGCCGAAGCGATATA             1587               1063        Ductal        Ductal   G2M #> AGTGTCATCGCCGTGA             1199                803 Pre-endocrine Pre-endocrine    G1 #> GATGAAAAGTTGTAGA             2166               1379   Ngn3 low EP   Ngn3 low EP   G2M #> CACAGTACATCCGTGG             1339                859     Endocrine          Beta    G1 #> CGGAGCTCATTGGGCC              976                745        Ductal        Ductal   G2M #> AGAGCTTGTGTGACCC              822                591        Ductal        Ductal    G1 FeatureDimPlot(pancreas_sub, c(\"palantir_pseudotime\", \"palantir_diff_potential\")) #> Warning: palantir_pseudotime,palantir_diff_potential are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, c(\"palantir_pseudotime\", \"palantir_diff_potential\")): There are no valid features present. FeatureDimPlot(pancreas_sub, paste0(c(\"Alpha\", \"Beta\", \"Delta\", \"Epsilon\"), \"_diff_potential\")) #> Warning: Alpha_diff_potential,Beta_diff_potential,Delta_diff_potential,Epsilon_diff_potential are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, paste0(c(\"Alpha\", \"Beta\", \"Delta\",     \"Epsilon\"), \"_diff_potential\")): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCExplorer.html","id":null,"dir":"Reference","previous_headings":"","what":"RunSCExplorer — RunSCExplorer","title":"RunSCExplorer — RunSCExplorer","text":"RunSCExplorer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCExplorer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RunSCExplorer — RunSCExplorer","text":"","code":"RunSCExplorer(   base_dir = \"SCExplorer\",   DataFile = \"Data.hdf5\",   MetaFile = \"Meta.hdf5\",   title = \"SCExplorer\",   initial_dataset = NULL,   initial_reduction = NULL,   initial_group = NULL,   initial_feature = NULL,   initial_assay = NULL,   initial_slot = NULL,   initial_label = FALSE,   initial_cell_palette = \"Paired\",   initial_feature_palette = \"Spectral\",   initial_theme = \"theme_scp\",   initial_size = 4,   initial_ncol = 3,   initial_arrange = NULL,   initial_raster = NULL,   session_workers = 2,   plotting_workers = 8,   create_script = TRUE,   style_script = require(\"styler\", quietly = TRUE),   overwrite = FALSE,   return_app = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCExplorer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RunSCExplorer — RunSCExplorer","text":"base_dir string. base directory SCExplorer app. Default \"SCExplorer\". DataFile string. name HDF5 file stores data matrices dataset. Default \"Data.hdf5\". MetaFile string. name HDF5 file stores metadata dataset. Default \"Meta.hdf5\". title string. title SCExplorer app. Default \"SCExplorer\". initial_dataset string. initial dataset loaded app. Default NULL. initial_reduction string. initial dimensional reduction method loaded app. Default NULL. initial_group string. initial variable group cells app. Default NULL. initial_feature string. initial feature loaded app. Default NULL. initial_assay string. initial assay loaded app. Default NULL. initial_slot string. initial slot loaded app. Default NULL. initial_label string. Whether add labels initial plot. Default FALSE. initial_cell_palette string. initial color palette cells. Default \"Paired\". initial_feature_palette string. initial color palette features. Default \"Spectral\". initial_theme string. initial theme plots. Default \"theme_scp\". initial_size numeric. initial size plots. Default 4. initial_ncol numeric. initial number columns arranging plots. Default 3. initial_arrange logical. Whether use \"Row\" initial arrangement. Default TRUE. initial_raster logical. Whether perform rasterization initial plot. default, set automatic, meaning TRUE number cells initial datasets exceeds 100,000. session_workers numeric. number workers concurrent execution asynchronous programming session. Default 2. plotting_workers numeric. number threads per worker parallel plotting. Default 8. create_script logical. Whether create SCExplorer app script. Default TRUE. style_script logical. Whether style SCExplorer app script. Default TRUE. overwrite logical. Whether overwrite existing files. Default FALSE. return_app logical. Whether return SCExplorer app. Default TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCExplorer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RunSCExplorer — RunSCExplorer","text":"","code":"if (FALSE) { # \\dontrun{ data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) data(\"panc8_sub\") panc8_sub <- Integration_SCP(srtMerge = panc8_sub, batch = \"tech\", integration_method = \"Seurat\")  PrepareSCExplorer(list(mouse_pancreas = pancreas_sub, human_pancreas = panc8_sub), base_dir = \"./SCExplorer\", overwrite = TRUE)  # Create the app.R script app <- RunSCExplorer(   base_dir = \"./SCExplorer\",   initial_dataset = \"mouse_pancreas\",   initial_group = \"CellType\",   initial_feature = \"Neurog3\",   session_workers = 2,   overwrite = TRUE ) list.files(\"./SCExplorer\") # This directory can be used as site directory for Shiny Server.  # Run shiny app if (interactive()) {   shiny::runApp(app) } # Note: If SCP installed in the isolated environment using renv, you need to add `renv::activate(project = \"path/to/SCP_env\")` to the app.R script.  #################################################################################################################### # You can deploy the app on the self-hosted shiny server(https://www.rstudio.com/products/shiny/shiny-server/). # Or deploy the app on the website(https://www.shinyapps.io) for free:  ### step1: set the repository URL for Bioconductor packages and update them to the latest version # options(repos = BiocManager::repositories()) # BiocManager::install(ask = FALSE)  ### step2: install \"rsconnect\" package and authorize your account # install.packages(\"rsconnect\") # library(rsconnect) # setAccountInfo(name = \"<NAME>\", token = \"<TOKEN>\", secret = \"<SECRET>\")  ### step3: deploy the app # deployApp(\"./SCExplorer\") } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCVELO.html","id":null,"dir":"Reference","previous_headings":"","what":"Run scVelo workflow — RunSCVELO","title":"Run scVelo workflow — RunSCVELO","text":"scVelo scalable toolkit RNA velocity analysis single cells. function runs scVelo workflow Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCVELO.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run scVelo workflow — RunSCVELO","text":"","code":"RunSCVELO(   srt = NULL,   assay_X = \"RNA\",   slot_X = \"counts\",   assay_layers = c(\"spliced\", \"unspliced\"),   slot_layers = \"counts\",   adata = NULL,   group_by = NULL,   linear_reduction = NULL,   nonlinear_reduction = NULL,   basis = NULL,   mode = \"stochastic\",   fitting_by = \"stochastic\",   magic_impute = FALSE,   knn = 5,   t = 2,   min_shared_counts = 30,   n_pcs = 30,   n_neighbors = 30,   stream_smooth = NULL,   stream_density = 2,   arrow_length = 5,   arrow_size = 5,   arrow_density = 0.5,   denoise = FALSE,   denoise_topn = 3,   kinetics = FALSE,   kinetics_topn = 100,   calculate_velocity_genes = FALSE,   top_n = 6,   n_jobs = 1,   palette = \"Paired\",   palcolor = NULL,   show_plot = TRUE,   save = FALSE,   dpi = 300,   dirpath = \"./\",   fileprefix = \"\",   return_seurat = !is.null(srt) )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCVELO.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run scVelo workflow — RunSCVELO","text":"srt Seurat object. assay_X Assay convert main data matrix (X) anndata object. slot_X Slot name assay_X Seurat object. assay_layers Assays convert layers anndata object. slot_layers Slot names assay_layers Seurat object. adata anndata object. group_by Variable use grouping cells Seurat object. linear_reduction Linear reduction method use, e.g., \"PCA\". nonlinear_reduction Non-linear reduction method use, e.g., \"UMAP\". basis basis use reduction, e.g., \"UMAP\". mode Velocity estimation model use, e.g., \"stochastic\". fitting_by Method used fit gene velocities, e.g., \"stochastic\". magic_impute Flag indicating whether perform magic imputation. knn number nearest neighbors magic.MAGIC. t power diffusion operator powered magic.MAGIC. min_shared_counts Minimum number counts (unspliced spliced) required gene. n_pcs Number principal components (PCs) used velocity estimation. n_neighbors Number nearest neighbors used velocity estimation. stream_smooth Multiplication factor scale Gaussian kernel around grid point. stream_density Controls closeness streamlines. density = 2 (default), domain divided 60x60 grid, whereas density linearly scales grid. cell grid can , , one traversing streamline. arrow_length Length arrows. arrow_size Size arrows. arrow_density Amount velocities show. denoise Boolean flag indicating whether denoise. denoise_topn Number genes highest likelihood selected infer velocity directions. kinetics Boolean flag indicating whether estimate RNA kinetics. kinetics_topn Number genes highest likelihood selected infer velocity directions. calculate_velocity_genes Boolean flag indicating whether calculate velocity genes. top_n number top features plot. n_jobs number parallel jobs run. palette palette use coloring cells. palcolor vector colors use palette. show_plot Whether show PAGA plot. save Whether save PAGA plots. dpi DPI (dots per inch) saving PAGA plot. dirpath directory save PAGA plots. fileprefix file prefix use PAGA plots. return_seurat Whether return Seurat object instead anndata object. Default TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSCVELO.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run scVelo workflow — RunSCVELO","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSCVELO(srt = pancreas_sub, assay_X = \"RNA\", group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\") #> Python module 'scvelo' is required for velocity analysis but is not installed. #> To install, run: PrepareEnv() and then check_Python('scvelo') #> Error in RunSCVELO(srt = pancreas_sub, assay_X = \"RNA\", group_by = \"SubCellType\",     linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\"): Required Python module 'scvelo' is not available. Please install it first. head(pancreas_sub[[]]) #>                     orig.ident nCount_RNA nFeature_RNA     S_score   G2M_score nCount_spliced nFeature_spliced #> CAGCCGAAGCGATATA SeuratProject      10653         3295  0.33188155  0.54532743          10653             3295 #> AGTGTCATCGCCGTGA SeuratProject       4596         2053 -0.07156909 -0.08865353           4596             2053 #> GATGAAAAGTTGTAGA SeuratProject      14091         3864  0.08940628  0.77610326          14091             3864 #> CACAGTACATCCGTGG SeuratProject       5484         2510 -0.25927997 -0.25941831           5484             2510 #> CGGAGCTCATTGGGCC SeuratProject       7357         2674 -0.11764368  0.46237856           7357             2674 #> AGAGCTTGTGTGACCC SeuratProject       6498         2516 -0.11406432 -0.17830831           6498             2516 #>                  nCount_unspliced nFeature_unspliced      CellType   SubCellType Phase #> CAGCCGAAGCGATATA             1587               1063        Ductal        Ductal   G2M #> AGTGTCATCGCCGTGA             1199                803 Pre-endocrine Pre-endocrine    G1 #> GATGAAAAGTTGTAGA             2166               1379   Ngn3 low EP   Ngn3 low EP   G2M #> CACAGTACATCCGTGG             1339                859     Endocrine          Beta    G1 #> CGGAGCTCATTGGGCC              976                745        Ductal        Ductal   G2M #> AGAGCTTGTGTGACCC              822                591        Ductal        Ductal    G1 names(pancreas_sub@assays) #> [1] \"RNA\"       \"spliced\"   \"unspliced\"  FeatureDimPlot(pancreas_sub, c(\"stochastic_length\", \"stochastic_confidence\")) #> Warning: stochastic_length,stochastic_confidence are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, c(\"stochastic_length\", \"stochastic_confidence\")): There are no valid features present. FeatureDimPlot(pancreas_sub, \"stochastic_pseudotime\") #> Warning: stochastic_pseudotime are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, \"stochastic_pseudotime\"): There are no valid features present. VelocityPlot(pancreas_sub, reduction = \"UMAP\", plot_type = \"stream\") #> Error in check_R(\"metR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", pt.size = NA, velocity = \"stochastic\") #> Error in check_R(\"metR\"): could not find function \"check_R\"  pancreas_sub <- Standard_SCP(pancreas_sub, normalization_method = \"SCT\", nonlinear_reduction = \"tsne\") #> [2025-09-07 20:37:32.226843] Start Standard_SCP #> [2025-09-07 20:37:32.226969] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Error in check_R(\"glmGamPoi\"): could not find function \"check_R\" pancreas_sub <- RunSCVELO(srt = pancreas_sub, assay_X = \"SCT\", group_by = \"SubCellType\", linear_reduction = \"Standardpca\", nonlinear_reduction = \"StandardTSNE2D\") #> Python module 'scvelo' is required for velocity analysis but is not installed. #> To install, run: PrepareEnv() and then check_Python('scvelo') #> Error in RunSCVELO(srt = pancreas_sub, assay_X = \"SCT\", group_by = \"SubCellType\",     linear_reduction = \"Standardpca\", nonlinear_reduction = \"StandardTSNE2D\"): Required Python module 'scvelo' is not available. Please install it first."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunScmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate single cells using scmap. — RunScmap","title":"Annotate single cells using scmap. — RunScmap","text":"Annotate single cells using scmap.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunScmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate single cells using scmap. — RunScmap","text":"","code":"RunScmap(   srt_query,   srt_ref,   ref_group = NULL,   query_assay = \"RNA\",   ref_assay = \"RNA\",   method = \"scmapCluster\",   nfeatures = 500,   threshold = 0.5,   k = 10 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunScmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate single cells using scmap. — RunScmap","text":"srt_query object class Seurat annotated cell types. srt_ref object class Seurat storing reference cells. ref_group character vector specifying column name `srt_ref` metadata represents cell grouping. query_assay character vector specifying assay used query data. Defaults default assay `srt_query` object. ref_assay character vector specifying assay used reference data. Defaults default assay `srt_ref` object. method method used scmap analysis. Can \"scmapCluster\" \"scmapCell\". default value \"scmapCluster\". nfeatures number top features selected. default value 500. threshold threshold value similarity determine cell assigned cluster. value 0 1. default value 0.5. k Number clusters per group k-means clustering method \"scmapCell\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunScmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate single cells using scmap. — RunScmap","text":"","code":"data(\"panc8_sub\") # Simply convert genes from human to mouse and preprocess the data genenames <- make.unique(capitalize(rownames(panc8_sub), force_tolower = TRUE)) #> Error in capitalize(rownames(panc8_sub), force_tolower = TRUE): could not find function \"capitalize\" panc8_sub <- RenameFeatures(panc8_sub, newnames = genenames) #> Error: object 'genenames' not found panc8_sub <- check_srtMerge(panc8_sub, batch = \"tech\")[[\"srtMerge\"]] #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> [2025-09-07 20:37:34.271259] Spliting srtMerge into srtList by column tech... ... #> [2025-09-07 20:37:34.429384] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector  # Annotation data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:37:35.590627] Start Standard_SCP #> [2025-09-07 20:37:35.590813] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunScmap(   srt_query = pancreas_sub, srt_ref = panc8_sub,   ref_group = \"celltype\", method = \"scmapCluster\" ) #> Error in check_R(\"scmap\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"scmap_annotation\") #> Error in CellDimPlot(pancreas_sub, group.by = \"scmap_annotation\"): scmap_annotation is not in the meta.data of srt object.  pancreas_sub <- RunScmap(   srt_query = pancreas_sub, srt_ref = panc8_sub,   ref_group = \"celltype\", method = \"scmapCell\" ) #> Error in check_R(\"scmap\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"scmap_annotation\") #> Error in CellDimPlot(pancreas_sub, group.by = \"scmap_annotation\"): scmap_annotation is not in the meta.data of srt object."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSeuratMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell reference mapping with Seurat method — RunSeuratMap","title":"Single-cell reference mapping with Seurat method — RunSeuratMap","text":"Single-cell reference mapping Seurat method","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSeuratMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell reference mapping with Seurat method — RunSeuratMap","text":"","code":"RunSeuratMap(   srt_query,   srt_ref,   query_assay = NULL,   ref_assay = srt_ref[[ref_pca]]@assay.used,   ref_pca = NULL,   ref_dims = 1:30,   ref_umap = NULL,   ref_group = NULL,   normalization.method = \"LogNormalize\",   reduction_project_method = \"pcaproject\",   k.anchor = 5,   k.filter = 200,   k.score = 30,   k.weight = 100,   projection_method = c(\"model\", \"knn\"),   nn_method = NULL,   k = 30,   distance_metric = \"cosine\",   vote_fun = \"mean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSeuratMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-cell reference mapping with Seurat method — RunSeuratMap","text":"srt_query object class Seurat storing query cells. srt_ref object class Seurat storing reference cells. query_assay character string specifying assay name query cells. provided, default assay query object used. ref_assay character string specifying assay name reference cells. provided, default assay reference object used. ref_pca character string specifying name PCA reduction reference object use calculating distance metric. ref_dims numeric vector specifying dimension indices reference reduction used calculating distance metric. ref_umap character string specifying name UMAP reduction reference object. provided, first UMAP reduction found reference object used. ref_group character string specifying metadata column name reference object use grouping. normalization.method normalization method use. Default \"LogNormalize\". reduction_project_method Dimensional reduction perform finding anchors. Default \"pcaproject\". k.anchor many neighbors (k) use finding anchors. Default 5. k.filter many neighbors (k) use filtering anchors. Set NA turn filtering. Default 200. k.score many neighbors (k) use scoring anchors. Default 30. k.weight Number neighbors consider weighting anchors. Default 100. projection_method character string specifying projection method use. Options \"model\" \"knn\". \"model\" selected, function try use pre-trained UMAP model reference object projection. \"knn\" selected, function directly find nearest neighbors using distance metric. nn_method character string specifying nearest neighbor search method use. Options \"raw\", \"annoy\", \"rann\". \"raw\" selected, function use brute-force method find nearest neighbors. \"annoy\" selected, function use Annoy library approximate nearest neighbor search. \"rann\" selected, function use RANN library approximate nearest neighbor search. provided, function choose search method based size query reference datasets. k integer specifying number nearest neighbors find cell query object. distance_metric character string specifying distance metric use calculating pairwise distances cells. Options include: \"pearson\", \"spearman\", \"cosine\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". Additional distance metrics can also used, \"euclidean\", \"manhattan\", \"hamming\", etc. vote_fun character string specifying function used aggregating nearest neighbors reference object. Options \"mean\", \"median\", \"sum\", \"min\", \"max\", \"sd\", \"var\", etc. provided, default \"mean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSeuratMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-cell reference mapping with Seurat method — RunSeuratMap","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"Seurat\") #> [2025-09-07 20:37:37.381078] Start Seurat_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunSeuratMap(srt_query = srt_query, srt_ref = srt_ref, ref_pca = \"Seuratpca\", ref_umap = \"SeuratUMAP2D\", k.weight = 50) #> Error in srt_ref[[ref_pca]]: ‘Seuratpca’ not found in this Seurat object #>   ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSingleR.html","id":null,"dir":"Reference","previous_headings":"","what":"Annotate single cells using SingleR — RunSingleR","title":"Annotate single cells using SingleR — RunSingleR","text":"Annotate single cells using SingleR","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSingleR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Annotate single cells using SingleR — RunSingleR","text":"","code":"RunSingleR(   srt_query,   srt_ref,   query_group = NULL,   ref_group = NULL,   query_assay = \"RNA\",   ref_assay = \"RNA\",   genes = \"de\",   de.method = \"wilcox\",   sd.thresh = 1,   de.n = NULL,   aggr.ref = FALSE,   aggr.args = list(),   quantile = 0.8,   fine.tune = TRUE,   tune.thresh = 0.05,   prune = TRUE,   BPPARAM = BiocParallel::bpparam() )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSingleR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Annotate single cells using SingleR — RunSingleR","text":"srt_query object class Seurat annotated cell types. srt_ref object class Seurat storing reference cells. query_group character vector specifying column name `srt_query` metadata represents cell grouping. ref_group character vector specifying column name `srt_ref` metadata represents cell grouping. query_assay character vector specifying assay used query data. Defaults default assay `srt_query` object. ref_assay character vector specifying assay used reference data. Defaults default assay `srt_ref` object. genes \"genes\" parameter SingleR function. de.method \"de.method\" parameter SingleR function. sd.thresh Deprecated ignored. de.n integer scalar specifying number DE genes use genes=\"de\". de.method=\"classic\", defaults 500 * (2/3) ^ log2(N) N number unique labels. Otherwise, defaults 10. Ignored genes list markers/DE genes. aggr.ref, aggr.args Arguments controlling aggregation references prior annotation, see trainSingleR. BPPARAM BiocParallelParam object specifying parallelization performed steps, see ?trainSingleR ?classifySingleR details.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSingleR.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Annotate single cells using SingleR — RunSingleR","text":"","code":"data(\"panc8_sub\") # Simply convert genes from human to mouse and preprocess the data genenames <- make.unique(capitalize(rownames(panc8_sub), force_tolower = TRUE)) #> Error in capitalize(rownames(panc8_sub), force_tolower = TRUE): could not find function \"capitalize\" panc8_sub <- RenameFeatures(panc8_sub, newnames = genenames) #> Error: object 'genenames' not found panc8_sub <- check_srtMerge(panc8_sub, batch = \"tech\")[[\"srtMerge\"]] #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> [2025-09-07 20:37:39.433635] Spliting srtMerge into srtList by column tech... ... #> [2025-09-07 20:37:39.60897] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector  # Annotation data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:37:41.631639] Start Standard_SCP #> [2025-09-07 20:37:41.631825] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunSingleR(   srt_query = pancreas_sub, srt_ref = panc8_sub,   query_group = \"Standardclusters\", ref_group = \"celltype\", ) #> Error in check_R(\"SingleR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"singler_annotation\") #> Error in CellDimPlot(pancreas_sub, group.by = \"singler_annotation\"): singler_annotation is not in the meta.data of srt object.  pancreas_sub <- RunSingleR(   srt_query = pancreas_sub, srt_ref = panc8_sub,   query_group = NULL, ref_group = \"celltype\" ) #> Error in check_R(\"SingleR\"): could not find function \"check_R\" CellDimPlot(pancreas_sub, group.by = \"singler_annotation\") #> Error in CellDimPlot(pancreas_sub, group.by = \"singler_annotation\"): singler_annotation is not in the meta.data of srt object."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSlingshot.html","id":null,"dir":"Reference","previous_headings":"","what":"RunSlingshot — RunSlingshot","title":"RunSlingshot — RunSlingshot","text":"Runs Slingshot algorithm Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSlingshot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RunSlingshot — RunSlingshot","text":"","code":"RunSlingshot(   srt,   group.by,   reduction = NULL,   dims = NULL,   start = NULL,   end = NULL,   prefix = NULL,   reverse = FALSE,   align_start = FALSE,   show_plot = TRUE,   lineage_palette = \"Dark2\",   seed = 11,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSlingshot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RunSlingshot — RunSlingshot","text":"srt Seurat object. group.variable group cells . reduction reduction technique use dimensionality reduction. Default NULL, uses default reduction Seurat object. dims dimensions use Slingshot algorithm. Default NULL, uses first two dimensions. start starting group Slingshot algorithm. Default NULL. end ending group Slingshot algorithm. Default NULL. prefix prefix add column names resulting pseudotime variable. Default NULL. reverse Logical value indicating whether reverse pseudotime variable. Default FALSE. align_start Logical value indicating whether align starting pseudotime values maximum pseudotime. Default FALSE. show_plot Logical value indicating whether show dimensionality plot. Default TRUE. lineage_palette color palette use lineages plot. Default \"Dark2\". seed random seed use reproducibility. Default 11. ... Additional arguments passed slingshot function.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSlingshot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RunSlingshot — RunSlingshot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"PCA\", dims = 1:10) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:2), lineages_span = 0.1) #> Error in CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\",     lineages = paste0(\"Lineage\", 1:2), lineages_span = 0.1): Lineage1 is not in the meta.data of srt object.  # 3D lineage pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:37:47.273515] Start Standard_SCP #> [2025-09-07 20:37:47.273674] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector pancreas_sub <- RunSlingshot(pancreas_sub, group.by = \"SubCellType\", reduction = \"StandardpcaUMAP3D\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Warning: Removed 8 rows containing missing values or values outside the scale range (`geom_path()`). #> Error in gtable_add_grob(gtable, grob, t = mean(gtable$layout[grep(\"panel\",     gtable$layout$name), \"t\"]), l = dim(gtable)[2], clip = clip): `grobs` must be a single grob or a list of grobs, not a list matrix. CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\", lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1, lineages_trim = c(0.05, 0.95)) #> Error in CellDimPlot(pancreas_sub, group.by = \"SubCellType\", reduction = \"UMAP\",     lineages = paste0(\"Lineage\", 1:3), lineages_span = 0.1, lineages_trim = c(0.05,         0.95)): Lineage1 is not in the meta.data of srt object."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSymphonyMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-cell reference mapping with Symphony method — RunSymphonyMap","title":"Single-cell reference mapping with Symphony method — RunSymphonyMap","text":"Single-cell reference mapping Symphony method","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSymphonyMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-cell reference mapping with Symphony method — RunSymphonyMap","text":"","code":"RunSymphonyMap(   srt_query,   srt_ref,   query_assay = NULL,   ref_assay = srt_ref[[ref_pca]]@assay.used,   ref_pca = NULL,   ref_harmony = NULL,   ref_umap = NULL,   ref_group = NULL,   projection_method = c(\"model\", \"knn\"),   nn_method = NULL,   k = 30,   distance_metric = \"cosine\",   vote_fun = \"mean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSymphonyMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Single-cell reference mapping with Symphony method — RunSymphonyMap","text":"srt_query object class Seurat storing query cells. srt_ref object class Seurat storing reference cells. query_assay character string specifying assay name query cells. provided, default assay query object used. ref_assay character string specifying assay name reference cells. provided, default assay reference object used. ref_pca character string specifying name PCA reduction reference object use calculating distance metric. ref_harmony character string specifying name Harmony reduction reference object use calculating distance metric. ref_umap character string specifying name UMAP reduction reference object. provided, first UMAP reduction found reference object used. ref_group character string specifying metadata column name reference object use grouping. projection_method character string specifying projection method use. Options \"model\" \"knn\". \"model\" selected, function try use pre-trained UMAP model reference object projection. \"knn\" selected, function directly find nearest neighbors using distance metric. nn_method character string specifying nearest neighbor search method use. Options \"raw\", \"annoy\", \"rann\". \"raw\" selected, function use brute-force method find nearest neighbors. \"annoy\" selected, function use Annoy library approximate nearest neighbor search. \"rann\" selected, function use RANN library approximate nearest neighbor search. provided, function choose search method based size query reference datasets. k integer specifying number nearest neighbors find cell query object. distance_metric character string specifying distance metric use calculating pairwise distances cells. Options include: \"pearson\", \"spearman\", \"cosine\", \"correlation\", \"jaccard\", \"ejaccard\", \"dice\", \"edice\", \"hamman\", \"simple matching\", \"faith\". Additional distance metrics can also used, \"euclidean\", \"manhattan\", \"hamming\", etc. vote_fun character string specifying function used aggregating nearest neighbors reference object. Options \"mean\", \"median\", \"sum\", \"min\", \"max\", \"sd\", \"var\", etc. provided, default \"mean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunSymphonyMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-cell reference mapping with Symphony method — RunSymphonyMap","text":"","code":"data(\"panc8_sub\") srt_ref <- panc8_sub[, panc8_sub$tech != \"fluidigmc1\"] srt_query <- panc8_sub[, panc8_sub$tech == \"fluidigmc1\"] srt_ref <- Integration_SCP(srt_ref, batch = \"tech\", integration_method = \"Harmony\") #> [2025-09-07 20:37:50.76777] Start Harmony_integrate #> Error in invoke(.fn = paste0(integration_method, \"_integrate\"), .args = args[names(args) %in%     formalArgs(paste0(integration_method, \"_integrate\"))]): could not find function \"invoke\" CellDimPlot(srt_ref, group.by = c(\"celltype\", \"tech\")) #> Error in DefaultReduction(srt): Unable to find any reductions.  # Projection srt_query <- RunSymphonyMap(srt_query = srt_query, srt_ref = srt_ref, ref_pca = \"Harmonypca\", ref_harmony = \"Harmony\", ref_umap = \"HarmonyUMAP2D\") #> Error in check_R(\"immunogenomics/symphony\"): could not find function \"check_R\" ProjectionPlot(srt_query = srt_query, srt_ref = srt_ref, query_group = \"celltype\", ref_group = \"celltype\") #> Error in srt_query[[query_reduction]]: ‘ref.embeddings’ not found in this Seurat object #>"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunTriMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets) — RunTriMap","title":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets) — RunTriMap","text":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunTriMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets) — RunTriMap","text":"","code":"RunTriMap(object, ...)  # S3 method for class 'Seurat' RunTriMap(   object,   reduction = \"pca\",   dims = NULL,   features = NULL,   assay = NULL,   layer = \"data\",   n_components = 2,   n_inliers = 12,   n_outliers = 4,   n_random = 3,   distance_method = \"euclidean\",   lr = 0.1,   n_iters = 400,   apply_pca = TRUE,   opt_method = \"dbd\",   reduction.name = \"trimap\",   reduction.key = \"TriMap_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunTriMap(   object,   assay = NULL,   n_components = 2,   n_inliers = 12,   n_outliers = 4,   n_random = 3,   distance_method = \"euclidean\",   lr = 0.1,   n_iters = 400,   apply_pca = TRUE,   opt_method = \"dbd\",   reduction.key = \"TriMap_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunTriMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets) — RunTriMap","text":"object object. can Seurat object matrix-like object. ... Additional arguments passed trimap.TRIMAP function. reduction character string specifying reduction used. Default \"pca\". dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". n_components integer specifying number TriMap components. Default 2. n_inliers integer specifying number nearest neighbors forming nearest neighbor triplets. Default 12. n_outliers integer specifying number outliers forming nearest neighbor triplets. Default 4. n_random integer specifying number random triplets per point. Default 3. distance_method character string specifying distance metric TriMap. Options : \"euclidean\", \"manhattan\", \"angular\", \"cosine\", \"hamming\". Default \"euclidean\". lr numeric value specifying learning rate TriMap. Default 0.1. n_iters integer specifying number iterations TriMap. Default 400. apply_pca logical value indicating whether apply PCA nearest-neighbor calculation. Default TRUE. opt_method character string specifying optimization method TriMap. Options : \"dbd\", \"sd\", \"momentum\". Default \"dbd\". reduction.name character string specifying name reduction stored Seurat object. Default \"trimap\". reduction.key character string specifying prefix column names TriMap embeddings. Default \"TriMap_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunTriMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run TriMap (Large-scale Dimensionality Reduction Using Triplets) — RunTriMap","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunTriMap(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> Error in check_Python(\"trimap\"): could not find function \"check_Python\" CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"trimap\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunUMAP2.html","id":null,"dir":"Reference","previous_headings":"","what":"Run UMAP (Uniform Manifold Approximation and Projection) — RunUMAP2","title":"Run UMAP (Uniform Manifold Approximation and Projection) — RunUMAP2","text":"Run UMAP (Uniform Manifold Approximation Projection)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunUMAP2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run UMAP (Uniform Manifold Approximation and Projection) — RunUMAP2","text":"","code":"RunUMAP2(object, ...)  # S3 method for class 'Seurat' RunUMAP2(   object,   reduction = \"pca\",   dims = NULL,   features = NULL,   neighbor = NULL,   graph = NULL,   assay = NULL,   layer = \"data\",   umap.method = \"uwot\",   reduction.model = NULL,   n_threads = NULL,   return.model = FALSE,   n.neighbors = 30L,   n.components = 2L,   metric = \"cosine\",   n.epochs = 200L,   spread = 1,   min.dist = 0.3,   set.op.mix.ratio = 1,   local.connectivity = 1L,   negative.sample.rate = 5L,   a = NULL,   b = NULL,   learning.rate = 1,   repulsion.strength = 1,   reduction.name = \"umap\",   reduction.key = \"UMAP_\",   verbose = TRUE,   seed.use = 11L,   ... )  # Default S3 method RunUMAP2(   object,   assay = NULL,   umap.method = \"uwot\",   reduction.model = NULL,   n_threads = NULL,   return.model = FALSE,   n.neighbors = 30L,   n.components = 2L,   metric = \"cosine\",   n.epochs = 200L,   spread = 1,   min.dist = 0.3,   set.op.mix.ratio = 1,   local.connectivity = 1L,   negative.sample.rate = 5L,   a = NULL,   b = NULL,   learning.rate = 1,   repulsion.strength = 1,   reduction.key = \"UMAP_\",   verbose = TRUE,   seed.use = 11L,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunUMAP2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run UMAP (Uniform Manifold Approximation and Projection) — RunUMAP2","text":"object object. can Seurat object, matrix-like object, Neighbor object, Graph object. ... Unused argument. reduction character string specifying reduction used. Default \"pca\". dims integer vector specifying dimensions used. Default NULL. features character vector specifying features used. Default NULL. neighbor character string specifying name Neighbor object used. Default NULL. graph character string specifying name Graph object used. Default NULL. assay character string specifying assay used. Default NULL. layer character string specifying layer name used. Default \"data\". umap.method character string specifying UMAP method used. Options \"naive\" uwot\". Default \"uwot\". reduction.model DimReduc object containing pre-trained UMAP model. Default NULL. return.model logical value indicating whether return UMAP model. Default FALSE. n.neighbors integer specifying number nearest neighbors used. Default 30. n.components integer specifying number UMAP components. Default 2. metric character string specifying metric function used distance calculations. using string, available metrics : euclidean, manhattan. available generalized metrics : cosine, pearson, pearson2. Note triangle inequality may satisfied generalized metrics, hence knn search may optimal. using metric.function function, signature must function(matrix, origin, target) compute distance origin column target columns.  Default \"cosine\". n.epochs integer specifying number iterations performed layout optimization UMAP. Default 200. spread numeric value specifying spread parameter UMAP, used automatic estimation /b parameters. Default 1. min.dist numeric value specifying minimum distance UMAP embeddings, determines close points appear final layout. Default 0.3. set.op.mix.ratio Interpolate (fuzzy) union intersection set operation used combine local fuzzy simplicial sets obtain global fuzzy simplicial sets. fuzzy set operations use product t-norm. value parameter 0.0 1.0; value 1.0 use pure fuzzy union, 0.0 use pure fuzzy intersection. local.connectivity integer specifying local connectivity, used construction fuzzy simplicial set. Default 1. negative.sample.rate integer specifying negative sample rate UMAP optimization. Determines many non-neighbor points used per point per iteration layout optimization. Default 5. numeric value specifying parameter UMAP optimization. Contributes gradient calculations layout optimization. left NA, suitable value estimated automatically. Default NULL. b numeric value specifying parameter b UMAP optimization. Contributes gradient calculations layout optimization. left NA, suitable value estimated automatically. Default NULL. learning.rate numeric value specifying initial value \"learning rate\" layout optimization. Default 1. repulsion.strength numeric value determines, together alpha, learning rate layout optimization. Default 1. reduction.name character string specifying name reduction stored Seurat object. Default \"umap\". reduction.key character string specifying prefix column names UMAP embeddings. Default \"UMAP_\". verbose logical value indicating whether print verbose output. Default TRUE. seed.use integer specifying random seed used. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunUMAP2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run UMAP (Uniform Manifold Approximation and Projection) — RunUMAP2","text":"","code":"pancreas_sub <- Seurat::FindVariableFeatures(pancreas_sub) pancreas_sub <- RunUMAP2(object = pancreas_sub, features = Seurat::VariableFeatures(pancreas_sub)) #> 20:37:52 UMAP embedding parameters a = 0.9922 b = 1.112 #> 20:37:52 Read 1000 rows and found 2000 numeric columns #> 20:37:52 Using Annoy for neighbor search, n_neighbors = 30 #> 20:37:52 Building Annoy index with metric = cosine, n_trees = 50 #> 0%   10   20   30   40   50   60   70   80   90   100% #> [----|----|----|----|----|----|----|----|----|----| #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> * #> | #> 20:37:53 Writing NN index file to temp file /tmp/RtmpjBcsfb/file254e6ec0fb7a #> 20:37:53 Searching Annoy index using 2 threads, search_k = 3000 #> 20:37:53 Annoy recall = 100% #> 20:37:54 Commencing smooth kNN distance calibration using 2 threads #>  with target n_neighbors = 30 #> 20:37:56 Initializing from normalized Laplacian + noise (using RSpectra) #> 20:37:56 Commencing optimization for 200 epochs, with 40796 positive edges #> 20:37:56 Using rng type: pcg #> 20:37:57 Optimization finished CellDimPlot(pancreas_sub, group.by = \"CellType\", reduction = \"umap\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunWOT.html","id":null,"dir":"Reference","previous_headings":"","what":"Run WOT analysis — RunWOT","title":"Run WOT analysis — RunWOT","text":"Run WOT analysis","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunWOT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run WOT analysis — RunWOT","text":"","code":"RunWOT(   srt = NULL,   assay_X = \"RNA\",   slot_X = \"counts\",   assay_layers = c(\"spliced\", \"unspliced\"),   slot_layers = \"counts\",   adata = NULL,   group_by = NULL,   time_field = \"Time\",   growth_iters = 3L,   tmap_out = \"tmaps/tmap_out\",   time_from = NULL,   time_to = NULL,   get_coupling = FALSE,   recalculate = FALSE,   palette = \"Paired\",   palcolor = NULL,   show_plot = TRUE,   save = FALSE,   dpi = 300,   dirpath = \"./\",   fileprefix = \"\",   return_seurat = !is.null(srt) )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/RunWOT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run WOT analysis — RunWOT","text":"srt Seurat object. assay_X Assay convert main data matrix (X) anndata object. slot_X Slot name assay_X Seurat object. assay_layers Assays convert layers anndata object. slot_layers Slot names assay_layers Seurat object. adata anndata object. group_by Variable use grouping cells Seurat object. time_field character string specifying column name `adata.obs` `srt@meta.data` contains time information. growth_iters integer specifying number growth iterations perform OT Model computation. Default 3. tmap_out character string specifying path store computed transport maps. time_from numeric value specifying starting time point trajectory fate analysis. time_to numeric value specifying ending time point trajectory fate analysis. provided, trajectory fate analysis specified `time_from` performed. get_coupling logical value indicating whether compute store coupling matrix specified `time_from` `time_to`. Default FALSE. recalculate logical value indicating whether recalculate transport maps even already exist specified `tmap_out` location. Default FALSE. palette palette use coloring cells. palcolor vector colors use palette. show_plot Whether show PAGA plot. save Whether save PAGA plots. dpi DPI (dots per inch) saving PAGA plot. dirpath directory save PAGA plots. fileprefix file prefix use PAGA plots. return_seurat Whether return Seurat object instead anndata object. Default TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Scanorama_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Scanorama_integrate — Scanorama_integrate","title":"Scanorama_integrate — Scanorama_integrate","text":"Scanorama_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Scanorama_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scanorama_integrate — Scanorama_integrate","text":"","code":"Scanorama_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   Scanorama_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   return_corrected = FALSE,   Scanorama_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Scanorama_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scanorama_integrate — Scanorama_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). Scanorama_dims_use vector specifying dimensions returned Scanorama utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). return_corrected Logical indicating whether return corrected data. Default FALSE. Scanorama_params list parameters scanorama.correct function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Seurat_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Seurat_integrate — Seurat_integrate","title":"Seurat_integrate — Seurat_integrate","text":"Seurat_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Seurat_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Seurat_integrate — Seurat_integrate","text":"","code":"Seurat_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   FindIntegrationAnchors_params = list(),   IntegrateData_params = list(),   IntegrateEmbeddings_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Seurat_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Seurat_integrate — Seurat_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). FindIntegrationAnchors_params list parameters Seurat::FindIntegrationAnchors function, default empty list. IntegrateData_params list parameters Seurat::IntegrateData function, default empty list. IntegrateEmbeddings_params list parameters Seurat::IntegrateEmbeddings function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtAppend.html","id":null,"dir":"Reference","previous_headings":"","what":"Append a Seurat object to another — SrtAppend","title":"Append a Seurat object to another — SrtAppend","text":"Append Seurat object another","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtAppend.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append a Seurat object to another — SrtAppend","text":"","code":"SrtAppend(   srt_raw,   srt_append,   layers = layerNames(srt_append),   pattern = NULL,   overwrite = FALSE,   verbose = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtAppend.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Append a Seurat object to another — SrtAppend","text":"srt_raw Seurat object appended. srt_append New Seurat object append. layers layers names. pattern character string containing regular expression. data matching names considered appending. overwrite Whether overwrite. verbose Show messages.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtReorder.html","id":null,"dir":"Reference","previous_headings":"","what":"Reorder idents by the gene expression — SrtReorder","title":"Reorder idents by the gene expression — SrtReorder","text":"Reorder idents gene expression","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtReorder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reorder idents by the gene expression — SrtReorder","text":"","code":"SrtReorder(   srt,   features = NULL,   reorder_by = NULL,   layer = \"data\",   assay = NULL,   log = TRUE,   distance_metric = \"euclidean\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/SrtReorder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reorder idents by the gene expression — SrtReorder","text":"srt Seurat object. features Features used reorder idents. reorder_by Reorder groups instead idents. layer Specific layer get data . assay Specific assay get data . log Whether log1p transformation needs applied. Default TRUE. distance_metric Metric compute distance. Default \"euclidean\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Standard_SCP.html","id":null,"dir":"Reference","previous_headings":"","what":"Standard SCP — Standard_SCP","title":"Standard SCP — Standard_SCP","text":"function performs standard single-cell analysis workflow.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Standard_SCP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standard SCP — Standard_SCP","text":"","code":"Standard_SCP(   srt,   prefix = \"Standard\",   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_method = \"vst\",   nHVF = 2000,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Standard_SCP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standard SCP — Standard_SCP","text":"srt Seurat object. prefix prefix add names intermediate objects created function (default \"Standard\"). assay name assay use analysis. NULL, default assay Seurat object used. do_normalization logical value indicating whether perform normalization. NULL, normalization performed specified assay scaled data. normalization_method method use normalization. Options \"LogNormalize\", \"SCT\", \"TFIDF\" (default \"LogNormalize\"). do_HVF_finding logical value indicating whether perform high variable feature finding. TRUE, function force find highly variable features (HVF) using specified HVF method. HVF_method method use finding highly variable features. Options \"vst\", \"mvp\" \"disp\" (default \"vst\"). nHVF number highly variable features select. NULL, highly variable features used. HVF vector feature names use highly variable features. NULL, function use highly variable features identified HVF method. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector feature names use regressors scaling step. NULL, regressors used. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). seed random seed use reproducibility (default 11).","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Standard_SCP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standard SCP — Standard_SCP","text":"Seurat object.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Standard_SCP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Standard SCP — Standard_SCP","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- Standard_SCP(pancreas_sub) #> [2025-09-07 20:38:00.095111] Start Standard_SCP #> [2025-09-07 20:38:00.095316] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, group.by = \"SubCellType\") #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   # Use a combination of different linear or non-linear dimension reduction methods linear_reductions <- c(\"pca\", \"ica\", \"nmf\", \"mds\", \"glmpca\") pancreas_sub <- Standard_SCP(   pancreas_sub,   linear_reduction = linear_reductions,   nonlinear_reduction = \"umap\" ) #> [2025-09-07 20:38:00.727585] Start Standard_SCP #> [2025-09-07 20:38:00.727729] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector plist1 <- lapply(linear_reductions, function(lr) {   CellDimPlot(pancreas_sub,     group.by = \"SubCellType\",     reduction = paste0(\"Standard\", lr, \"UMAP2D\"),     xlab = \"\", ylab = \"\", title = lr,     legend.position = \"none\",     theme_use = \"theme_blank\"   ) }) patchwork::wrap_plots(plotlist = plist1) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values.   nonlinear_reductions <- c(\"umap\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\") pancreas_sub <- Standard_SCP(   pancreas_sub,   linear_reduction = \"pca\",   nonlinear_reduction = nonlinear_reductions ) #> [2025-09-07 20:38:01.885758] Start Standard_SCP #> [2025-09-07 20:38:01.885904] Checking srtList... ... #> Warning: Failed to check Seurat version compatibility: 'list' object cannot be coerced to type 'double' #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector plist2 <- lapply(nonlinear_reductions, function(nr) {   CellDimPlot(pancreas_sub,     group.by = \"SubCellType\",     reduction = paste0(\"Standardpca\", toupper(nr), \"2D\"),     xlab = \"\", ylab = \"\", title = nr,     legend.position = \"none\",     theme_use = \"theme_blank\"   ) }) patchwork::wrap_plots(plotlist = plist2) #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values. #> Warning: No shared levels found between `names(values)` of the manual scale and the data's fill values."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/StatPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"StatPlot — StatPlot","title":"StatPlot — StatPlot","text":"Visualizes data using various plot types bar plots, rose plots, ring plots, pie charts, trend plots, area plots, dot plots, sankey plots, chord plots, venn diagrams, upset plots.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/StatPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"StatPlot — StatPlot","text":"","code":"StatPlot(   meta.data,   stat.by,   group.by = NULL,   split.by = NULL,   bg.by = NULL,   flip = FALSE,   NA_color = \"grey\",   NA_stat = TRUE,   keep_empty = FALSE,   individual = FALSE,   stat_level = NULL,   plot_type = c(\"bar\", \"rose\", \"ring\", \"pie\", \"trend\", \"area\", \"dot\", \"sankey\", \"chord\",     \"venn\", \"upset\"),   stat_type = c(\"percent\", \"count\"),   position = c(\"stack\", \"dodge\"),   palette = \"Paired\",   palcolor = NULL,   alpha = 1,   bg_palette = \"Paired\",   bg_palcolor = NULL,   bg_alpha = 0.2,   label = FALSE,   label.size = 3.5,   label.fg = \"black\",   label.bg = \"white\",   label.bg.r = 0.1,   aspect.ratio = NULL,   title = NULL,   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE,   force = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/StatPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"StatPlot — StatPlot","text":"meta.data data frame containing data plotted. stat.column name(s) meta.data specifying variable(s) plotted. group.column name meta.data specifying grouping variable. split.column name meta.data specifying splitting variable. bg.column name meta.data specifying background variable bar plots. flip Logical indicating whether flip plot. NA_color color use missing values. NA_stat Logical indicating whether include missing values plot. keep_empty Logical indicating whether keep empty groups plot. individual Logical indicating whether plot individual groups separately. stat_level level(s) variable(s) specified stat.include plot. plot_type type plot create. Can one \"bar\", \"rose\", \"ring\", \"pie\", \"trend\", \"area\", \"dot\", \"sankey\", \"chord\", \"venn\", \"upset\". stat_type type statistic compute plot. Can one \"percent\" \"count\". position position adjustment plot. Can one \"stack\" \"dodge\". palette name color palette use plot. palcolor color use color palette. alpha transparency level plot. bg_palette name background color palette use bar plots. bg_palcolor color use background color palette. bg_alpha transparency level background color bar plots. label Logical indicating whether add labels plot. label.size size labels. label.fg foreground color labels. label.bg background color labels. label.bg.r radius rounded corners label background. aspect.ratio aspect ratio plot. title main title plot. subtitle subtitle plot. xlab x-axis label plot. ylab y-axis label plot. legend.position position legend plot. Can one \"right\", \"left\", \"bottom\", \"top\", \"none\". legend.direction direction legend plot. Can one \"vertical\" \"horizontal\". theme_use name theme use plot. Can one predefined themes custom theme. theme_args list arguments passed theme function. combine Logical indicating whether combine multiple plots single plot. nrow number rows combined plot. ncol number columns combined plot. byrow Logical indicating whether fill plot row column. force Logical indicating whether force plot even variables 100 levels. seed random seed use reproducible results.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/StatPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"StatPlot — StatPlot","text":"","code":"data(\"pancreas_sub\") head(pancreas_sub@meta.data) #>                     orig.ident nCount_RNA nFeature_RNA     S_score   G2M_score nCount_spliced nFeature_spliced #> CAGCCGAAGCGATATA SeuratProject      10653         3295  0.33188155  0.54532743          10653             3295 #> AGTGTCATCGCCGTGA SeuratProject       4596         2053 -0.07156909 -0.08865353           4596             2053 #> GATGAAAAGTTGTAGA SeuratProject      14091         3864  0.08940628  0.77610326          14091             3864 #> CACAGTACATCCGTGG SeuratProject       5484         2510 -0.25927997 -0.25941831           5484             2510 #> CGGAGCTCATTGGGCC SeuratProject       7357         2674 -0.11764368  0.46237856           7357             2674 #> AGAGCTTGTGTGACCC SeuratProject       6498         2516 -0.11406432 -0.17830831           6498             2516 #>                  nCount_unspliced nFeature_unspliced      CellType   SubCellType Phase #> CAGCCGAAGCGATATA             1587               1063        Ductal        Ductal   G2M #> AGTGTCATCGCCGTGA             1199                803 Pre-endocrine Pre-endocrine    G1 #> GATGAAAAGTTGTAGA             2166               1379   Ngn3 low EP   Ngn3 low EP   G2M #> CACAGTACATCCGTGG             1339                859     Endocrine          Beta    G1 #> CGGAGCTCATTGGGCC              976                745        Ductal        Ductal   G2M #> AGAGCTTGTGTGACCC              822                591        Ductal        Ductal    G1 StatPlot(pancreas_sub@meta.data, stat.by = \"Phase\", group.by = \"CellType\", plot_type = \"bar\", label = TRUE)   head(pancreas_sub[[\"RNA\"]]@meta.features) #>               highly_variable_genes #> Mrpl15                        False #> Npbwr1                         <NA> #> 4732440D04Rik                 False #> Gm26901                       False #> Sntg1                          True #> Mybl1                         False StatPlot(pancreas_sub[[\"RNA\"]]@meta.features, stat.by = \"highly_variable_genes\", plot_type = \"ring\", label = TRUE) #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_col()`). #> Warning: Removed 1 row containing missing values or values outside the scale range (`geom_text_repel()`).   pancreas_sub <- AnnotateFeatures(pancreas_sub, species = \"Mus_musculus\", IDtype = \"symbol\", db = \"GeneType\") #> Species: Mus_musculus #> Warning: Annotation package org.Mm.eg.db does not exist. #> Warning: Use the human annotation to create the GeneType database for Mus_musculus #> Preparing database: GeneType #> Convert species for the database: GeneType #> Connect to the Ensembl archives... #> Using the 103 version of biomart... #> Connecting to the biomart... #> Searching the dataset hsapiens ... #> Connecting to the dataset hsapiens_gene_ensembl ... #> Converting the geneIDs... #> 25650 genes mapped with entrez_id #> ============================== #> 25650 genes mapped #> 167780 genes unmapped #> ============================== #> Error in unnest(data = geneID_collapse, cols = colnames(geneID_collapse)[sapply(geneID_collapse,     class) %in% c(\"list\", \"AsIs\")], keep_empty = FALSE): could not find function \"unnest\" head(pancreas_sub[[\"RNA\"]]@meta.features) #>               highly_variable_genes #> Mrpl15                        False #> Npbwr1                         <NA> #> 4732440D04Rik                 False #> Gm26901                       False #> Sntg1                          True #> Mybl1                         False StatPlot(pancreas_sub[[\"RNA\"]]@meta.features,   stat.by = \"highly_variable_genes\", group.by = \"GeneType\",   stat_type = \"count\", plot_type = \"bar\", position = \"dodge\", label = TRUE, NA_stat = FALSE ) #> Error in StatPlot(pancreas_sub[[\"RNA\"]]@meta.features, stat.by = \"highly_variable_genes\",     group.by = \"GeneType\", stat_type = \"count\", plot_type = \"bar\",     position = \"dodge\", label = TRUE, NA_stat = FALSE): GeneType is not in the meta.data."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/TestPythonCompatibility.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Python Compatibility — TestPythonCompatibility","title":"Test Python Compatibility — TestPythonCompatibility","text":"Test compatibility different Python versions SCP environment setup. function tests specified Python versions different platforms.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/TestPythonCompatibility.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Python Compatibility — TestPythonCompatibility","text":"","code":"TestPythonCompatibility(   versions = c(\"3.10\", \"3.11\", \"3.12\"),   test_packages = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/TestPythonCompatibility.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Python Compatibility — TestPythonCompatibility","text":"versions Character vector Python versions test. Default c(\"3.10\", \"3.11\", \"3.12\"). test_packages Logical. Whether test package installation. Default TRUE.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Uncorrected_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncorrected_integrate — Uncorrected_integrate","title":"Uncorrected_integrate — Uncorrected_integrate","text":"Uncorrected_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Uncorrected_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncorrected_integrate — Uncorrected_integrate","text":"","code":"Uncorrected_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   do_scaling = TRUE,   vars_to_regress = NULL,   regression_model = \"linear\",   scale_within_batch = FALSE,   linear_reduction = \"pca\",   linear_reduction_dims = 50,   linear_reduction_dims_use = NULL,   linear_reduction_params = list(),   force_linear_reduction = FALSE,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/Uncorrected_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncorrected_integrate — Uncorrected_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. do_scaling logical value indicating whether perform scaling. TRUE, function force scale data using ScaleData function. vars_to_regress vector variable names include additional regression variables. Default NULL. regression_model regression model use scaling. Options \"linear\", \"poisson\", \"negativebinomial\" (default \"linear\"). scale_within_batch Whether scale data within batch. valid integration_method one \"Uncorrected\", \"Seurat\", \"MNN\", \"Harmony\", \"BBKNN\", \"CSS\", \"ComBat\". linear_reduction linear dimensionality reduction method use. Options \"pca\", \"svd\", \"ica\", \"nmf\", \"mds\", \"glmpca\" (default \"pca\"). linear_reduction_dims number dimensions keep linear dimensionality reduction (default 50). linear_reduction_dims_use dimensions use downstream analysis. NULL, dimensions used. linear_reduction_params list parameters pass linear dimensionality reduction method. force_linear_reduction logical value indicating whether force linear dimensionality reduction even specified reduction already present Seurat object. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VelocityPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Velocity Plot — VelocityPlot","title":"Velocity Plot — VelocityPlot","text":"function creates velocity plot given Seurat object. plot shows velocity vectors cells specified reduction space.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VelocityPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Velocity Plot — VelocityPlot","text":"","code":"VelocityPlot(   srt,   reduction,   dims = c(1, 2),   cells = NULL,   velocity = \"stochastic\",   plot_type = c(\"raw\", \"grid\", \"stream\"),   group_by = NULL,   group_palette = \"Paired\",   group_palcolor = NULL,   n_neighbors = ceiling(ncol(srt@assays[[1]])/50),   density = 1,   smooth = 0.5,   scale = 1,   min_mass = 1,   cutoff_perc = 5,   arrow_angle = 20,   arrow_color = \"black\",   streamline_L = 5,   streamline_minL = 1,   streamline_res = 1,   streamline_n = 15,   streamline_width = c(0, 0.8),   streamline_alpha = 1,   streamline_color = NULL,   streamline_palette = \"RdYlBu\",   streamline_palcolor = NULL,   streamline_bg_color = \"white\",   streamline_bg_stroke = 0.5,   aspect.ratio = 1,   title = \"Cell velocity\",   subtitle = NULL,   xlab = NULL,   ylab = NULL,   legend.position = \"right\",   legend.direction = \"vertical\",   theme_use = \"theme_scp\",   theme_args = list(),   return_layer = FALSE,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VelocityPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Velocity Plot — VelocityPlot","text":"srt Seurat object. reduction Name reduction Seurat object use plotting. dims Indices dimensions use plotting. cells Cells include plot. NULL, cells included. velocity Name velocity use plotting. plot_type Type plot create. Can \"raw\", \"grid\", \"stream\". group_by Name column Seurat object metadata group cells . Defaults NULL. group_palette Name palette use coloring groups. Defaults \"Paired\". group_palcolor Colors use coloring groups. Defaults NULL. n_neighbors Number neighbors include density estimation. Defaults ceiling(ncol(srt@assays[[1]]) / 50). density Propotion cells plot. Defaults 1 (plot cells). smooth Smoothing parameter density estimation. Defaults 0.5. scale Scaling factor velocity vectors. Defaults 1. min_mass Minimum mass value density-based cutoff. Defaults 1. cutoff_perc Percentile value density-based cutoff. Defaults 5. arrow_angle Angle arrowheads. Defaults 20. arrow_color Color arrowheads. Defaults \"black\". streamline_L Length streamlines. Defaults 5. streamline_minL Minimum length streamlines. Defaults 1. streamline_res Resolution streamlines. Defaults 1. streamline_n Number streamlines plot. Defaults 15. streamline_width Width streamlines. Defaults c(0, 0.8). streamline_alpha Alpha transparency streamlines. Defaults 1. streamline_color Color streamlines. Defaults NULL. streamline_palette Name palette use coloring streamlines. Defaults \"RdYlBu\". streamline_palcolor Colors use coloring streamlines. Defaults NULL. streamline_bg_color Background color streamlines. Defaults \"white\". streamline_bg_stroke Stroke width streamlines background. Defaults 0.5. aspect.ratio Aspect ratio plot. Defaults 1. title Title plot. Defaults \"Cell velocity\". subtitle Subtitle plot. Defaults NULL. xlab x-axis label. Defaults NULL. ylab y-axis label. Defaults NULL. legend.position Position legend. Defaults \"right\". legend.direction Direction legend. Defaults \"vertical\". theme_use Name theme use plotting. Defaults \"theme_scp\". theme_args List theme arguments customization. Defaults list(). return_layer Whether return plot layers list. Defaults FALSE. seed Random seed reproducibility. Defaults 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VelocityPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Velocity Plot — VelocityPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\", return_seurat = TRUE) #> Python module 'scvelo' is required for velocity analysis but is not installed. #> To install, run: PrepareEnv() and then check_Python('scvelo') #> Error in RunSCVELO(srt = pancreas_sub, group_by = \"SubCellType\", linear_reduction = \"PCA\",     nonlinear_reduction = \"UMAP\", return_seurat = TRUE): Required Python module 'scvelo' is not available. Please install it first. VelocityPlot(pancreas_sub, reduction = \"UMAP\") #> Error in check_R(\"metR\"): could not find function \"check_R\" VelocityPlot(pancreas_sub, reduction = \"UMAP\", group_by = \"SubCellType\") #> Error in check_R(\"metR\"): could not find function \"check_R\" VelocityPlot(pancreas_sub, reduction = \"UMAP\", plot_type = \"grid\") #> Error in check_R(\"metR\"): could not find function \"check_R\" VelocityPlot(pancreas_sub, reduction = \"UMAP\", plot_type = \"stream\") #> Error in check_R(\"metR\"): could not find function \"check_R\" VelocityPlot(pancreas_sub, reduction = \"UMAP\", plot_type = \"stream\", streamline_color = \"black\") #> Error in check_R(\"metR\"): could not find function \"check_R\" VelocityPlot(pancreas_sub, reduction = \"UMAP\", plot_type = \"stream\", streamline_color = \"black\", arrow_color = \"red\") #> Error in check_R(\"metR\"): could not find function \"check_R\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VolcanoPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"VolcanoPlot — VolcanoPlot","title":"VolcanoPlot — VolcanoPlot","text":"Generate volcano plot based differential expression analysis results.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VolcanoPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"VolcanoPlot — VolcanoPlot","text":"","code":"VolcanoPlot(   srt,   group_by = NULL,   test.use = \"wilcox\",   DE_threshold = \"avg_log2FC > 0 & p_val_adj < 0.05\",   x_metric = \"diff_pct\",   palette = \"RdBu\",   palcolor = NULL,   pt.size = 1,   pt.alpha = 1,   cols.highlight = \"black\",   sizes.highlight = 1,   alpha.highlight = 1,   stroke.highlight = 0.5,   nlabel = 5,   features_label = NULL,   label.fg = \"black\",   label.bg = \"white\",   label.bg.r = 0.1,   label.size = 4,   aspect.ratio = NULL,   xlab = x_metric,   ylab = \"-log10(p-adjust)\",   theme_use = \"theme_scp\",   theme_args = list(),   combine = TRUE,   nrow = NULL,   ncol = NULL,   byrow = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VolcanoPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"VolcanoPlot — VolcanoPlot","text":"srt object class `SummarizedExperiment` containing results differential expression analysis. group_by character vector specifying column `srt` group samples . Default `NULL`. test.use character string specifying type statistical test use. Default \"wilcox\". DE_threshold character string specifying threshold differential expression. Default \"avg_log2FC > 0 & p_val_adj < 0.05\". x_metric character string specifying metric use x-axis. Default \"diff_pct\". palette character string specifying color palette use plot. Default \"RdBu\". palcolor character string specifying color palette. Default `NULL`. pt.size numeric value specifying size points. Default 1. pt.alpha numeric value specifying transparency points. Default 1. cols.highlight character string specifying color highlighted points. Default \"black\". sizes.highlight numeric value specifying size highlighted points. Default 1. alpha.highlight numeric value specifying transparency highlighted points. Default 1. stroke.highlight numeric value specifying stroke width highlighted points. Default 0.5. nlabel integer value specifying number labeled points per group. Default 5. features_label character vector specifying feature labels plot. Default `NULL`. label.fg character string specifying color labels' foreground. Default \"black\". label.bg character string specifying color labels' background. Default \"white\". label.bg.r numeric value specifying radius rounding labels' background. Default 0.1. label.size numeric value specifying size labels. Default 4. aspect.ratio numeric value specifying aspect ratio plot. Default `NULL`. xlab character string specifying x-axis label. Default value `x_metric`. ylab character string specifying y-axis label. Default \"-log10(p-adjust)\". theme_use character string specifying theme use plot. Default \"theme_scp\". theme_args list theme arguments pass `theme_use` function. Default empty list. combine logical value indicating whether combine plots group single plot. Default `TRUE`. nrow integer value specifying number rows combined plot. Default `NULL`. ncol integer value specifying number columns combined plot. Default `NULL`. byrow logical value indicating whether arrange plots row combined plot. Default `TRUE`.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/VolcanoPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"VolcanoPlot — VolcanoPlot","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- RunDEtest(pancreas_sub, group_by = \"CellType\", only.pos = FALSE) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector VolcanoPlot(pancreas_sub, group_by = \"CellType\") #> Error in VolcanoPlot(pancreas_sub, group_by = \"CellType\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. VolcanoPlot(pancreas_sub, group_by = \"CellType\", DE_threshold = \"abs(diff_pct) > 0.3 & p_val_adj < 0.05\") #> Error in VolcanoPlot(pancreas_sub, group_by = \"CellType\", DE_threshold = \"abs(diff_pct) > 0.3 & p_val_adj < 0.05\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first. VolcanoPlot(pancreas_sub, group_by = \"CellType\", x_metric = \"avg_log2FC\") #> Error in VolcanoPlot(pancreas_sub, group_by = \"CellType\", x_metric = \"avg_log2FC\"): Cannot find the DEtest result for the group 'CellType'. You may perform RunDEtest first."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adata_to_srt.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert an anndata object to a seurat object using reticulate — adata_to_srt","title":"Convert an anndata object to a seurat object using reticulate — adata_to_srt","text":"Convert anndata object seurat object using reticulate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adata_to_srt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert an anndata object to a seurat object using reticulate — adata_to_srt","text":"","code":"adata_to_srt(adata)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adata_to_srt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert an anndata object to a seurat object using reticulate — adata_to_srt","text":"adata connected python anndata object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adata_to_srt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert an anndata object to a seurat object using reticulate — adata_to_srt","text":"","code":"data(\"pancreas_sub\") adata <- srt_to_adata(pancreas_sub) #> Error in check_Python(c(\"scanpy\", \"numpy\")): could not find function \"check_Python\" adata <- RunPAGA(adata = adata, group_by = \"SubCellType\", linear_reduction = \"PCA\", nonlinear_reduction = \"UMAP\") #> Error in check_Python(\"scanpy\"): could not find function \"check_Python\" srt <- adata_to_srt(adata) #> Error: object 'adata' not found srt #> Error: object 'srt' not found  ### Or convert a h5ad file to Seurat object # library(reticulate) # check_Python(\"scanpy\") # sc <- import(\"scanpy\") # adata <- sc$read_h5ad(\"pancreas.h5ad\") # srt <- adata_to_srt(adata) # srt"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adjcolors.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a color with arbitrary transparency to a fixed color — adjcolors","title":"Convert a color with arbitrary transparency to a fixed color — adjcolors","text":"function takes vector colors alpha level converts colors fixed colors specified alpha level.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adjcolors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a color with arbitrary transparency to a fixed color — adjcolors","text":"","code":"adjcolors(colors, alpha)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adjcolors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a color with arbitrary transparency to a fixed color — adjcolors","text":"colors Color vectors. alpha Alpha level [0,1]","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/adjcolors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a color with arbitrary transparency to a fixed color — adjcolors","text":"","code":"colors <- c(\"red\", \"blue\", \"green\") adjcolors(colors, 0.5) #>        V1        V2        V3  #> \"#FF8080\" \"#8080FF\" \"#80FF80\"  ggplot2::alpha(colors, 0.5) #> [1] \"#FF000080\" \"#0000FF80\" \"#00FF0080\"  show_palettes(list(   \"raw\" = colors,   \"adjcolors\" = adjcolors(colors, 0.5),   \"ggplot2::alpha\" = ggplot2::alpha(colors, 0.5) )) #> All available palettes: #> raw #> adjcolors #> ggplot2::alpha"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/blendcolors.html","id":null,"dir":"Reference","previous_headings":"","what":"Blend colors — blendcolors","title":"Blend colors — blendcolors","text":"function blends list colors using specified blend mode.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/blendcolors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Blend colors — blendcolors","text":"","code":"blendcolors(colors, mode = c(\"blend\", \"average\", \"screen\", \"multiply\"))"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/blendcolors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Blend colors — blendcolors","text":"colors Color vectors. mode Blend mode. One \"blend\", \"average\", \"screen\", \"multiply\".","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/blendcolors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Blend colors — blendcolors","text":"","code":"blend <- c(\"red\", \"green\", blendcolors(c(\"red\", \"green\"), mode = \"blend\")) average <- c(\"red\", \"green\", blendcolors(c(\"red\", \"green\"), mode = \"average\")) screen <- c(\"red\", \"green\", blendcolors(c(\"red\", \"green\"), mode = \"screen\")) multiply <- c(\"red\", \"green\", blendcolors(c(\"red\", \"green\"), mode = \"multiply\")) show_palettes(list(\"blend\" = blend, \"average\" = average, \"screen\" = screen, \"multiply\" = multiply)) #> All available palettes: #> blend #> average #> screen #> multiply"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_DataType.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and report the type of data — check_DataType","title":"Check and report the type of data — check_DataType","text":"function checks type data returns string indicating type data. checks presence infinite values, negative values, whether values floats integers.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_DataType.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and report the type of data — check_DataType","text":"","code":"check_DataType(data = NULL, srt = NULL, layer = \"data\", assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_DataType.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and report the type of data — check_DataType","text":"data input data. provided, extracted 'srt' object. srt object class 'Seurat'. layer layer 'srt' object extract data. Default \"data\". assay assay extract data . provided, default assay used.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_DataType.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and report the type of data — check_DataType","text":"string indicating type data. Possible values : \"raw_counts\", \"log_normalized_counts\", \"raw_normalized_counts\", \"unknown\".","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtList.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and preprocess a list of seurat objects — check_srtList","title":"Check and preprocess a list of seurat objects — check_srtList","text":"function checks preprocesses list seurat objects. performs various checks input, including verification input types, assay type consistency, feature name consistency, batch column consistency. also performs data normalization variable feature finding based specified parameters. Finally, prepares data integration analysis based highly variable features.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtList.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and preprocess a list of seurat objects — check_srtList","text":"","code":"check_srtList(   srtList,   batch,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   vars_to_regress = NULL,   seed = 11,   check_v5 = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtList.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and preprocess a list of seurat objects — check_srtList","text":"srtList list Seurat objects checked preprocessed. batch character string specifying batch variable name. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. vars_to_regress vector variable names include additional regression variables. Default NULL. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtList.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check and preprocess a list of seurat objects — check_srtList","text":"list containing preprocessed seurat objects, highly variable features, assay name, type assay (e.g., \"RNA\" \"Chromatin\").","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtMerge.html","id":null,"dir":"Reference","previous_headings":"","what":"Check and preprocess a merged seurat object — check_srtMerge","title":"Check and preprocess a merged seurat object — check_srtMerge","text":"function checks preprocesses merged seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtMerge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check and preprocess a merged seurat object — check_srtMerge","text":"","code":"check_srtMerge(   srtMerge,   batch = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   vars_to_regress = NULL,   seed = 11,   check_v5 = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/check_srtMerge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check and preprocess a merged seurat object — check_srtMerge","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. vars_to_regress vector variable names include additional regression variables. Default NULL. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/choose_k.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function to choose optimal k for ALRA — choose_k","title":"Helper function to choose optimal k for ALRA — choose_k","text":"Helper function choose optimal k ALRA","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/choose_k.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function to choose optimal k for ALRA — choose_k","text":"","code":"choose_k(d, q = 0.01)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/choose_k.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function to choose optimal k for ALRA — choose_k","text":"d Singular values q Quantile threshold","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/choose_k.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function to choose optimal k for ALRA — choose_k","text":"Optimal k value","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/compute_velocity_on_grid.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute velocity on grid The original python code is on https://github.com/theislab/scvelo/blob/master/scvelo/plotting/velocity_embedding_grid.py — compute_velocity_on_grid","title":"Compute velocity on grid The original python code is on https://github.com/theislab/scvelo/blob/master/scvelo/plotting/velocity_embedding_grid.py — compute_velocity_on_grid","text":"Compute velocity grid original python code https://github.com/theislab/scvelo/blob/master/scvelo/plotting/velocity_embedding_grid.py","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/compute_velocity_on_grid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute velocity on grid The original python code is on https://github.com/theislab/scvelo/blob/master/scvelo/plotting/velocity_embedding_grid.py — compute_velocity_on_grid","text":"","code":"compute_velocity_on_grid(   X_emb,   V_emb,   density = NULL,   smooth = NULL,   n_neighbors = NULL,   min_mass = NULL,   scale = 1,   adjust_for_stream = FALSE,   cutoff_perc = NULL )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/compute_velocity_on_grid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute velocity on grid The original python code is on https://github.com/theislab/scvelo/blob/master/scvelo/plotting/velocity_embedding_grid.py — compute_velocity_on_grid","text":"X_emb matrix dimension n_obs x n_dim specifying embedding coordinates cells. V_emb matrix dimension n_obs x n_dim specifying velocity vectors cells. density optional numeric value specifying density grid points along dimension. Default 1. smooth optional numeric value specifying smoothing factor velocity vectors. Default 0.5. n_neighbors optional numeric value specifying number nearest neighbors grid point. Default ceiling(n_obs / 50). min_mass optional numeric value specifying minimum mass required grid point considered. Default 1. scale optional numeric value specifying scaling factor velocity vectors. Default 1. adjust_for_stream logical value indicating whether adjust velocity vectors streamlines. Default FALSE. cutoff_perc optional numeric value specifying percentile cutoff removing low-density grid points. Default 5.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_DoubletDetection.html","id":null,"dir":"Reference","previous_headings":"","what":"Run doublet-calling with DoubletDetection — db_DoubletDetection","title":"Run doublet-calling with DoubletDetection — db_DoubletDetection","text":"function performs doublet-calling using doubletdetection(python) package Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_DoubletDetection.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run doublet-calling with DoubletDetection — db_DoubletDetection","text":"","code":"db_DoubletDetection(srt, assay = \"RNA\", db_rate = ncol(srt)/1000 * 0.01, ...)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_DoubletDetection.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run doublet-calling with DoubletDetection — db_DoubletDetection","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". db_rate expected doublet rate. Default calculated ncol(srt) / 1000 * 0.01. ... Additional arguments passed doubletdetection.BoostClassifier function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_DoubletDetection.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run doublet-calling with DoubletDetection — db_DoubletDetection","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- db_DoubletDetection(pancreas_sub) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.DoubletDetection_class\") #> Error in CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.DoubletDetection_class\"): db.DoubletDetection_class is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.DoubletDetection_score\") #> Warning: db.DoubletDetection_score are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.DoubletDetection_score\"): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_Scrublet.html","id":null,"dir":"Reference","previous_headings":"","what":"Run doublet-calling with Scrublet — db_Scrublet","title":"Run doublet-calling with Scrublet — db_Scrublet","text":"function performs doublet-calling using scrublet(python) package Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_Scrublet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run doublet-calling with Scrublet — db_Scrublet","text":"","code":"db_Scrublet(srt, assay = \"RNA\", db_rate = ncol(srt)/1000 * 0.01, ...)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_Scrublet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run doublet-calling with Scrublet — db_Scrublet","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". db_rate expected doublet rate. Default calculated ncol(srt) / 1000 * 0.01. ... Additional arguments passed scrublet.Scrublet function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_Scrublet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run doublet-calling with Scrublet — db_Scrublet","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- db_Scrublet(pancreas_sub) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.Scrublet_class\") #> Error in CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.Scrublet_class\"): db.Scrublet_class is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.Scrublet_score\") #> Warning: db.Scrublet_score are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.Scrublet_score\"): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scDblFinder.html","id":null,"dir":"Reference","previous_headings":"","what":"Run doublet-calling with scDblFinder — db_scDblFinder","title":"Run doublet-calling with scDblFinder — db_scDblFinder","text":"function performs doublet-calling using scDblFinder package Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scDblFinder.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run doublet-calling with scDblFinder — db_scDblFinder","text":"","code":"db_scDblFinder(srt, assay = \"RNA\", db_rate = ncol(srt)/1000 * 0.01, ...)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scDblFinder.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run doublet-calling with scDblFinder — db_scDblFinder","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". db_rate expected doublet rate. Default calculated ncol(srt) / 1000 * 0.01. ... Additional arguments passed scDblFinder::scDblFinder function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scDblFinder.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run doublet-calling with scDblFinder — db_scDblFinder","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- db_scDblFinder(pancreas_sub) #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scDblFinder_class\") #> Error in CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scDblFinder_class\"): db.scDblFinder_class is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scDblFinder_score\") #> Warning: db.scDblFinder_score are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scDblFinder_score\"): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scds.html","id":null,"dir":"Reference","previous_headings":"","what":"Run doublet-calling with scds — db_scds","title":"Run doublet-calling with scds — db_scds","text":"function performs doublet-calling using scds package Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run doublet-calling with scds — db_scds","text":"","code":"db_scds(   srt,   assay = \"RNA\",   db_rate = ncol(srt)/1000 * 0.01,   method = c(\"hybrid\", \"cxds\", \"bcds\"),   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run doublet-calling with scds — db_scds","text":"srt Seurat object. assay name assay used doublet-calling. Default \"RNA\". db_rate expected doublet rate. Default calculated ncol(srt) / 1000 * 0.01. method method used doublet-calling. Options \"hybrid\", \"cxds\", \"bcds\". ... Additional arguments passed scds::cxds_bcds_hybrid function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/db_scds.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run doublet-calling with scds — db_scds","text":"","code":"data(\"pancreas_sub\") pancreas_sub <- db_scds(pancreas_sub, method = \"hybrid\") #> Warning: The following arguments are not used: drop #> Warning: The following arguments are not used: drop #> Error in as.vector(data): no method for coercing this S4 class to a vector CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scds_hybrid_class\") #> Error in CellDimPlot(pancreas_sub, reduction = \"umap\", group.by = \"db.scds_hybrid_class\"): db.scds_hybrid_class is not in the meta.data of srt object. FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scds_hybrid_score\") #> Warning: db.scds_hybrid_score are not in the features of srt. #> Error in FeatureDimPlot(pancreas_sub, reduction = \"umap\", features = \"db.scds_hybrid_score\"): There are no valid features present."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/drop_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop all data in the plot (only one observation is kept) — drop_data","title":"Drop all data in the plot (only one observation is kept) — drop_data","text":"Drop data plot (one observation kept)","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/drop_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop all data in the plot (only one observation is kept) — drop_data","text":"","code":"drop_data(p)  # S3 method for class 'ggplot' drop_data(p)  # S3 method for class 'patchwork' drop_data(p)  # Default S3 method drop_data(p)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/drop_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop all data in the plot (only one observation is kept) — drop_data","text":"p patchwork object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/drop_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drop all data in the plot (only one observation is kept) — drop_data","text":"","code":"library(ggplot2) p <- ggplot(data = mtcars, aes(x = mpg, y = wt, colour = cyl)) +   geom_point() +   scale_x_continuous(limits = c(10, 30)) +   scale_y_continuous(limits = c(1, 6)) +   theme_scp() object.size(p) #> 40008 bytes  p_drop <- drop_data(p) object.size(p_drop) #> 34960 bytes  p / p_drop #> Warning: Removed 4 rows containing missing values or values outside the scale range (`geom_point()`)."},{"path":"https://zhanghao-njmu.github.io/SCP/reference/fastMNN_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"fastMNN_integrate — fastMNN_integrate","title":"fastMNN_integrate — fastMNN_integrate","text":"fastMNN_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/fastMNN_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fastMNN_integrate — fastMNN_integrate","text":"","code":"fastMNN_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   fastMNN_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   fastMNN_params = list(),   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/fastMNN_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"fastMNN_integrate — fastMNN_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. fastMNN_dims_use vector specifying dimensions returned fastMNN utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). fastMNN_params list parameters batchelor::fastMNN function, default empty list. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/format_size.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove environment helper functions — format_size","title":"Remove environment helper functions — format_size","text":"Remove environment helper functions","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/format_size.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove environment helper functions — format_size","text":"","code":"format_size(size_bytes)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_alluvial — geom_alluvial","title":"geom_alluvial — geom_alluvial","text":"Creates alluvial plot visualize flows nodes. observation needs `x` aesthetic well `next_x` column declares observation flow. Also observation `node` `next_node` aesthetic provide information group y-direction.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_alluvial — geom_alluvial","text":"","code":"geom_alluvial(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = 0,   width = 0.1,   smooth = 8,   inherit.aes = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_alluvial — geom_alluvial","text":"mapping provide mapping. x y need numeric. data provide data position change position na.rm remove missing values show.legend show legend plot space space nodes y-direction width width nodes smooth much smooth curve ? means steeper curve. inherit.aes geom inherits aestethics ... arguments passed geo","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_alluvial — geom_alluvial","text":"ggplot layer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial_label.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_alluvial_label — geom_alluvial_label","title":"geom_alluvial_label — geom_alluvial_label","text":"Creates centered labels text nodes alluvial plot. Needs exact aestethics call `geom_alluvial` work.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_alluvial_label — geom_alluvial_label","text":"","code":"geom_alluvial_text(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = 0,   width = 0.1,   inherit.aes = TRUE,   ... )  geom_alluvial_label(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = 0,   width = 0.1,   inherit.aes = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_alluvial_label — geom_alluvial_label","text":"mapping provide mapping. x y need numeric. data provide data position change position na.rm remove missing values show.legend show legend plot space space nodes y-direction width width nodes inherit.aes geom inherits aestethics ... arguments passed geo","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial_label.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_alluvial_label — geom_alluvial_label","text":"ggplot layer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_alluvial_label.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"geom_alluvial_label — geom_alluvial_label","text":"important arguments ; `space` proves space nodes y-direction; `shift` shifts nodes y-direction.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_sankey — geom_sankey","title":"geom_sankey — geom_sankey","text":"Creates sankey plot visualize flows nodes. observation needs `x` aesthetic well `next_x` column declares observation flow. Also observation `node` `next_node` aesthetic provide information group y-direction. default row data frame counted calculate size flows. manual flow value can added `value` aesthetic.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_sankey — geom_sankey","text":"","code":"geom_sankey(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = NULL,   type = \"sankey\",   width = 0.1,   smooth = 8,   inherit.aes = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_sankey — geom_sankey","text":"mapping provide mapping. x y need numeric. data provide data position change position na.rm remove missing values show.legend show legend plot space space nodes y-direction type either 'sankey' 'alluvial' width width nodes smooth much smooth curve ? means steeper curve. inherit.aes geom inherits aestethics ... arguments passed geom","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_sankey — geom_sankey","text":"ggplot layer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"geom_sankey — geom_sankey","text":"geom_sankey understand following aesthetics (required aesthetics bold): - **x0** - **y0** - **** - **b** - **angle** - m1 - m2 - color - fill - size - linetype - alpha - lineend","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_bump.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_sankey_bump — geom_sankey_bump","title":"geom_sankey_bump — geom_sankey_bump","text":"Creates alluvial plot visualize flows nodes. observation needs `x` aesthetic well `next_x` column declares observation flow. Also observation `node` `next_node` aesthetic provide information group y-direction.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_bump.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_sankey_bump — geom_sankey_bump","text":"","code":"geom_sankey_bump(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   smooth = 8,   type = \"sankey\",   inherit.aes = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_bump.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_sankey_bump — geom_sankey_bump","text":"mapping provide mapping. x y need numeric. data provide data position change position na.rm remove missing values show.legend show legend plot smooth much smooth curve ? means steeper curve. type either 'sankey' 'alluvial' inherit.aes geom inherits aestethics ... arguments passed geo","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_bump.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_sankey_bump — geom_sankey_bump","text":"ggplot layer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_bump.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"geom_sankey_bump — geom_sankey_bump","text":"important arguments ; `space` proves space nodes y-direction; `shift` shifts nodes y-direction.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_label.html","id":null,"dir":"Reference","previous_headings":"","what":"geom_sankey_label — geom_sankey_label","title":"geom_sankey_label — geom_sankey_label","text":"Creates centered labels text nodes sankey plot. Needs exact aestethics call `geom_sankey` work.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_label.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"geom_sankey_label — geom_sankey_label","text":"","code":"geom_sankey_label(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = NULL,   type = \"sankey\",   width = 0.1,   inherit.aes = TRUE,   ... )  geom_sankey_text(   mapping = NULL,   data = NULL,   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   space = NULL,   type = \"sankey\",   width = 0.1,   inherit.aes = TRUE,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_label.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"geom_sankey_label — geom_sankey_label","text":"mapping provide mapping. x y need numeric. data provide data position change position na.rm remove missing values show.legend show legend plot space space nodes y-direction type Either `sankey` centers aroudn x axis `alluvial` starts y = 0 moves upward. width width nodes inherit.aes geom inherits aestethics ... arguments passed geo","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/geom_sankey_label.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"geom_sankey_label — geom_sankey_label","text":"ggplot layer","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_feature_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Get feature metadata from Seurat object in a version-agnostic way — get_feature_metadata","title":"Get feature metadata from Seurat object in a version-agnostic way — get_feature_metadata","text":"function extracts feature metadata Seurat object, handling V4 V5 formats.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_feature_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get feature metadata from Seurat object in a version-agnostic way — get_feature_metadata","text":"","code":"get_feature_metadata(srt, assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_feature_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get feature metadata from Seurat object in a version-agnostic way — get_feature_metadata","text":"srt Seurat object assay Name assay. NULL, uses default assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_feature_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get feature metadata from Seurat object in a version-agnostic way — get_feature_metadata","text":"data frame feature metadata","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_seurat_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Get data from Seurat object in a version-agnostic way — get_seurat_data","title":"Get data from Seurat object in a version-agnostic way — get_seurat_data","text":"function extracts data Seurat object, handling V4 V5 formats.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_seurat_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get data from Seurat object in a version-agnostic way — get_seurat_data","text":"","code":"get_seurat_data(srt, layer = \"data\", assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_seurat_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get data from Seurat object in a version-agnostic way — get_seurat_data","text":"srt Seurat object layer layer extract (e.g., \"counts\", \"data\", \"scale.data\") assay Name assay. NULL, uses default assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_seurat_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get data from Seurat object in a version-agnostic way — get_seurat_data","text":"matrix requested data","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_var_features.html","id":null,"dir":"Reference","previous_headings":"","what":"Get variable features from Seurat object in a version-agnostic way — get_var_features","title":"Get variable features from Seurat object in a version-agnostic way — get_var_features","text":"function extracts variable features Seurat object, handling V4 V5 formats.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_var_features.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get variable features from Seurat object in a version-agnostic way — get_var_features","text":"","code":"get_var_features(srt, assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_var_features.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get variable features from Seurat object in a version-agnostic way — get_var_features","text":"srt Seurat object assay Name assay. NULL, uses default assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_var_features.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get variable features from Seurat object in a version-agnostic way — get_var_features","text":"character vector variable feature names","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_vars.html","id":null,"dir":"Reference","previous_headings":"","what":"Get used vars in a ggplot object — get_vars","title":"Get used vars in a ggplot object — get_vars","text":"Get used vars ggplot object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_vars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get used vars in a ggplot object — get_vars","text":"","code":"get_vars(p, reverse, verbose = FALSE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/get_vars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get used vars in a ggplot object — get_vars","text":"p ggplot object. reverse TRUE return unused vars. verbose Whether print messages.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ifnb_sub.html","id":null,"dir":"Reference","previous_headings":"","what":"A subsetted version of 'ifnb' datasets — ifnb_sub","title":"A subsetted version of 'ifnb' datasets — ifnb_sub","text":"Human PBMC control/IFNB-stimulated dataset","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ifnb_sub.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subsetted version of 'ifnb' datasets — ifnb_sub","text":"Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ifnb_sub.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A subsetted version of 'ifnb' datasets — ifnb_sub","text":"https://www.nature.com/articles/nbt.4042","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ifnb_sub.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A subsetted version of 'ifnb' datasets — ifnb_sub","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   if (!require(\"SeuratData\", quietly = TRUE)) {     devtools::install_github(\"satijalab/seurat-data\")   }   library(SeuratData)   library(Seurat)   suppressWarnings(InstallData(\"ifnb\"))   data(\"ifnb\")   set.seed(11)   cells_sub <- unlist(lapply(split(colnames(ifnb), ifnb$stim), function(x) sample(x, size = 1000)))   ifnb_sub <- subset(ifnb, cells = cells_sub)   ifnb_sub <- ifnb_sub[rowSums(ifnb_sub@assays$RNA$counts) > 0, ]   ifnb_sub <- UpdateSeuratObject(ifnb_sub)   # usethis::use_data(ifnb_sub, compress = \"xz\") } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/isOutlier.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","title":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","text":"function detects outliers numeric vector using MAD (Median Absolute Deviation) method. calculates median MAD, determines boundaries outliers based median selected number MADs.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/isOutlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","text":"","code":"isOutlier(   x,   nmads = 2.5,   constant = 1.4826,   type = c(\"both\", \"lower\", \"higher\") )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/isOutlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","text":"x numeric vector. nmads number median absolute deviations (MADs) median define boundaries outliers. default value 2.5. constant constant factor convert MAD standard deviation. default value 1.4826, consistent MAD normal distribution. type type outliers detect. Available options \"\" (default), \"lower\", \"higher\". set \"\", detects lower higher outliers. set \"lower\", detects lower outliers. set \"higher\", detects higher outliers.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/isOutlier.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","text":"numeric vector indices indicating positions outliers x.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/isOutlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Detect outliers using MAD(Median Absolute Deviation) method — isOutlier","text":"","code":"x <- c(1, 2, 3, 4, 5, 100) isOutlier(x) # returns 6 #> [1] 6  x <- c(3, 4, 5, NA, 6, 7) isOutlier(x, nmads = 1.5, type = \"lower\") # returns 4 #> [1] 4  x <- c(10, 20, NA, 15, 35) isOutlier(x, nmads = 2, type = \"higher\") # returns 3, 5 #> [1] 3 5"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/lifemap_cell.html","id":null,"dir":"Reference","previous_headings":"","what":"Embryonic Development Database from LifeMap Discovery — lifemap_cell","title":"Embryonic Development Database from LifeMap Discovery — lifemap_cell","text":"Embryonic Development Database LifeMap Discovery","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/lifemap_cell.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Embryonic Development Database from LifeMap Discovery — lifemap_cell","text":"","code":"lifemap_cell  lifemap_compartment  lifemap_organ"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/lifemap_cell.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Embryonic Development Database from LifeMap Discovery — lifemap_cell","text":"https://discovery.lifemapsc.com/-vivo-development/cellular","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/make_long.html","id":null,"dir":"Reference","previous_headings":"","what":"make_long — make_long","title":"make_long — make_long","text":"Prepares 'wide' data frame format `geom_sankey` `geom_alluvial` understands. Useful show flows dimensions dataset.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/make_long.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"make_long — make_long","text":"","code":"make_long(.df, ..., value = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/make_long.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"make_long — make_long","text":".df data frame ... unquoted columnnames df want include plot. value row weight weight kept providing column name weight.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/make_long.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"make_long — make_long","text":"longer data frame","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/matrix_power.html","id":null,"dir":"Reference","previous_headings":"","what":"Helper function for matrix power — matrix_power","title":"Helper function for matrix power — matrix_power","text":"Helper function matrix power","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/matrix_power.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Helper function for matrix power — matrix_power","text":"","code":"matrix_power(mat, power)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/matrix_power.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Helper function for matrix power — matrix_power","text":"mat Input matrix power Power raise matrix ","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/matrix_power.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Helper function for matrix power — matrix_power","text":"Matrix raised specified power","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_list.html","id":null,"dir":"Reference","previous_headings":"","what":"A list of palettes for use in data visualization — palette_list","title":"A list of palettes for use in data visualization — palette_list","text":"list palettes use data visualization","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A list of palettes for use in data visualization — palette_list","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   check_R(c(\"stringr\", \"RColorBrewer\", \"ggsci\", \"Redmonder\", \"rcartocolor\", \"nord\", \"viridis\", \"pals\", \"oompaBase\", \"dichromat\", \"jaredhuling/jcolors\"))   library(stringr)   library(RColorBrewer)   library(ggsci)   library(Redmonder)   library(rcartocolor)   library(nord)   library(viridis)   library(pals)   library(dichromat)   library(jcolors)   brewer.pal.info <- RColorBrewer::brewer.pal.info   ggsci_db <- ggsci:::ggsci_db   redmonder.pal.info <- Redmonder::redmonder.pal.info   metacartocolors <- rcartocolor::metacartocolors   rownames(metacartocolors) <- metacartocolors$Name   nord_palettes <- nord::nord_palettes   viridis_names <- c(\"magma\", \"inferno\", \"plasma\", \"viridis\", \"cividis\", \"rocket\", \"mako\", \"turbo\")   viridis_palettes <- lapply(setNames(viridis_names, viridis_names), function(x) viridis::viridis(100, option = x))   ocean_names <- names(pals:::syspals)[grep(\"ocean\", names(pals:::syspals))]   ocean_palettes <- pals:::syspals[ocean_names]   dichromat_palettes <- dichromat::colorschemes   jcolors_names <- paste0(\"jcolors-\", c(\"default\", \"pal2\", \"pal3\", \"pal4\", \"pal5\", \"pal6\", \"pal7\", \"pal8\", \"pal9\", \"pal10\", \"pal11\", \"pal12\", \"rainbow\"))   custom_names <- c(\"jet\", \"simspec\", \"GdRd\")   custom_palettes <- list(     oompaBase::jetColors(N = 100),     c(\"#c22b86\", \"#f769a1\", \"#fcc5c1\", \"#253777\", \"#1d92c0\", \"#9ec9e1\", \"#015b33\", \"#42aa5e\", \"#d9f0a2\", \"#E66F00\", \"#f18c28\", \"#FFBB61\"),     c(\"gold\", \"red3\")   )   names(custom_palettes) <- custom_names    palette_list <- list()   all_colors <- c(     rownames(brewer.pal.info), names(ggsci_db), rownames(redmonder.pal.info),     rownames(metacartocolors), names(nord_palettes), names(viridis_palettes),     ocean_names, names(dichromat_palettes), jcolors_names,     custom_names   )   for (pal in all_colors) {     if (!pal %in% all_colors) {       stop(paste0(\"Invalid pal Must be one of \", paste0(all_colors, collapse = \",\")))     }     if (pal %in% rownames(brewer.pal.info)) {       pal_n <- brewer.pal.info[pal, \"maxcolors\"]       pal_category <- brewer.pal.info[pal, \"category\"]       if (pal_category == \"div\") {         palcolor <- rev(brewer.pal(name = pal, n = pal_n))       } else {         if (pal == \"Paired\") {           palcolor <- brewer.pal(12, \"Paired\")[c(1:4, 7, 8, 5, 6, 9, 10, 11, 12)]         } else {           palcolor <- brewer.pal(name = pal, n = pal_n)         }       }       if (pal_category == \"qual\") {         attr(palcolor, \"type\") <- \"discrete\"       } else {         attr(palcolor, \"type\") <- \"continuous\"       }     } else if (pal %in% names(ggsci_db)) {       if (pal %in% c(\"d3\", \"uchicago\", \"material\")) {         for (subpal in names(ggsci_db[[pal]])) {           palcolor <- ggsci_db[[pal]][[subpal]]           if (pal == \"material\") {             attr(palcolor, \"type\") <- \"continuous\"           } else {             attr(palcolor, \"type\") <- \"discrete\"           }           palette_list[[paste0(pal, \"-\", subpal)]] <- palcolor         }         next       } else {         palcolor <- ggsci_db[[pal]][[1]]         if (pal == \"gsea\") {           attr(palcolor, \"type\") <- \"continuous\"         } else {           attr(palcolor, \"type\") <- \"discrete\"         }       }     } else if (pal %in% rownames(redmonder.pal.info)) {       pal_n <- redmonder.pal.info[pal, \"maxcolors\"]       pal_category <- redmonder.pal.info[pal, \"category\"]       if (pal_category == \"div\") {         palcolor <- rev(redmonder.pal(name = pal, n = pal_n))       } else {         palcolor <- redmonder.pal(name = pal, n = pal_n)       }       if (pal_category == \"qual\") {         attr(palcolor, \"type\") <- \"discrete\"       } else {         attr(palcolor, \"type\") <- \"continuous\"       }     } else if (pal %in% rownames(metacartocolors)) {       pal_n <- metacartocolors[pal, \"Max_n\"]       palcolor <- carto_pal(name = pal, n = pal_n)       if (pal_category == \"qualitative\") {         attr(palcolor, \"type\") <- \"discrete\"       } else {         attr(palcolor, \"type\") <- \"continuous\"       }     } else if (pal %in% names(nord_palettes)) {       palcolor <- nord_palettes[[pal]]       attr(palcolor, \"type\") <- \"discrete\"     } else if (pal %in% names(viridis_palettes)) {       palcolor <- viridis_palettes[[pal]]       attr(palcolor, \"type\") <- \"continuous\"     } else if (pal %in% names(ocean_palettes)) {       palcolor <- ocean_palettes[[pal]]       attr(palcolor, \"type\") <- \"continuous\"     } else if (pal %in% names(dichromat_palettes)) {       palcolor <- dichromat_palettes[[pal]]       if (pal %in% c(\"Categorical.12\", \"SteppedSequential.5\")) {         attr(palcolor, \"type\") <- \"discrete\"       } else {         attr(palcolor, \"type\") <- \"continuous\"       }     } else if (pal %in% jcolors_names) {       palcolor <- jcolors(palette = gsub(\"jcolors-\", \"\", pal))       if (pal %in% paste0(\"jcolors-\", c(\"pal10\", \"pal11\", \"pal12\", \"rainbow\"))) {         attr(palcolor, \"type\") <- \"continuous\"       } else {         attr(palcolor, \"type\") <- \"discrete\"       }     } else if (pal %in% custom_names) {       palcolor <- custom_palettes[[pal]]       if (pal %in% c(\"jet\")) {         attr(palcolor, \"type\") <- \"continuous\"       } else {         attr(palcolor, \"type\") <- \"discrete\"       }     }     palette_list[[pal]] <- palcolor   }   # usethis::use_data(palette_list) } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_scp.html","id":null,"dir":"Reference","previous_headings":"","what":"Color palettes collected in SCP. — palette_scp","title":"Color palettes collected in SCP. — palette_scp","text":"Color palettes collected SCP.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_scp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Color palettes collected in SCP. — palette_scp","text":"","code":"palette_scp(   x,   n = 100,   palette = \"Paired\",   palcolor = NULL,   type = \"auto\",   matched = FALSE,   reverse = FALSE,   NA_keep = FALSE,   NA_color = \"grey80\" )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_scp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Color palettes collected in SCP. — palette_scp","text":"x vector character/factor numeric values. missing, numeric values 1:n used x. n number colors return numeric values. palette Palette name. available palette names can queried show_palettes(). palcolor Custom colors used create color palette. type Type x. Can one \"auto\", \"discrete\" \"continuous\". default \"auto\", automatically detects x numeric value. matched TRUE, return color vector length x. reverse Whether invert colors. NA_keep Whether keep color assignment NA x. NA_color Color assigned NA NA_keep TRUE.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/palette_scp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Color palettes collected in SCP. — palette_scp","text":"","code":"x <- c(1:3, NA, 3:5) (pal1 <- palette_scp(x, palette = \"Spectral\")) #>    [1,1.04] (1.04,1.08] (1.08,1.12] (1.12,1.16]  (1.16,1.2]  (1.2,1.24] (1.24,1.28] (1.28,1.32] (1.32,1.36]  (1.36,1.4]  #>   \"#5E4FA2\"   \"#5954A4\"   \"#555AA7\"   \"#5060AA\"   \"#4C66AC\"   \"#476BAF\"   \"#4371B2\"   \"#3E77B5\"   \"#3A7DB7\"   \"#3682BA\"  #>  (1.4,1.44] (1.44,1.48] (1.48,1.52] (1.52,1.56]  (1.56,1.6]  (1.6,1.64] (1.64,1.68] (1.68,1.72] (1.72,1.76]  (1.76,1.8]  #>   \"#3288BC\"   \"#378EBA\"   \"#3D94B7\"   \"#429AB5\"   \"#47A0B3\"   \"#4CA5B0\"   \"#52ABAE\"   \"#57B1AB\"   \"#5CB7A9\"   \"#61BDA6\"  #>  (1.8,1.84] (1.84,1.88] (1.88,1.92] (1.92,1.96]    (1.96,2]    (2,2.04] (2.04,2.08] (2.08,2.12] (2.12,2.16]  (2.16,2.2]  #>   \"#67C2A4\"   \"#6EC5A4\"   \"#75C8A4\"   \"#7CCAA4\"   \"#83CDA4\"   \"#8AD0A4\"   \"#91D2A4\"   \"#98D5A4\"   \"#9FD8A4\"   \"#A6DBA4\"  #>  (2.2,2.24] (2.24,2.28] (2.28,2.32] (2.32,2.36]  (2.36,2.4]  (2.4,2.44] (2.44,2.48] (2.48,2.52] (2.52,2.56]  (2.56,2.6]  #>   \"#ACDDA3\"   \"#B2E0A2\"   \"#B8E2A1\"   \"#BEE5A0\"   \"#C4E79E\"   \"#CAE99D\"   \"#D0EC9C\"   \"#D6EE9B\"   \"#DCF199\"   \"#E2F398\"  #>  (2.6,2.64] (2.64,2.68] (2.68,2.72] (2.72,2.76]  (2.76,2.8]  (2.8,2.84] (2.84,2.88] (2.88,2.92] (2.92,2.96]    (2.96,3]  #>   \"#E7F599\"   \"#E9F69D\"   \"#ECF7A1\"   \"#EEF8A5\"   \"#F1F9A9\"   \"#F3FAAD\"   \"#F6FBB1\"   \"#F8FCB5\"   \"#FBFDB9\"   \"#FDFEBD\"  #>    (3,3.04] (3.04,3.08] (3.08,3.12] (3.12,3.16]  (3.16,3.2]  (3.2,3.24] (3.24,3.28] (3.28,3.32] (3.32,3.36]  (3.36,3.4]  #>   \"#FEFDBC\"   \"#FEFAB7\"   \"#FEF7B1\"   \"#FEF4AC\"   \"#FEF0A7\"   \"#FEEDA2\"   \"#FEEA9C\"   \"#FEE797\"   \"#FEE492\"   \"#FEE18D\"  #>  (3.4,3.44] (3.44,3.48] (3.48,3.52] (3.52,3.56]  (3.56,3.6]  (3.6,3.64] (3.64,3.68] (3.68,3.72] (3.72,3.76]  (3.76,3.8]  #>   \"#FDDC88\"   \"#FDD784\"   \"#FDD27F\"   \"#FDCD7B\"   \"#FDC877\"   \"#FDC373\"   \"#FDBE6F\"   \"#FDB96A\"   \"#FDB466\"   \"#FDAF62\"  #>  (3.8,3.84] (3.84,3.88] (3.88,3.92] (3.92,3.96]    (3.96,4]    (4,4.04] (4.04,4.08] (4.08,4.12] (4.12,4.16]  (4.16,4.2]  #>   \"#FCA95E\"   \"#FBA25B\"   \"#FA9C58\"   \"#F99555\"   \"#F88F52\"   \"#F7884F\"   \"#F6824C\"   \"#F67B49\"   \"#F57446\"   \"#F46E43\"  #>  (4.2,4.24] (4.24,4.28] (4.28,4.32] (4.32,4.36]  (4.36,4.4]  (4.4,4.44] (4.44,4.48] (4.48,4.52] (4.52,4.56]  (4.56,4.6]  #>   \"#F16943\"   \"#EE6445\"   \"#EB5F46\"   \"#E85A47\"   \"#E45648\"   \"#E1514A\"   \"#DE4C4B\"   \"#DB474C\"   \"#D8434D\"   \"#D53E4E\"  #>  (4.6,4.64] (4.64,4.68] (4.68,4.72] (4.72,4.76]  (4.76,4.8]  (4.8,4.84] (4.84,4.88] (4.88,4.92] (4.92,4.96]    (4.96,5]  #>   \"#CF384D\"   \"#CA324C\"   \"#C42C4B\"   \"#BF2549\"   \"#B91F48\"   \"#B41947\"   \"#AE1345\"   \"#A90D44\"   \"#A30743\"   \"#9E0142\"  (pal2 <- palette_scp(x, palcolor = c(\"red\", \"white\", \"blue\"))) #>    [1,1.04] (1.04,1.08] (1.08,1.12] (1.12,1.16]  (1.16,1.2]  (1.2,1.24] (1.24,1.28] (1.28,1.32] (1.32,1.36]  (1.36,1.4]  #>   \"#FF0000\"   \"#FF0505\"   \"#FF0A0A\"   \"#FF0F0F\"   \"#FF1414\"   \"#FF1919\"   \"#FF1E1E\"   \"#FF2424\"   \"#FF2929\"   \"#FF2E2E\"  #>  (1.4,1.44] (1.44,1.48] (1.48,1.52] (1.52,1.56]  (1.56,1.6]  (1.6,1.64] (1.64,1.68] (1.68,1.72] (1.72,1.76]  (1.76,1.8]  #>   \"#FF3333\"   \"#FF3838\"   \"#FF3D3D\"   \"#FF4242\"   \"#FF4848\"   \"#FF4D4D\"   \"#FF5252\"   \"#FF5757\"   \"#FF5C5C\"   \"#FF6161\"  #>  (1.8,1.84] (1.84,1.88] (1.88,1.92] (1.92,1.96]    (1.96,2]    (2,2.04] (2.04,2.08] (2.08,2.12] (2.12,2.16]  (2.16,2.2]  #>   \"#FF6767\"   \"#FF6C6C\"   \"#FF7171\"   \"#FF7676\"   \"#FF7B7B\"   \"#FF8080\"   \"#FF8585\"   \"#FF8B8B\"   \"#FF9090\"   \"#FF9595\"  #>  (2.2,2.24] (2.24,2.28] (2.28,2.32] (2.32,2.36]  (2.36,2.4]  (2.4,2.44] (2.44,2.48] (2.48,2.52] (2.52,2.56]  (2.56,2.6]  #>   \"#FF9A9A\"   \"#FF9F9F\"   \"#FFA4A4\"   \"#FFAAAA\"   \"#FFAFAF\"   \"#FFB4B4\"   \"#FFB9B9\"   \"#FFBEBE\"   \"#FFC3C3\"   \"#FFC8C8\"  #>  (2.6,2.64] (2.64,2.68] (2.68,2.72] (2.72,2.76]  (2.76,2.8]  (2.8,2.84] (2.84,2.88] (2.88,2.92] (2.92,2.96]    (2.96,3]  #>   \"#FFCECE\"   \"#FFD3D3\"   \"#FFD8D8\"   \"#FFDDDD\"   \"#FFE2E2\"   \"#FFE7E7\"   \"#FFECEC\"   \"#FFF2F2\"   \"#FFF7F7\"   \"#FFFCFC\"  #>    (3,3.04] (3.04,3.08] (3.08,3.12] (3.12,3.16]  (3.16,3.2]  (3.2,3.24] (3.24,3.28] (3.28,3.32] (3.32,3.36]  (3.36,3.4]  #>   \"#FCFCFF\"   \"#F7F7FF\"   \"#F2F2FF\"   \"#ECECFF\"   \"#E7E7FF\"   \"#E2E2FF\"   \"#DDDDFF\"   \"#D8D8FF\"   \"#D3D3FF\"   \"#CECEFF\"  #>  (3.4,3.44] (3.44,3.48] (3.48,3.52] (3.52,3.56]  (3.56,3.6]  (3.6,3.64] (3.64,3.68] (3.68,3.72] (3.72,3.76]  (3.76,3.8]  #>   \"#C8C8FF\"   \"#C3C3FF\"   \"#BEBEFF\"   \"#B9B9FF\"   \"#B4B4FF\"   \"#AFAFFF\"   \"#A9A9FF\"   \"#A4A4FF\"   \"#9F9FFF\"   \"#9A9AFF\"  #>  (3.8,3.84] (3.84,3.88] (3.88,3.92] (3.92,3.96]    (3.96,4]    (4,4.04] (4.04,4.08] (4.08,4.12] (4.12,4.16]  (4.16,4.2]  #>   \"#9595FF\"   \"#9090FF\"   \"#8B8BFF\"   \"#8585FF\"   \"#8080FF\"   \"#7B7BFF\"   \"#7676FF\"   \"#7171FF\"   \"#6C6CFF\"   \"#6767FF\"  #>  (4.2,4.24] (4.24,4.28] (4.28,4.32] (4.32,4.36]  (4.36,4.4]  (4.4,4.44] (4.44,4.48] (4.48,4.52] (4.52,4.56]  (4.56,4.6]  #>   \"#6161FF\"   \"#5C5CFF\"   \"#5757FF\"   \"#5252FF\"   \"#4D4DFF\"   \"#4848FF\"   \"#4242FF\"   \"#3D3DFF\"   \"#3838FF\"   \"#3333FF\"  #>  (4.6,4.64] (4.64,4.68] (4.68,4.72] (4.72,4.76]  (4.76,4.8]  (4.8,4.84] (4.84,4.88] (4.88,4.92] (4.92,4.96]    (4.96,5]  #>   \"#2E2EFF\"   \"#2929FF\"   \"#2424FF\"   \"#1E1EFF\"   \"#1919FF\"   \"#1414FF\"   \"#0F0FFF\"   \"#0A0AFF\"   \"#0505FF\"   \"#0000FF\"  (pal3 <- palette_scp(x, palette = \"Spectral\", n = 10)) #>   [1,1.4] (1.4,1.8] (1.8,2.2] (2.2,2.6]   (2.6,3]   (3,3.4] (3.4,3.8] (3.8,4.2] (4.2,4.6]   (4.6,5]  #> \"#5E4FA2\" \"#3288BD\" \"#66C2A5\" \"#ABDDA4\" \"#E6F598\" \"#FFFFBF\" \"#FEE08B\" \"#FDAE61\" \"#F46D43\" \"#D53E4F\"  (pal4 <- palette_scp(x, palette = \"Spectral\", n = 10, reverse = TRUE)) #>   (4.6,5] (4.2,4.6] (3.8,4.2] (3.4,3.8]   (3,3.4]   (2.6,3] (2.2,2.6] (1.8,2.2] (1.4,1.8]   [1,1.4]  #> \"#D53E4F\" \"#F46D43\" \"#FDAE61\" \"#FEE08B\" \"#FFFFBF\" \"#E6F598\" \"#ABDDA4\" \"#66C2A5\" \"#3288BD\" \"#5E4FA2\"  (pal5 <- palette_scp(x, palette = \"Spectral\", matched = TRUE)) #>  [1,1.04]  (1.96,2]  (2.96,3]      <NA>  (2.96,3]  (3.96,4]  (4.96,5]  #> \"#5E4FA2\" \"#83CDA4\" \"#FDFEBD\"        NA \"#FDFEBD\" \"#F88F52\" \"#9E0142\"  (pal6 <- palette_scp(x, palette = \"Spectral\", matched = TRUE, NA_keep = TRUE)) #>  [1,1.04]  (1.96,2]  (2.96,3]      <NA>  (2.96,3]  (3.96,4]  (4.96,5]  #> \"#5E4FA2\" \"#83CDA4\" \"#FDFEBD\"  \"grey80\" \"#FDFEBD\" \"#F88F52\" \"#9E0142\"  (pal7 <- palette_scp(x, palette = \"Paired\", type = \"discrete\")) #>         1         2         3         4         5  #> \"#A6CEE3\" \"#1F78B4\" \"#B2DF8A\" \"#33A02C\" \"#FDBF6F\"  show_palettes(list(pal1, pal2, pal3, pal4, pal5, pal6, pal7)) #> All available palettes: #> Error in if (!is.null(names(pal)) && all(names(pal) != \"\")) {    graphics::text((j - 1) * show_step + show_rect/2, 0.5, names(pal)[j],         srt = 90, adj = 0.5, cex = 0.5)} else {    graphics::text((j - 1) * show_step + show_rect/2, 0.5, pal[j],         srt = 90, adj = 0.5, cex = 0.5)}: missing value where TRUE/FALSE needed  all_palettes <- show_palettes(return_palettes = TRUE)  #> Error in show_palettes(return_palettes = TRUE): unused argument (return_palettes = TRUE) names(all_palettes) #> Error: object 'all_palettes' not found"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panc8_sub.html","id":null,"dir":"Reference","previous_headings":"","what":"A subsetted version of human 'panc8' datasets — panc8_sub","title":"A subsetted version of human 'panc8' datasets — panc8_sub","text":"Human pancreatic islet cell datasets produced across four technologies, CelSeq (GSE81076) CelSeq2 (GSE85241), Fluidigm C1 (GSE86469), SMART-Seq2 (E-MTAB-5061) SeuratData package. data set `panc8`, 200 cells downsampled form panc8_sub dataset.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panc8_sub.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subsetted version of human 'panc8' datasets — panc8_sub","text":"Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panc8_sub.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A subsetted version of human 'panc8' datasets — panc8_sub","text":"https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE81076 https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi https://www.ebi.ac.uk/arrayexpress/experiments/E-MTAB-5061/ https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panc8_sub.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A subsetted version of human 'panc8' datasets — panc8_sub","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   data(\"pancreas_sub\")   if (!require(\"SeuratData\", quietly = TRUE)) {     devtools::install_github(\"satijalab/seurat-data\")   }   library(SeuratData)   library(Seurat)   suppressWarnings(InstallData(\"panc8\"))   data(\"panc8\")   set.seed(11)   cells_sub <- unlist(lapply(split(colnames(panc8), panc8$dataset), function(x) sample(x, size = 200)))   panc8_sub <- subset(panc8, cells = cells_sub)   panc8_sub <- panc8_sub[rowSums(panc8_sub@assays$RNA$counts) > 0, ]   panc8_sub <- panc8_sub[toupper(rownames(panc8_sub)) %in% toupper(rownames(pancreas_sub)), ]   panc8_sub <- UpdateSeuratObject(panc8_sub)   # usethis::use_data(panc8_sub, compress = \"xz\") } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/pancreas_sub.html","id":null,"dir":"Reference","previous_headings":"","what":"A subsetted version of mouse 'pancreas' datasets — pancreas_sub","title":"A subsetted version of mouse 'pancreas' datasets — pancreas_sub","text":"Mouse pancreatic endocrinogenesis dataset Bastidas-Ponce et al. (2019). total 1000 cells downsampled form pancreas_sub dataset.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/pancreas_sub.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"A subsetted version of mouse 'pancreas' datasets — pancreas_sub","text":"Seurat object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/pancreas_sub.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"A subsetted version of mouse 'pancreas' datasets — pancreas_sub","text":"https://scvelo.readthedocs.io/scvelo.datasets.pancreas/ https://github.com/theislab/scvelo_notebooks/raw/master/data/Pancreas/endocrinogenesis_day15.h5ad","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/pancreas_sub.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"A subsetted version of mouse 'pancreas' datasets — pancreas_sub","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   library(Seurat)   library(reticulate)   check_Python(\"scvelo\")   scv <- import(\"scvelo\")   adata <- scv$datasets$pancreas()   pancreas <- adata_to_srt(adata)   set.seed(11)   pancreas_sub <- subset(pancreas, cells = sample(colnames(pancreas), size = 1000))   pancreas_sub <- pancreas_sub[rowSums(pancreas_sub@assays$RNA$counts) > 0, ]   pancreas_sub[[\"CellType\"]] <- pancreas_sub[[\"clusters_coarse\"]]   pancreas_sub[[\"SubCellType\"]] <- pancreas_sub[[\"clusters\"]]   pancreas_sub[[\"clusters_coarse\"]] <- pancreas_sub[[\"clusters\"]] <- NULL   pancreas_sub[[\"Phase\"]] <- ifelse(pancreas_sub$S_score > pancreas_sub$G2M_score, \"S\", \"G2M\")   pancreas_sub[[\"Phase\"]][apply(pancreas_sub[[]][, c(\"S_score\", \"G2M_score\")], 1, max) < 0, ] <- \"G1\"   pancreas_sub[[\"Phase\", drop = TRUE]] <- factor(pancreas_sub[[\"Phase\", drop = TRUE]], levels = c(\"G1\", \"S\", \"G2M\"))   pancreas_sub[[\"PCA\"]] <- pancreas_sub[[\"X_pca\"]]   pancreas_sub[[\"UMAP\"]] <- pancreas_sub[[\"X_umap\"]]   pancreas_sub[[\"X_umap\"]] <- pancreas_sub[[\"X_pca\"]] <- NULL   VariableFeatures(pancreas_sub) <- rownames(pancreas_sub[[\"RNA\"]])[which(pancreas_sub[[\"RNA\"]]@meta.features$highly_variable_genes == \"True\")]   pancreas_sub <- UpdateSeuratObject(pancreas_sub)   # usethis::use_data(pancreas_sub, compress = \"xz\") } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panel_fix.html","id":null,"dir":"Reference","previous_headings":"","what":"Set the panel width/height of a plot object to a fixed value. — panel_fix","title":"Set the panel width/height of a plot object to a fixed value. — panel_fix","text":"ggplot object, stored, can specify height width entire plot, panel. latter obviously important control final result plot. function can set panel width/height plot fixed value rasterize .","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panel_fix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set the panel width/height of a plot object to a fixed value. — panel_fix","text":"","code":"panel_fix(x)  panel_fix_overall(   x,   panel_index = NULL,   respect = NULL,   width = NULL,   height = NULL,   margin = 1,   units = \"in\",   raster = FALSE,   dpi = 300,   BPPARAM = BiocParallel::SerialParam(),   return_grob = FALSE,   bg_color = \"white\",   save = NULL,   verbose = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panel_fix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set the panel width/height of a plot object to a fixed value. — panel_fix","text":"x ggplot object, grob object, combined plot made patchwork cowplot package. panel_index Specify panel fixed. NULL, fix panels. respect logical, indicates whether row heights column widths respect . width desired width fixed panels. height desired height fixed panels. margin margin add around panel, inches. default 1 inch. units units height, width margin given. Can mm, cm, , etc. See unit. raster Whether rasterize panel. dpi Plot resolution. BPPARAM BiocParallelParam instance determining parallel back-end used building object made patchwork package. return_grob TRUE return grob object instead wrapped patchwork object. bg_color Plot background color. save NULL file name used save plot. verbose Whether print messages. padding padding add around panel, inches. default 0 inches. ... Unused.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/panel_fix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set the panel width/height of a plot object to a fixed value. — panel_fix","text":"","code":"library(ggplot2) p <- ggplot(data = mtcars, aes(x = mpg, y = wt, colour = cyl)) +   geom_point() +   facet_wrap(~gear, nrow = 2) # fix the size of panel panel_fix(p, width = 5, height = 3, units = \"cm\") #> Error in panel_fix(p, width = 5, height = 3, units = \"cm\"): unused arguments (width = 5, height = 3, units = \"cm\") # rasterize the panel panel_fix(p, width = 5, height = 3, units = \"cm\", raster = TRUE, dpi = 30) #> Error in panel_fix(p, width = 5, height = 3, units = \"cm\", raster = TRUE,     dpi = 30): unused arguments (width = 5, height = 3, units = \"cm\", raster = TRUE, dpi = 30)  # panel_fix will build and render the plot when the input is a ggplot object. # so after panel_fix, the size of the object will be changed. object.size(p) #> 14928 bytes object.size(panel_fix(p, width = 5, height = 3, units = \"cm\")) #> Error in panel_fix(p, width = 5, height = 3, units = \"cm\"): unused arguments (width = 5, height = 3, units = \"cm\")  ## save the plot with appropriate size # p_fix <- panel_fix(p, width = 5, height = 3, units = \"cm\") # plot_size <- attr(p_fix, \"size\") # ggsave( #   filename = \"p_fix.png\", plot = p_fix, #   units = plot_size$units, width = plot_size$width, height = plot_size$height # ) ## or save the plot directly # p_fix <- panel_fix(p, width = 5, height = 3, units = \"cm\", save = \"p_fix.png\")  # fix the panel of the plot combined by patchwork data(\"pancreas_sub\") p1 <- CellDimPlot(pancreas_sub, \"Phase\", aspect.ratio = 1) # ggplot object p2 <- FeatureDimPlot(pancreas_sub, \"Ins1\", aspect.ratio = 0.5) # ggplot object #> Error in rescale(colors_value): could not find function \"rescale\" p <- p1 / p2 # plot is combined by patchwork #> Error: object 'p2' not found # fix the panel size for each plot, the width will be calculated automatically based on aspect.ratio panel_fix(p, height = 1) #> Error in panel_fix(p, height = 1): unused argument (height = 1)  # fix the panel of the plot combined by plot_grid if (requireNamespace(\"cowplot\", quietly = TRUE)) {   p1 <- CellDimPlot(pancreas_sub, c(\"Phase\", \"SubCellType\"), label = TRUE) # plot is combined by patchwork   p2 <- FeatureDimPlot(pancreas_sub, c(\"Ins1\", \"Gcg\"), label = TRUE) # plot is combined by patchwork   p <- cowplot::plot_grid(p1, p2, nrow = 2) # plot is combined by plot_grid   # fix the size of panel for each plot   panel_fix(p, height = 1)   # rasterize the panel while keeping all labels and text in vector format   panel_fix(p, height = 1, raster = TRUE, dpi = 30) } #> Error in rescale(colors_value): could not find function \"rescale\"  # fix the panel of the heatmap ht1 <- GroupHeatmap(pancreas_sub,   features = c(     \"Sox9\", \"Anxa2\", \"Bicc1\", # Ductal     \"Neurog3\", \"Hes6\", # EPs     \"Fev\", \"Neurod1\", # Pre-endocrine     \"Rbp4\", \"Pyy\", # Endocrine     \"Ins1\", \"Gcg\", \"Sst\", \"Ghrl\" # Beta, Alpha, Delta, Epsilon   ),   group.by = c(\"CellType\", \"SubCellType\"),   show_row_names = TRUE ) #> 'magick' package is suggested to install to give better rasterization. #>  #> Set `ht_opt$message = FALSE` to turn off this message. # the size of the heatmap is not fixed and can be resized by zooming the viewport. ht1$plot  # fix the size of the heatmap according the current viewport panel_fix(ht1$plot) #> Warning: no non-missing arguments to max; returning -Inf #> No facets detected.  # rasterize the heatmap body panel_fix(ht1$plot, raster = TRUE, dpi = 30) #> Error in panel_fix(ht1$plot, raster = TRUE, dpi = 30): unused arguments (raster = TRUE, dpi = 30) # fix the size of overall heatmap including annotation and legend panel_fix(ht1$plot, height = 4, width = 6) #> Error in panel_fix(ht1$plot, height = 4, width = 6): unused arguments (height = 4, width = 6)  ht2 <- GroupHeatmap(pancreas_sub,   features = pancreas_sub[[\"RNA\"]]@var.features,   group.by = \"SubCellType\",   n_split = 5, nlabel = 20,   db = \"GO_BP\", species = \"Mus_musculus\", anno_terms = TRUE,   height = 4, width = 1 # Heatmap body size for two groups ) #> 'magick' package is suggested to install to give better rasterization. #>  #> Set `ht_opt$message = FALSE` to turn off this message. #> [2025-09-07 20:39:33.442173] Start Enrichment #> Workers: 2 #> Species: Mus_musculus #> Warning: Annotation package org.Mm.eg.db does not exist. #> Error in PrepareDB(species = species, db = db, db_update = db_update,     db_version = db_version, db_IDtypes = IDtype, convert_species = convert_species,     Ensembl_version = Ensembl_version, mirror = mirror): Stop the preparation. # the size of the heatmap is already fixed ht2$plot #> Error: object 'ht2' not found # when no height/width is specified, panel_fix does not change the size of the heatmap. panel_fix(ht2$plot) #> Error: object 'ht2' not found # rasterize the heatmap body panel_fix(ht2$plot, raster = TRUE, dpi = 30) #> Error in panel_fix(ht2$plot, raster = TRUE, dpi = 30): unused arguments (raster = TRUE, dpi = 30) # however, gene labels on the left and enrichment annotations on the right cannot be adjusted panel_fix(ht2$plot, height = 5, width = 10) #> Error in panel_fix(ht2$plot, height = 5, width = 10): unused arguments (height = 5, width = 10)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. dplyr %>% grid arrow, gpar, unit rlang %||%","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ref_scHCL.html","id":null,"dir":"Reference","previous_headings":"","what":"Reference datasets for cell type annotation in single-cell RNA data — ref_scHCL","title":"Reference datasets for cell type annotation in single-cell RNA data — ref_scHCL","text":"Reference datasets cell type annotation single-cell RNA data","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ref_scHCL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reference datasets for cell type annotation in single-cell RNA data — ref_scHCL","text":"","code":"ref_scHCL  ref_scMCA  ref_scZCL"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ref_scHCL.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Reference datasets for cell type annotation in single-cell RNA data — ref_scHCL","text":"https://github.com/ggjlab/scHCL https://github.com/ggjlab/scMCA https://github.com/ggjlab/scZCL","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/ref_scHCL.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reference datasets for cell type annotation in single-cell RNA data — ref_scHCL","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   check_R(c(\"ggjlab/scZCL\", \"ggjlab/scHCL\", \"ggjlab/scMCA\"))   ref_scHCL <- Seurat::NormalizeData(scHCL::ref.expr)   ref_scMCA <- Seurat::NormalizeData(scMCA::ref.expr)   ref_scZCL <- Seurat::NormalizeData(scZCL::ref.expr)   Encoding(colnames(ref_scHCL)) <- \"latin1\"   colnames(ref_scHCL) <- iconv(colnames(ref_scHCL), \"latin1\", \"UTF-8\")   Encoding(colnames(ref_scMCA)) <- \"latin1\"   colnames(ref_scMCA) <- iconv(colnames(ref_scMCA), \"latin1\", \"UTF-8\")   Encoding(colnames(ref_scZCL)) <- \"latin1\"   colnames(ref_scZCL) <- iconv(colnames(ref_scZCL), \"latin1\", \"UTF-8\")   # usethis::use_data(ref_scHCL, compress = \"xz\")   # usethis::use_data(ref_scMCA, compress = \"xz\")   # usethis::use_data(ref_scZCL, compress = \"xz\")   ref_scHCL <- UpdateSeuratObject(ref_scHCL)   ref_scMCA <- UpdateSeuratObject(ref_scMCA)   ref_scZCL <- UpdateSeuratObject(ref_scZCL) } } # }"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/scVI_integrate.html","id":null,"dir":"Reference","previous_headings":"","what":"scVI_integrate — scVI_integrate","title":"scVI_integrate — scVI_integrate","text":"scVI_integrate","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/scVI_integrate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"scVI_integrate — scVI_integrate","text":"","code":"scVI_integrate(   srtMerge = NULL,   batch = NULL,   append = TRUE,   srtList = NULL,   assay = NULL,   do_normalization = NULL,   normalization_method = \"LogNormalize\",   do_HVF_finding = TRUE,   HVF_source = \"separate\",   HVF_method = \"vst\",   nHVF = 2000,   HVF_min_intersection = 1,   HVF = NULL,   scVI_dims_use = NULL,   nonlinear_reduction = \"umap\",   nonlinear_reduction_dims = c(2, 3),   nonlinear_reduction_params = list(),   force_nonlinear_reduction = TRUE,   neighbor_metric = \"euclidean\",   neighbor_k = 20L,   cluster_algorithm = \"louvain\",   cluster_resolution = 0.6,   model = \"SCVI\",   SCVI_params = list(),   PEAKVI_params = list(),   num_threads = 8,   seed = 11 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/scVI_integrate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"scVI_integrate — scVI_integrate","text":"srtMerge merged Seurat object includes batch information. batch character string specifying batch variable name. append Logical, TRUE, integrated data appended original Seurat object (srtMerge). srtList list Seurat objects checked preprocessed. assay name assay used downstream analysis. do_normalization logical value indicating whether data normalization performed. normalization_method normalization method used. Possible values \"LogNormalize\", \"SCT\", \"TFIDF\". Default \"LogNormalize\". do_HVF_finding logical value indicating whether highly variable feature (HVF) finding performed. Default TRUE. HVF_source source highly variable features. Possible values \"global\" \"separate\". Default \"separate\". HVF_method method selecting highly variable features. Default \"vst\". nHVF number highly variable features select. Default 2000. HVF_min_intersection feature needs present batches minimum number times order considered highly variable. default value 1. HVF vector highly variable features. Default NULL. scVI_dims_use vector specifying dimensions returned scVI utilized downstream cell cluster finding non-linear reduction. set NULL, returned dimensions used default. nonlinear_reduction nonlinear dimensionality reduction method use. Options \"umap\",\"umap-naive\", \"tsne\", \"dm\", \"phate\", \"pacmap\", \"trimap\", \"largevis\", \"fr\" (default \"umap\"). nonlinear_reduction_dims number dimensions keep nonlinear dimensionality reduction. vector provided, different numbers dimensions can specified method (default c(2, 3)). nonlinear_reduction_params list parameters pass nonlinear dimensionality reduction method. force_nonlinear_reduction logical value indicating whether force nonlinear dimensionality reduction even specified reduction already present Seurat object. neighbor_metric distance metric use finding neighbors. Options \"euclidean\", \"cosine\", \"manhattan\", \"hamming\" (default \"euclidean\"). neighbor_k number nearest neighbors use finding neighbors (default 20). cluster_algorithm clustering algorithm use. Options \"louvain\", \"slm\", \"leiden\" (default \"louvain\"). cluster_resolution resolution parameter use clustering. Larger values result fewer clusters (default 0.6). model string indicating scVI model used. Options \"SCVI\" \"PEAKVI\". Default \"SCVI\". SCVI_params list parameters SCVI model, default empty list. PEAKVI_params list parameters PEAKVI model, default empty list. num_threads integer setting number threads scVI, default 8. seed integer specifying random seed reproducibility. Default 11.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/segementsDf.html","id":null,"dir":"Reference","previous_headings":"","what":"Shorten and offset the segment — segementsDf","title":"Shorten and offset the segment — segementsDf","text":"function takes data frame representing segments plot shortens offsets based provided arguments.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/segementsDf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shorten and offset the segment — segementsDf","text":"","code":"segementsDf(data, shorten_start, shorten_end, offset)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/segementsDf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shorten and offset the segment — segementsDf","text":"data data frame containing segments. columns 'x', 'y', 'xend', 'yend' representing start end points segment. shorten_start amount shorten start segment . shorten_end amount shorten end segment . offset amount offset segment .","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/segementsDf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shorten and offset the segment — segementsDf","text":"modified data frame shortened offset segments.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/segementsDf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shorten and offset the segment — segementsDf","text":"","code":"library(ggplot2) tempNodes <- data.frame(\"x\" = c(10, 40), \"y\" = c(10, 30)) data <- data.frame(\"x\" = c(10, 40), \"y\" = c(10, 30), \"xend\" = c(40, 10), \"yend\" = c(30, 10)) ggplot(tempNodes, aes(x = x, y = y)) +   geom_point(size = 12) +   xlim(0, 50) +   ylim(0, 50) +   geom_segment(data = data, aes(x = x, xend = xend, y = y, yend = yend))   ggplot(tempNodes, aes(x = x, y = y)) +   geom_point(size = 12) +   xlim(0, 50) +   ylim(0, 50) +   geom_segment(     data = segementsDf(data, shorten_start = 2, shorten_end = 3, offset = 1),     aes(x = x, xend = xend, y = y, yend = yend)   )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_feature_metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Set feature metadata in Seurat object in a version-agnostic way — set_feature_metadata","title":"Set feature metadata in Seurat object in a version-agnostic way — set_feature_metadata","text":"function sets feature metadata Seurat object, handling V4 V5 formats.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_feature_metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set feature metadata in Seurat object in a version-agnostic way — set_feature_metadata","text":"","code":"set_feature_metadata(srt, metadata, assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_feature_metadata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set feature metadata in Seurat object in a version-agnostic way — set_feature_metadata","text":"srt Seurat object metadata data frame feature metadata assay Name assay. NULL, uses default assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_feature_metadata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set feature metadata in Seurat object in a version-agnostic way — set_feature_metadata","text":"modified Seurat object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_seurat_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Set data in Seurat object in a version-agnostic way — set_seurat_data","title":"Set data in Seurat object in a version-agnostic way — set_seurat_data","text":"function sets data Seurat object, handling V4 V5 formats.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_seurat_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set data in Seurat object in a version-agnostic way — set_seurat_data","text":"","code":"set_seurat_data(srt, data, layer = \"data\", assay = NULL)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_seurat_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set data in Seurat object in a version-agnostic way — set_seurat_data","text":"srt Seurat object data data set layer layer set (e.g., \"counts\", \"data\", \"scale.data\") assay Name assay. NULL, uses default assay.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/set_seurat_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set data in Seurat object in a version-agnostic way — set_seurat_data","text":"modified Seurat object","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/show_palettes.html","id":null,"dir":"Reference","previous_headings":"","what":"Show the color palettes — show_palettes","title":"Show the color palettes — show_palettes","text":"function displays color palettes using ggplot2.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/show_palettes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Show the color palettes — show_palettes","text":"","code":"show_palettes(palettes = NULL, label = TRUE, palettes_label = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/show_palettes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Show the color palettes — show_palettes","text":"palettes list color palettes. `NULL`, uses default palettes. type character vector specifying type palettes include. Default \"discrete\". index numeric vector specifying indices palettes include. Default `NULL`. palette_names character vector specifying names SCP palettes include. Default `NULL`. return_names logical value indicating whether return names selected palettes. Default `TRUE`. return_palettes logical value indicating whether return colors selected palettes. Default `FALSE`.","code":""},{"path":[]},{"path":"https://zhanghao-njmu.github.io/SCP/reference/show_palettes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Show the color palettes — show_palettes","text":"","code":"show_palettes(palettes = list(c(\"red\", \"blue\", \"green\"), c(\"yellow\", \"purple\", \"orange\"))) #> All available palettes:  all_palettes <- show_palettes(return_palettes = TRUE) #> Error in show_palettes(return_palettes = TRUE): unused argument (return_palettes = TRUE) names(all_palettes) #> Error: object 'all_palettes' not found all_palettes[[\"simspec\"]] #> Error: object 'all_palettes' not found show_palettes(index = 1:10) #> Error in show_palettes(index = 1:10): unused argument (index = 1:10) show_palettes(type = \"discrete\", index = 1:10) #> Error in show_palettes(type = \"discrete\", index = 1:10): unused arguments (type = \"discrete\", index = 1:10) show_palettes(type = \"continuous\", index = 1:10) #> Error in show_palettes(type = \"continuous\", index = 1:10): unused arguments (type = \"continuous\", index = 1:10) show_palettes(palette_names = c(\"Paired\", \"nejm\", \"simspec\", \"Spectral\", \"jet\"), return_palettes = TRUE) #> Error in show_palettes(palette_names = c(\"Paired\", \"nejm\", \"simspec\",     \"Spectral\", \"jet\"), return_palettes = TRUE): unused arguments (palette_names = c(\"Paired\", \"nejm\", \"simspec\", \"Spectral\", \"jet\"), return_palettes = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/slim_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Drop unused data from the plot to reduce the object size — slim_data","title":"Drop unused data from the plot to reduce the object size — slim_data","text":"Drop unused data plot reduce object size","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/slim_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Drop unused data from the plot to reduce the object size — slim_data","text":"","code":"slim_data(p)  # S3 method for class 'ggplot' slim_data(p)  # S3 method for class 'patchwork' slim_data(p)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/slim_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Drop unused data from the plot to reduce the object size — slim_data","text":"p patchwork object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/slim_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Drop unused data from the plot to reduce the object size — slim_data","text":"","code":"library(ggplot2) p <- ggplot(data = mtcars, aes(x = mpg, y = wt, colour = cyl)) +   geom_point() object.size(p) #> 14928 bytes colnames(p$data) #>  [1] \"mpg\"  \"cyl\"  \"disp\" \"hp\"   \"drat\" \"wt\"   \"qsec\" \"vs\"   \"am\"   \"gear\" \"carb\"  p_slim <- slim_data(p) object.size(p_slim) #> 11856 bytes colnames(p_slim$data) #> [1] \"mpg\" \"cyl\" \"wt\""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/srt_to_adata.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","title":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","text":"function takes Seurat object converts anndata object using reticulate package.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/srt_to_adata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","text":"","code":"srt_to_adata(   srt,   features = NULL,   assay_X = \"RNA\",   slot_X = \"counts\",   assay_layers = c(\"spliced\", \"unspliced\"),   slot_layers = \"counts\",   convert_tools = FALSE,   convert_misc = FALSE,   verbose = TRUE )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/srt_to_adata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","text":"srt Seurat object. features Optional vector features include anndata object. Defaults features assay_X. assay_X Assay convert main data matrix (X) anndata object. slot_X Slot name assay_X Seurat object. assay_layers Assays convert layers anndata object. slot_layers Slot names assay_layers Seurat object. convert_tools Logical indicating whether convert tool-specific data. convert_misc Logical indicating whether convert miscellaneous data. verbose Logical indicating whether print verbose messages conversion process.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/srt_to_adata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","text":"anndata object. anndata object.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/srt_to_adata.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert a seurat object to an anndata object using reticulate — srt_to_adata","text":"","code":"data(\"pancreas_sub\") adata <- srt_to_adata(pancreas_sub) #> Error in check_Python(c(\"scanpy\", \"numpy\")): could not find function \"check_Python\" adata #> Error: object 'adata' not found  ### Or save as an h5ad file or a loom file # adata$write_h5ad(\"pancreas_sub.h5ad\") # adata$write_loom(\"pancreas_sub.loom\", write_obsm_varm = TRUE)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_blank.html","id":null,"dir":"Reference","previous_headings":"","what":"Blank theme — theme_blank","title":"Blank theme — theme_blank","text":"function creates theme elements blank except axis lines labels. can optionally add coordinate axes plot.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_blank.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Blank theme — theme_blank","text":"","code":"theme_blank(   add_coord = TRUE,   xlen_npc = 0.15,   ylen_npc = 0.15,   xlab = \"\",   ylab = \"\",   lab_size = 12,   ... )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_blank.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Blank theme — theme_blank","text":"add_coord Whether add coordinate arrows. Default TRUE. xlen_npc length x-axis arrow \"npc\". ylen_npc length y-axis arrow \"npc\". xlab x-axis label. ylab y-axis label. lab_size Label size. ... Arguments passed theme.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_blank.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Blank theme — theme_blank","text":"","code":"library(ggplot2) p <- ggplot(mtcars, aes(x = wt, y = mpg, colour = factor(cyl))) +   geom_point() p + theme_blank()  p + theme_blank(xlab = \"x-axis\", ylab = \"y-axis\", lab_size = 16)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_sankey.html","id":null,"dir":"Reference","previous_headings":"","what":"sankey_themes — theme_sankey","title":"sankey_themes — theme_sankey","text":"Minimal themes sankey, alluvial sankey bump plots","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_sankey.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"sankey_themes — theme_sankey","text":"","code":"theme_sankey(   base_size = 11,   base_family = \"\",   base_line_size = base_size/22,   base_rect_size = base_size/22 )  theme_alluvial(   base_size = 11,   base_family = \"\",   base_line_size = base_size/22,   base_rect_size = base_size/22 )  theme_sankey_bump(   base_size = 11,   base_family = \"\",   base_line_size = base_size/22,   base_rect_size = base_size/22 )"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_sankey.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"sankey_themes — theme_sankey","text":"base_size base font size, given pts. base_family base font family base_line_size base size line elements base_rect_size base size rect elements","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_scp.html","id":null,"dir":"Reference","previous_headings":"","what":"SCP theme — theme_scp","title":"SCP theme — theme_scp","text":"default theme SCP plot function.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_scp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SCP theme — theme_scp","text":"","code":"theme_scp(aspect.ratio = NULL, base_size = 12, ...)"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_scp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SCP theme — theme_scp","text":"aspect.ratio Aspect ratio panel. base_size Base font size ... Arguments passed theme.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/theme_scp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SCP theme — theme_scp","text":"","code":"library(ggplot2) p <- ggplot(mtcars, aes(x = wt, y = mpg, colour = factor(cyl))) +   geom_point() p + theme_scp()"},{"path":"https://zhanghao-njmu.github.io/SCP/reference/words_excluded.html","id":null,"dir":"Reference","previous_headings":"","what":"Excluded words in keyword enrichment analysis and extraction — words_excluded","title":"Excluded words in keyword enrichment analysis and extraction — words_excluded","text":"variable \"words_excluded\" represents words excluded keyword enrichment analysis keyword extraction process. mainly include words excessively redundant little value.","code":""},{"path":"https://zhanghao-njmu.github.io/SCP/reference/words_excluded.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Excluded words in keyword enrichment analysis and extraction — words_excluded","text":"","code":"if (FALSE) { # \\dontrun{ if (interactive()) {   words_excluded <- c(     \"the\", \"is\", \"and\", \"or\", \"a\", \"in\", \"on\", \"under\", \"between\", \"of\", \"through\", \"via\", \"along\", \"that\", \"for\", \"with\", \"within\", \"without\",     \"cell\", \"cellular\", \"dna\", \"rna\", \"protein\", \"peptide\", \"amino\", \"acid\", \"development\", \"involved\", \"organization\", \"system\",     \"regulation\", \"regulated\", \"positive\", \"negative\", \"response\", \"process\", \"processing\", \"small\", \"large\", \"change\"   )   # usethis::use_data(words_excluded) } } # }"}]
